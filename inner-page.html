<!DOCTYPE html>
<html lang="en">

  <head>


    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
    <title>SeaHawk</title>
    <meta content="" name="description">
    <meta content="" name="keywords">
  
    <!-- Favicons -->
    <!-- <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon"> -->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" 
    integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA=="
     crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:300,300i,400,400i,500,500i,700,700i&display=swap" rel="stylesheet">
  
    <!-- Vendor CSS Files -->
    <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  
    <!-- Template Main CSS File id="myProgress"--> 
     <!-- <link href="../Site Management/Main/dashboard.css" rel="stylesheet"> -->

    <link href="../assets/css/style.css" rel="stylesheet">
      <link href="assets/css/style.css" rel="stylesheet">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
    <!-- <title>Green Haven Properties</title>
    <meta content="" name="description">
    <meta content="" name="keywords"> -->
  
    <!-- Favicons -->
    <!-- <link href="assets/img/logo.jpg" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon"> -->

        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-storage.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-functions.js"></script>
  
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  
    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  
    <!-- Template Main CSS File green -->
    <link rel="stylesheet" href="horizontal-calendar-events-rescalendar/src/css/rescalendar.css">
   
    <link href="assets/css/myplot.css" rel="stylesheet">
    <link href="smallScreen.css" rel="stylesheet">

    <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <!-- CSS -->
    
    <style>
        :root {
          --grid-cols: 1;
          --grid-rows: 1;
        }

        #container {
          display: grid;
          grid-gap: 1em;
          grid-template-rows: repeat(var(--grid-rows), 1fr);
          grid-template-columns: repeat(var(--grid-cols), 1fr);
        }

        .grid-item {
          padding: 1em;
          border: 1px solid #0375d3;
          text-align: center;
          border-radius: 4px;
          cursor: pointer;
          height: 150px;
          background-color: #5a6064;
          color: rgb(229, 241, 241);
          
        }
        /* @-webkit-keyframes moving-gradient {
            0% {
                background-position: left bottom;
            }

            100% {
                background-position: right bottom;
            }
        }â€‹ */

        .wrapper{
            width: 100%;
            text-align: center; 
        }

        .lightBlue{
            background: rgb(150, 219, 248);
        }

        .blueClass{
            background: rgb(2, 2, 112);
            /* background: -webkit-linear-gradient(left , #02085c 10%, #e5666c 80%, #056602 100%) repeat;
            -webkit-background-size: 50%;
            -webkit-column-width: 100%;
            -webkit-animation-name: moving-gradient;
            -webkit-animation-duration: 5s;
            -webkit-animation-iteration-count: infinite;
            -webkit-animation-timing-function: linear; */
        }
        .spaceClass{
            background: #c8969900;
        }
        .greyClass{
            background: #504f55;
        } 
        .orangeClass{
            background: #d88c28;
        } 
        .pinkClass{
            background: #b980a5;
        } 
        .purpleClass{
            background: #ab89c1;
        } 
        .brownClass{
       
            background: brown;
        } 
        

    </style>

  </head>
  
  <body>
  
    <!-- ======= Top Bar ======= -->
   <!-- <div id="topbar" class="d-none d-lg-flex align-items-center fixed-top">
      <div class="container d-flex">
        <div class="contact-info mr-auto">
          <i class="icofont-envelope"></i> <a href="mailto:contact@example.com">info@greenhavenproperties.co.ke</a>
          <i class="icofont-phone"></i> +254700086333
        </div>
        <div class="social-links">
          <a href="#" class="twitter"><i class="icofont-twitter"></i></a>
          <a href="#" class="facebook"><i class="icofont-facebook"></i></a>
          <a href="#" class="instagram"><i class="icofont-instagram"></i></a>
          <a href="#" class="skype"><i class="icofont-skype"></i></a>
          <a href="#" class="linkedin"><i class="icofont-linkedin"></i></i></a>
        </div>
      </div>
    </div>  -->


     <!-- ======= Header class="inner-page" ======= -->
  
  <div class="card-shadow" id="sidebar" >

  

    </div>
  <main id="main" data-aos="fade-up">

    
    <!-- ======= Breadcrumbs Error when initializing: No id or dataKeyValues ======= -->
    <section style="margin-top: -20px;" class="breadcrumbs card">
      <div style="margin-top: 10px;" class="container2">

        <div class="d-flex justify-content-between align-items-center">
          <div style="padding-top: 10px; padding-left: 20px; padding-right: 20px;padding-bottom: 5px;margin-right: 50px; margin-left: 30px; border-radius: 5px;margin-top: 5px;" class="card-header">
            <h2  id="projectIdentity"></h2>
          </div>
          
          <div style="padding-top: 10px; padding-left: 20px; padding-right: 20px;padding-bottom: 10px; margin-right: 50px; margin-left: 30px; margin-top: 5px; border-radius: 5px;" class="card-header">
          <ol id="list" style="cursor: pointer; display: none; list-style-type: none; ">
            <li style="list-style: none;"  onclick="showProjects()" id="mainProjects"> <a href="#" style="text-decoration: none; color: black;"> <img title="Projects" style="width: 20px; height: 20px; box-shadow: #504f55;" src="assets/img/pro3.png" alt=""></a>
              
            </li>
            <li style="list-style-type: none; margin-left: 13px;"  id="l1" onclick="showProjectSchedule()"><img title="Progress tracker"  style="width: 20px; height: 20px; box-shadow: #504f55;" src="assets/img/prog.png" alt=""><sup><i id="scheduleLoader" style="font-size: 10px; display: none;" class="fa fa-spinner fa-spin "></i></sup></li>
            <li style="list-style: none;margin-left: 13px;" id="l1b" onclick="showSites()"><img title="Sites" style="width: 22px; height: 22px; box-shadow: #504f55;" src="assets/img/construction_10481974.png" alt=""></li>
            <!-- <li onclick="show">Over view</li>spin -->
            <li style="list-style: none;margin-left: 13px;" title="Store records" id="l2" onclick="showStore()">
              <img title="Store records"style="width: 22px; height: 25px; box-shadow: #504f55;" src="assets/img/wooden-house_9057512.png" alt="">            </li>
            
            <li style="list-style: none;margin-left: 13px;" title="Site workers" id="l3" onclick="openStaff()">
              <img title="Site workers"style="width: 22px; height: 22px; box-shadow: #504f55;" src="assets/img/workers_4490381.png" alt=""> 
            </li>
            <li style="list-style: none;margin-left: 13px;" title="Site attendance" id="l4" onclick="openAttendance()">
              <img title="Site attendance"style="width: 22px; height: 22px; box-shadow: #504f55;" src="assets/img/form_12362426.png" alt=""> 
            </li>
            <li style="list-style: none;margin-left: 13px;" title="Wage bill" id="l5" onclick="openPayments()">
              <img title="Wage bill"style="width: 22px; height: 22px; box-shadow: #504f55;" src="assets/img/invoice_4531957.png" alt=""> 
            </li>
            
           
          </ol>
        </div>
          <!-- <ol>
           
            <li id="back">My Projects</li>start()
          </ol> -->
        </div>

      </div>
    </section>
    <div style="margin-left: 10px; margin-right: 10px;" id="myProgress">
      <div id="myBar" style="display: none; height: 5px; color: rgb(5, 5, 5); box-shadow: 0 4px 8px 0 rgb(10, 10, 10), 0 6px 20px 0 rgba(252, 251, 251, 0.945);"></div>
    </div>
    <!-- End Breadcrumbs -->
<div id="logger" class="mainSection" style="display: block; margin-top: -100px;">
  <section class="inner-page">



      <!-- <div class="container"> The project selected has not been activated -->


        <!-- <div class="inner-container">
          <div class="projectName">
              <h3>Project Name: Gems Phase 2</h3>
              <h4>Plot Number 23</h4>
          </div> -->
        <!-- </div> -->
        <!-- <p>
          <img src="assets/img/type_c.jpg" alt="">
        </p> -->
      <!-- </div> -->
      <div  class="container">
        <div class="main-body">


         
              <!-- Breadcrumb -->
              <!-- <nav aria-label="breadcrumb" class="main-breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                  <li class="breadcrumb-item"><a href="javascript:void(0)">User</a></li>
                  <li class="breadcrumb-item active" aria-current="page">User Profile</li>
                </ol>
              </nav> -->
              <!-- /Breadcrumb -->
        
              <div style="display: none;" class="row gutters-sm">
                <div class="col-md-4 mb-3">
                  <div class="centered">
                    <div   class="card" id="login">
                    <div class="card-body">
                      <div class="d-flex flex-column align-items-center text-center">
                        <h4 class="startForm">VALIDATE</h4>
                        <hr>
                        <form action="">
                        
                          <input onclick="getProjectNames()" type="text" placeholder="Select Project" id="email"  required style="cursor: pointer;">
                          <input type="text" placeholder="Code" id="pN" required>
                         
                          <hr>
                          <div class="row">
                            <div class="col-sm-12">
                              <a onclick="start()" class="btn btn-info " target="__blank" >OK</a>
                            </div>
                          </div>
                          
                        </form>
                       
                      </div>
                      
                    </div>
                   </div>
                   </div>
                  
               
                  <div class="card" id="details">
                    <div class="card-body">
                      <div class="d-flex flex-column align-items-center text-center">
                        <h4 class="soldout">Project Owner Info</h4>
                        <div class="line"></div>
                        <hr>
                        <img src="../assets/img/profile1.jpg" id="ownerImage" alt="Not Found" class="rounded-circle" width="150">
                        <div class="mt-3">
                          <h4 id="name"></h4>
                          <p class="text-secondary mb-1" id="phone"></p>
                          <p class="text-muted font-size-sm" id="location"></p>
                          <p class="text-muted font-size-sm" id="associates"></p>
                          <!-- <button class="btn btn-primary">Follow</button>
                          <button class="btn btn-outline-primary">Message</button> -->

                          
                        </div>
                      </div>
                      
                    </div>
                  </div>
                  <!-- <div class="card mt-3">
                    <ul class="list-group list-group-flush">
                      <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                        <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe mr-2 icon-inline"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>Website</h6>
                        <span class="text-secondary">https://bootdey.com</span>
                      </li>
                      <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                        <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github mr-2 icon-inline"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>Github</h6>
                        <span class="text-secondary">bootdey</span>
                      </li>
                      <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                        <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter mr-2 icon-inline text-info"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>Twitter</h6>
                        <span class="text-secondary">@bootdey</span>
                      </li>
                      <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                        <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram mr-2 icon-inline text-danger"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>Instagram</h6>
                        <span class="text-secondary">bootdey</span>
                      </li>
                      <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                        <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-facebook mr-2 icon-inline text-primary"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>Facebook</h6>
                        <span class="text-secondary">bootdey</span>
                      </li>
                    </ul>
                  </div> -->
                </div>
               

                 
                <div class="container" style="margin-left: -22px; width: 1700px; display: none;">
                  <div style="display: flex;width: 1700px;" class="main-body">
                     <div class="col-md-8" id="mainM2">
                  <div class="card mb-3">
                    <div class="card-body">
                      <h4 style="font-size: 16px; text-align: center;color: rgb(29, 5, 69);">Project Transactions</h4>
                      <div style="width: 100%; margin-top: 20px;">
                        <h6 style="text-align: left;float: left; margin-left: 20px;text-decoration: none;">CR</h6>
                        <!-- <div style="float: center; height: 20px; width: 2px;background-color: black;"></div> -->
                        <h6 style="text-align: right;margin-right: 20px;">DR</h6>
                        <div style="height: 2px;background-color: black;"></div>
                      </div>
                     
                      
                      
                    <div style="width: 100%;">
                     <table style="width: 45%;float: left;">
                        <thead>
                          <th  style="width: 100px; font-size: 10px;">Date</th>
                          <th  style="width: 100px;font-size: 10px;">Description</th>
                          <th style="width: 100px;font-size: 10px;">Amount</th>

                        </thead>
                        <tbody>

                        </tbody>
                      </table>
                      <table style="width: 45%;float: right;">
                        <thead>
                          <th  style="width: 100px;font-size: 10px;">Date</th>
                          <th  style="width: 100px;font-size: 10px;">Description</th>
                          <th style="width: 100px;font-size: 10px;">Amount</th>

                        </thead>
                        <tbody>

                        </tbody>
                      </table>
                    </div>
                     
                   
                     
                    </div>
                  </div>
    
                 
    
                </div>

                  </div>
                 </div>

               
              </div>
    
            </div>
        </div>
    </section>
<!-- <div class="imageHeader">
  <h4>Latest Progress Images</h4>
</div> -->



</div>

<!-- <div class="container card" id="container" style="padding: 20px;">
table-hover table-bordered table-striped STORE RECORDS MY SITES
</div> -->
 <div  id="names" class="card" style="margin-left: 15%; margin-right: 15%; height: 500px; margin-top: 20px;margin-bottom: 100px;background-color: #01011338;">
            <div   class="card" id="login" style="background-color: #01101d57;">
            <div class="card-body" >
              <div class="d-flex flex-column align-items-center text-center">
                <h4 style="font-size: 24px; color: rgb(250, 248, 248);" class="startForm"><b>PROJECTS PANEL</b> </h4>
                <hr>
                <div id="tableTop2" class="table-responsive" style="height: 500px; background-color: #24011cb6; border-radius: 10px;">
              <table class="table  table-hover"  id="tNames">
                <thead style="font-size: 12px; position: sticky; top: -2px; background-color: white; text-align: left;">
                  <th style="font-family: sans-serif; text-align: left; margin-left: 35px;">NAME</th>
                  <th  style="font-family: sans-serif; text-align: left;">LOCATION</th>
                  <th >LAUNCHED DATE</th>
                  <!-- <th>DUE DATE</th> -->
                  <th style="width: 200px;">PROGRESS STATUS</th>
                </thead>
      
                <tbody id="projectsAvailable" style=" cursor: pointer; text-align: left; font-weight: bold;font-size: 12px; color: rgb(250, 245, 248);">
      
                </tbody>
              </table>
             
               </div> 
               <div class="container card" id="container" style="padding: 20px;display: none;">

               </div>
              </div>
              
            </div>
           </div>
  </div>



        
<div id="store_panel" style="margin: 30px; padding-top: 20px;padding-left: 20px; display: none;"class="card" >

  <h4 style="text-align: center; margin-bottom: 30px;margin-top: 20px; color: brown;"><b>STORE RECORDS</b></h4>
  <div class="row" >

    <!-- Content Column -->
    <div class="col-lg-6 mb-4" >
<!-- ================================= -->
<div id="optioner2" class="centered" style="margin-top: 30px; float: right; margin-left: 25%; width: 250px;  position: absolute; z-index: 20; display: none;">
  <div   class="card" id="login" >
  <div class="card-body">
    <i onclick="closeOp()" id="opCloser" class="fa fa-times-circle" aria-hidden="true"style="cursor: pointer; float: right; color:red; position: abolute;" title="Close"></i>

    <div class="d-flex flex-column align-items-center text-center" style="margin-top: 20px; ">
      
      <input style="font-size: 12px; text-align: center;" class="form-control" id="editor" placeholder="">
      <hr>
      <h4  class="btn btn-success" style="width: 80%; cursor: pointer;" id="updater" class="startForm"> <span id="updaterText">Update</span> <span id="updaterIcon" style="display: none;"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i></span></h4>
    
     <div style="height: 1px;background: white;width: 100%;"></div>
     <div>
      <!-- <button style="height: 30px; font-size: 14px; align-items: center; margin-top: 10px;" class="btn btn-primary">CREATE</button> -->
     </div>
    </div>
    
  </div>
 </div>
 </div>
<!-- ======================== -->
        <!-- Project Card Example -->
        <div  class="card2 shadow mb-4"  >

            <div onclick="closeOp()"
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
            <h6 onclick="correctDatess()" class="m-0 font-weight-bold text-primary">MATERIAL SUPPLY</h6>
            
            <div class="dropdown no-arrow">
                <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
                <h3 style="float: left; font-size: 14px;">Total: Ksh <span id="supCounter" style="display: none;">0</span ><span id="supValue">0</span></h3>
                <i style="float: right; margin-left: 20px; cursor: pointer;" onclick="saveSuplies('xlsx')" id="downloadTop" class="fa fa-download" title="Download Supplies" aria-hidden="true"></i>
                
            </div>
        </div>
            <!-- <div class="card-header py-3"> Mon
                <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
            </div>
         -->

             <div class="card-body" >
                <!-- <div ></div> -->

                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                        <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                            <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                        <table class="table table-hover table-bordered table-striped " id="tableSuplies">
                            <thead style="font-size: 11px; position: sticky; top: -2px; background-color: white;">
                                <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                                <th style="min-width: 100px;">Date</th>
                                <th>Item</th>
                                <th>Supplier</th>
                                <th>Quantity</th> 
                                <th>Cost</th>
                                <th>Ref#</th>
                                
                                
                                
                            </thead>
                            <tbody style="font-size: 11px;" id = "tbodyReady">
                            
                            </tbody>
                            
                        </table>
                        </div>          

                 </div>


      
            </div> 
        </div>

     
    </div>
    <div class="col-lg-6 mb-4">

      <!-- Project Card Example -->
      <div class="card2 shadow mb-4" >

          <div
          class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
          <h6 class="m-0 font-weight-bold text-primary">MATERIAL USAGE</h6>
          
          <div class="dropdown no-arrow">
              <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
              <!-- <h3 style="float: left; font-size: 14px;">Total: Ksh <span id="uCounter1" style="display: none;">0</span ><span id="uValue">0</span></h3> -->

              <i style="cursor: pointer; float: right; margin-left: 20px;" onclick="saveUsages('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i>
              
          </div>
      </div>
          <!-- <div class="card-header py-3">
              <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
          </div>
       -->

           <div class="card-body" >
              <!-- <div ></div> -->

              <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                      <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                          <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                      <table class="table table-hover table-bordered table-striped " id="tableUsage">
                          <thead style="font-size: 11px;position: sticky; top: -2px; background-color: white;">
                              <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                             
                              <th>Item</th>
                              <th>Quantity</th>
                              <th>By</th>
                              <th>Site</th> 
                              <th>Date</th>

                          </thead>
                          <tbody style="font-size: 11px;"  id = "tbodySV">
                          
                          </tbody>
                          
                      </table>
                      </div>          

               </div>


  
          </div> 
      </div>

   
  </div>
  <div class="col-lg-6 mb-4">
<!-- -------------------------------------------- -->
<div id="rUsage" style="width: 300px; left: 10%; margin-top: 5%; position: absolute; z-index: 1200; display: none;"  class="card card-primary">
  <div style="text-align: center;" class="card-header">
    <h3 style="font-size: 14px; font-weight: bold;" class="card-title">RECORD USAGE</h3>
  </div>
  <!-- /.card-header -->
  <!-- form start -->
  <form>
    <div style="font-size: 11px;" class="card-body">

      <div class="form-group"style="margin-top: -10px;">
        <label for="exampleInputPassword1"><b>Item</b> </label>
        <input style="font-size: 10px; cursor: not-allowed;" type="" class="form-control" id="u_item" style="cursor: pointer;" placeholder="Name of payee">
      </div>
   
      <div class="form-group"style="margin-top: -9px;">
        <label style="font-weight: bold;" for="exampleInputEmail1">Site Used</label>
        <input style="font-size: 11px;cursor: pointer;"onclick="loadUsageSites()" type="text" class="form-control" id="w_site" placeholder="Select project">
      </div>
     
     
        <div class="form-group"style="margin-top: -10px;">
            <label for="exampleInputPassword1"> <b>Quantity Used</b></label>
            <i id="supsH" onclick="setQty()" title="Record all as used" style="margin-top: 8px; float: right; color: rgb(129, 4, 4);  cursor: pointer;" class="fa fa-bookmark" aria-hidden="true"> ALL</i>
            <input style="font-size: 10px; " type="number" class="form-control" id="u_quantity" placeholder="0">
          </div>
          
          <div class="form-group"style="margin-top: -10px; display: none;">
            <label for="exampleInputPassword1"> <b>Unit</b></label>
            <input style="font-size: 10px; cursor: pointer;" type="" class="form-control" id="unit" style="cursor: pointer;" placeholder="Enter item/service name">
          </div>
          <div class="form-group"style="margin-top: -10px;">
            <label for="exampleInputPassword1"><b>Picked By</b></label>
            <input style="font-size: 10px;" type="text" class="form-control" id="picker" placeholder="Name">
          </div>
          <div class="form-group"style="margin-top: -10px; display: none;">
            <label for="exampleInputPassword1"> <b>Due Date</b></label>
            <input style="font-size: 10px;" type="text" class="form-control" id="u_price" placeholder="Choose Date">
          </div>
          <div class="form-group"style="margin-top: -10px; display: none;">
            <label for="exampleInputPassword1"> <b>Due Date</b></label>
            <input style="font-size: 10px;" type="text" class="form-control" id="set_qty" placeholder="Choose Date">
          </div>
     
        <div id="daySelectorH2" class="form-group"style="margin-top: 11px; display: none;">
          <label style="font-weight: bold;" for="exampleInputPassword1">Day <span style="font-size: 9px; color: red;">(Fill only if you are marking for a day other than today)</span></label>
          <select name="" id="selectedDay2" style="font-size: 12px;cursor: pointer;" type="text" class="form-control">
            <option value="">Select Day</option>
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday           </option>
            <option value="Thursday">Thursday            </option>
            <option value="Friday">Friday            </option>
            <option value="Saturday">Saturday            </option>
            <option value="Sunday">Sunday            </option>
            
            </select>
        </div>
      
      <div style="display: none;" class="form-group"style="margin-top: -9px;">
        <label style="font-weight: bold;" for="exampleInputFile">File input</label>
        <div class="input-group">
          <div class="custom-file">
            <input type="file" class="custom-file-input" id="exampleInputFile">
            <label class="custom-file-label" for="exampleInputFile">Choose file</label>
          </div>
          <div class="input-group-append">
            <span class="input-group-text">Upload</span>
          </div>
        </div>
      </div>
      <div style="display: none;" class="form-check">
        <input type="checkbox" class="form-check-input" id="exampleCheck1">
        <label class="form-check-label" for="exampleCheck1">Check me out</label>
      </div>
    </div>
    <!-- /.card-body -->

    <div class="card-footer"style="margin-top: -10px;">
      <button id="btnRecordUsage" type="button" onclick="recordUsage()" class="btn btn-danger" ><span id="okSpanU">Submit</span><i id="loaderU" style="height: 20px; display: none;" class="fa fa-spinner fa-spin "></i></button>          
  </div>
  </form>
</div>

<div>


     <div id="namesSites"  style="margin-top: 20px; float: right; margin-right: 1%; width: 260PX; display: none; position: absolute;z-index: 1300;">
      <div   class="card" id="login">
      <div class="card-body">
        <div class="d-flex flex-column align-items-center text-center">
          <h4 id="itemSelect" class="btn btn-gray" style="width: 100%; cursor: grab;" class="startForm">SELECT SITE</h4>
          <hr>
          <div id="tableTop2" class="table-responsive" style="max-height: 300px; height: 300px;">
        <table class="table table-hover table-bordered table-striped " id="tNames">

          <tbody  id="sitesTbody" style="cursor: pointer; text-align: left;font-size: 12px; font-weight: bold;">

          </tbody>
        </table>
         </div>
         <div style="height: 1px;background: white;width: 100%;"></div>
         <!-- <button onclick="activateItemField()" style="height: 30px; font-size: 14px; align-items: center; margin-top: 10px;" class="btn btn-danger">CREATE</button> -->
        </div>
        
      </div>
     </div>
     </div>
  </div>
<!-- ================================================ -->
    <!-- Project Card Example -->
    <div class="card2 shadow mb-4" style="border-radius: 5px; box-shadow: 0 4px 8px 0 rgba(231, 8, 8, 0.89), 0 6px 20px 0 rgba(252, 251, 251, 0.945);">

        <div onclick="closeUsager()" class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
        <h6  class="m-0 font-weight-bold text-primary">CURRENT STOCK</h6>
        
        <div class="dropdown no-arrow">
            <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i>onclick="correctPrices()" -->
            <h3 style="float: left; font-size: 14px; display: none;">Total: Ksh <span id="uCounter1" style="display: none;">0</span ><span id="uValue">0</span></h3>
            <i style="cursor: pointer;float: right; margin-left: 20px;" onclick="saveStock('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i>
            
        </div>
    </div>
        <!-- <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
        </div>
     -->

         <div class="card-body" >
            <!-- <div ></div> -->

            <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                    <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                        <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                    <table class="table table-hover table-bordered table-striped " id="tableStock">
                        <thead style="font-size: 11px;position: sticky; top: -2px; background-color: white;">
                            <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                            <th>Item</th>
                            <th>Quantity</th>
                            <th>U.Price</th>
                            <th>L.Supplier</th> 
                            <th style="min-width: 100px;">S.Date</th>
                            <th>Usage</th>
                            
                            
                        </thead>
                        <tbody style="font-size: 11px;"  id = "tbodyDispatched">
                        
                        </tbody>
                        
                    </table>
                    </div>          

             </div>


    
        </div> 
    </div>

 
</div>
<div class="col-lg-6 mb-4">

  <!-- Project Card Example -->
  <div class="card2 shadow mb-4" >

      <div
      class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
      <h6 class="m-0 font-weight-bold text-primary">TOOLS/EQUIPMENTS</h6>
      
      <div class="dropdown no-arrow">
          <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
          <h3 style="float: left; font-size: 14px;display: none;">Total: Ksh <span id="usageCounter" style="display: none;">0</span ><span id="usageValue">0</span></h3>

          <i style="float: right; margin-left: 20px; cursor: pointer;" onclick="saveTools('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i>
          
      </div>
  </div>
      <!-- <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
      </div>
   -->

       <div class="card-body" >
          <!-- <div ></div> -->

          <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                  <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                      <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                  <table class="table table-hover table-bordered table-striped " id="tableTools">
                      <thead style="font-size: 11px;position: sticky; top: -2px; background-color: white;" >
                          <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                          <th>Item</th>
                          <th>Quantity</th>
                         
                          
                          
                          
                      </thead>
                      <tbody style="font-size: 11px;"  id = "tbodyPending">
                      
                      </tbody>
                      
                  </table>
                  </div>          

           </div>


      </div> 
  </div>


</div>

   
</div>

</div>

<div id="sites_in_project2" style="margin: 40px; display: none; ">

  <h4 style="text-align: center; margin-bottom: 30px;margin-top: 20px; color: rgb(252, 251, 251);  text-shadow: 5px 5px 7px black"id="pageLabel"></h4>
  <div class="row">

    <!-- Content Column -->
    <div class="col-lg-6 mb-4">

        <!-- Project Card Example -->
        <div class="card shadow mb-4">

            <div
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
            <h6 class="m-0 font-weight-bold text-primary">Labor force</h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-grey" style="float: right;" id="labTot"></h6>
            <div class="dropdown no-arrow">
                <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
                <!-- <i onclick="loadTopStudents('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i> -->
                
            </div>
        </div>
            <!-- <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
            </div>
         -->

             <div class="card-body">
                <!-- <div ></div> -->

                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                        <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                            <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                        <table class="table table-hover table-bordered table-striped " id="">
                            <thead style="font-size: 11px;position: sticky; top: -2px; background-color: white;">
                                <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                                <!-- <th>#</th> -->
                                <th>Name</th>
                                <th>Designation</th>
                                <th>Wage</th>
                               
                                
                                
                                
                            </thead>
                            <tbody style="font-size: 11px;"  id = "tbodyLabor">
                            
                            </tbody>
                            
                        </table>
                        </div>          

                 </div>


               
            </div> 
        </div>

       

    </div>

    <div class="col-lg-6 mb-4">

      <!-- Project Card Example -->
      <div class="card shadow mb-4">

          <div
          class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
          <h6 class="m-0 font-weight-bold text-primary">Materials Used</h6>
          <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-grey" style="float: right;" id="mateialsValue"></h6>
          
          <div class="dropdown no-arrow">
              <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
              <!-- <i onclick="loadTopStudents('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i> -->
              
          </div>
      </div>
          <!-- <div class="card-header py-3">
              <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
          </div>
       -->

           <div class="card-body">
              <!-- <div ></div> -->

              <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                      <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                          <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                      <table class="table table-hover table-bordered table-striped " id="">
                          <thead style="font-size: 11px;position: sticky; top: -2px; background-color: white;">
                              <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                              <th>Item</th>
                              <th>Quantity</th>
                              <th>Cost</th>
                              
                              
                              
                              
                          </thead>
                          <tbody style="font-size: 11px;"  id = "tbodyMats">
                          
                          </tbody>
                          
                      </table>
                      </div>          

               </div>

          </div> 
      </div>

 

  </div>
  <div class="col-lg-6 mb-4">

    <!-- Project Card Example -->
    <div class="card shadow mb-4">

        <div
        class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
        <h6 class="m-0 font-weight-bold text-primary">Other Expenses</h6>
        <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-primary"></h6>
            <h6 class="m-0 font-weight-bold text-grey" style="float: right;" id="otherExpValue"></h6>
        
        <div class="dropdown no-arrow">
            <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
            <i style="cursor: pointer;" onclick="saveOtherEx('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i>
            
        </div>
    </div>
        <!-- <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
        </div>
     -->

         <div class="card-body">
            <!-- <div ></div> -->

            <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                    <div id="tableTop" class="table-responsive" style=" height: 300px;">
                        <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                    <table class="table table-hover table-bordered table-striped " id="tableExps">
                        <thead style="font-size: 11px;position: sticky; top: -2px; background-color: white;">
                            <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                            <th>Item</th>
                            <th>Amount</th>
                            
                            
                            
                            
                        </thead>
                        <tbody style="font-size: 11px;"  id = "tbodyExps">
                        
                        </tbody>
                        
                    </table>
                    </div>          

             </div>


            
        </div> 
    </div>



</div>
    <div class="col-lg-6 mb-4">

        <!-- Illustrations -->
        <div class="card shadow mb-4" >
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between"style="display: flex;">
                <h6 class="m-0 font-weight-bold text-primary">Site Transactions</h6> 
                <h6 class="m-0 font-weight-bold text-primary"></h6>
                  <h6 class="m-0 font-weight-bold text-primary"></h6>
                  <h6 class="m-0 font-weight-bold text-primary"></h6>
            

                 
                  <h6 class="m-0 font-weight-bold text-grey" id="tcostHolder">Total Cost:</h6>
                  <h6 class="m-0 font-weight-bold text-grey" id="tpaidHolder">Total Paid:</h6>
                  <h6 class="m-0 font-weight-bold text-grey" id="tbalancesHolder">Balance:</h6>
               
                
            </div>
            
            <div class="chart-area"style=" height: 331px;">   
              <div class="card-body">
              <!-- <div ></div> -->
              <!-- <h4 style="font-size: 16px; text-align: center;color: rgb(29, 5, 69);">Project Transactions</h4> -->
                    <div style="width: 100%; margin-top: 20px;">
                      <h6 style="text-align: left;float: left; margin-left: 20px;text-decoration: none;">CR <span id="totClienDeposit">(TOTAL 0)</span></h6>
                      <!-- <div style="float: center; height: 20px; width: 2px;background-color: black;"></div> -->
                      <h6 style="text-align: right;margin-right: 20px;">DR <span id="totTot">(TOTAL 0)</span></h6>
                      <div style="height: 2px;background-color: black;"></div>
                    </div>

              <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">
                <div style="width: 100%;">
                  <table class="table table-hover table-bordered table-striped " id=""style="width: 45%;float: left;">
                     <thead>
                       <th  style="width: 100px; font-size: 10px;">Date</th>
                       <th  style="width: 100px;font-size: 10px;">Description</th>
                       <th style="width: 100px;font-size: 10px;">Amount</th>

                     </thead>
                     <tbody>

                     </tbody>
                   </table>
                   <table class="table table-hover table-bordered table-striped " id="" style="width: 45%;float: right;">
                     <thead>
                       <th  style="width: 100px;font-size: 10px;">Date</th>
                       <th  style="width: 100px;font-size: 10px;">Description</th>
                       <th style="width: 100px;font-size: 10px;">Amount</th>

                     </thead>
                     <tbody>

                     </tbody>
                   </table>
                 </div>         

               </div>

          </div> 
                <!-- <canvas id="myAreaChartSubs"></canvas> -->
                <!-- <canvas id="myAreaChartE"></canvas> -->
            </div>

            <div id="balances">
              <div class="col-md-8" id="mainM">
                <div class="card mb-3">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Project Name</h6>
                      </div>
                      <div id="Pname" class="col-sm-9 text-secondary">
                       
                      </div>
                      
                    </div>
                    <hr>
                    
                    <div class="row">
                      <div class="col-sm-3">
                        <h6  class="mb-0">Location</h6>
                      </div>
                      <div id="plotNumber"  class="col-sm-9 text-secondary">
                       
                      </div>
                    </div>
                    <hr>
                    <div class="row">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Due Date</h6>
                      </div>
                      <div id="titleDeedNo" class="col-sm-9 text-secondary">
                        
                      </div>
                    </div>
                    
                    <hr>
                    <div class="row">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Project Cost</h6>
                      </div>
                      <div id="fAmount" class="col-sm-9 text-secondary">
                        
                      </div>
                    </div>
                    <hr>
                    <div class="row">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Total Paid</h6>
                      </div>
                      <div id="tPaid" class="col-sm-9 text-secondary">
                        
                      </div>
                    </div>
                    <hr>
                    <div class="row">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Balance</h6>
                      </div>
                      <div id="balance" class="col-sm-9 text-secondary">
                        
                      </div>
                    </div>
                    <hr>
                    
                    <div class="row">
                      <div class="col-sm-3">
                        <h6 class="mb-0">Progress Status</h6>
                      </div>
                      <div id="ts" class="col-sm-9 text-secondary">
                        
                      </div>
                    </div>
                    <!-- <hr> -->
                    <!-- <div class="row">
                      <div class="col-sm-12">
                        <a onclick="showImages()" class="btn btn-info " target="__blank" >Project Gallery</a>
                      </div>
                    </div> -->
                   
                  </div>
                </div>
                  
                  
  
              </div>

            </div>
 
        </div>

    </div>
</div>
 
</div>
<div id="transactions"style="margin: 40px;width: 100%;display: none;">
  <div class="row"style="width: 100%;">

    <!-- Content Column -->
    <div class="card" style="width: 100%;">

        <!-- Project Card Example -->
        <div class="card shadow mb-4">

            <div
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
            <div style="align-items: center;">
              <h6 class="m-0 font-weight-bold text-primary"style="font-size: 16px; text-align: center;">Project Transactions</h6>
            </div>
            
            
            <div class="dropdown no-arrow">
                <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
                <i onclick="loadTopStudents('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i>
                
            </div>
        </div>
            <!-- <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
            </div>
         -->

             <div class="card-body">
                <!-- <div ></div> -->
                <!-- <h4 style="font-size: 16px; text-align: center;color: rgb(29, 5, 69);">Project Transactions</h4> -->
                      <div style="width: 100%; margin-top: 20px;">
                        <h6 style="text-align: left;float: left; margin-left: 20px;text-decoration: none;">CR <span>(TOTAL 0)</span></h6>
                        <!-- <div style="float: center; height: 20px; width: 2px;background-color: black;"></div> -->
                        <h6 style="text-align: right;margin-right: 20px;">DR <span>(TOTAL 0)</span></h6>
                        <div style="height: 2px;background-color: black;"></div>
                      </div>

                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">
                  <div style="width: 100%;">
                    <table class="table table-hover table-bordered table-striped " id=""style="width: 45%;float: left;">
                       <thead>
                         <th  style="width: 100px; font-size: 10px;">Date</th>
                         <th  style="width: 100px;font-size: 10px;">Description</th>
                         <th style="width: 100px;font-size: 10px;">Amount</th>

                       </thead>
                       <tbody>

                       </tbody>
                     </table>
                     <table class="table table-hover table-bordered table-striped " id="" style="width: 45%;float: right;">
                       <thead>
                         <th  style="width: 100px;font-size: 10px;">Date</th>
                         <th  style="width: 100px;font-size: 10px;">Description</th>
                         <th style="width: 100px;font-size: 10px;">Amount</th>

                       </thead>
                       <tbody>

                       </tbody>
                     </table>
                   </div>         

                 </div>

            </div> 
        </div>

   </div>

   
</div>

</div>

<div id="paymentsForSite" style="margin: 40px; display: none;">
  <div class="row"style="width: 100%;">

    <!-- Content Column -->
    <div class="card" style="width: 100%; ">

      <div id="names4" style="z-index: 1004; position: absolute; display: none;">

        <div   style="margin-top: 20px; float: left; margin-left: 10%; width: 260PX; ">
          <div   class="card" id="login">
          <div class="card-body">
            <div class="d-flex flex-column align-items-center text-center">
              <h4 id="itemSelect" class="btn btn-primary" style="width: 100%; cursor: grab;" class="startForm">SELECT SITE</h4>
              <hr>
              <div id="tableTop2" class="table-responsive" style="max-height: 300px; height: 300px;">
            <table class="table table-hover table-bordered table-striped " id="tNames">

              <tbody  id="itemsTable" style="cursor: pointer; text-align: left;font-size: 12px; font-weight: bold;">

              </tbody>
            </table>
             </div>
             <div style="height: 1px;background: white;width: 100%;"></div>
             <!-- <button onclick="activateItemField()" style="height: 30px; font-size: 14px; align-items: center; margin-top: 10px;" class="btn btn-danger">CREATE</button> -->
            </div>
            
          </div>
         </div>
         </div>
      </div>
      <div style="display: none;" id="new_bill_card">
        <div style="width: 40%; left: 10%; margin-top: 5%;position: absolute; z-index: 1003;" class="card card-primary">
        <div style="text-align: center;" class="card-header">
          <h3 style="font-size: 18px; float: left;" class="card-title">RECORD NEW BILL/EXPENSE</h3>
          <div style="float: right;">
            <i onclick="closeNewBillCard()" style="margin-left: 10px; cursor: pointer; height: 20px; color: brown;" title="Close" class="fa fa-times" aria-hidden="true"></i>
  
          </div>
        </div>
       
        <!-- /.card-header SELECT PROJECT-->
        <!-- form start -->
        <form>
          <div style="font-size: 10px;" class="card-body">
           
            <div class="form-group"style="margin-top: -10px;">
              <label for="exampleInputPassword1">From</label>
              <input style="font-size: 10px; cursor: pointer;" type="" class="form-control" id="payee" style="cursor: pointer;" placeholder="Name of payee">
            </div>
            <div class="form-group"style="margin-top: -10px;">
                <label for="exampleInputPassword1">Item/Service</label>
                <input style="font-size: 10px; cursor: pointer;" type="" class="form-control" id="billItem" style="cursor: pointer;" placeholder="Enter item/service name">
              </div>
              <div class="form-group"style="margin-top: -10px;">
                <label for="exampleInputPassword1">Site</label>
                <input onclick="chooseSite()" style="font-size: 10px; cursor: pointer;" type="text" class="form-control" id="billDesc" placeholder="Select site">
              </div>
              <div class="form-group"style="margin-top: -10px;">
                <label for="exampleInputPassword1">Total Amount</label>
                <input style="font-size: 10px;" type="number" class="form-control" id="billAmount" placeholder="0">
              </div>
              <div class="form-group"style="margin-top: 11px; width: 90px; ">
                <div style="float: left;">
                  <i onclick="openDaySelector1()" id="togleOn1" style="font-size: 28px; color: rgb(129, 4, 4);cursor: pointer; " class="fa fa-toggle-off" aria-hidden="true" title="Turn On"></i>
                  <i onclick="closeDaySelector1()" id="togleOff1" style="font-size: 28px; color: green;cursor: pointer; display: none;" class="fa fa-toggle-on" aria-hidden="true"title="Turn Off"></i>
                </div>
                <div style="float: right; margin-top: 5px;">
                  <label for="exampleInputPassword11" style="font-size: 13px; font-weight: bold; color: rgb(151, 4, 4);">Pending</label>

                </div>
            </div>
              <div  id="daySelectorH3" class="form-group"style="margin-top: -10px; display: none;">
                <label for="exampleInputPassword1">Due Date</label>
                <input style="font-size: 10px;" type="date" class="form-control" id="billDueDate" placeholder="Choose Date">
              </div>
              <div id="stateHolder" class="form-group"style="margin-top: -10px; display: none;">
                 
                <input style="font-size: 10px;" type="text" class="form-control" id="hoValue" placeholder="Choose Date">
              </div>
            <div style="display: none;" class="form-group"style="margin-top: -10px;">
              <label for="exampleInputFile">File input</label>
              <div class="input-group">
                <div class="custom-file">
                  <input type="file" class="custom-file-input" id="exampleInputFile">
                  <label class="custom-file-label" for="exampleInputFile">Choose file</label>
                </div>
                <div class="input-group-append">
                  <span class="input-group-text">Upload</span>
                </div>
              </div>
            </div>
            <div style="display: none;" class="form-check">
              <input type="checkbox" class="form-check-input" id="exampleCheck1">
              <label class="form-check-label" for="exampleCheck1">Check me out</label>
            </div>
          </div>
          <!-- /.card-body -->

          <div class="card-footer"style="margin-top: 10px;">
            <button id="btnRecordBill" type="button" onclick="recordBill()" class="btn btn-danger"><Span id="mainSpan">Submit</Span><i id="loaderSpan" style="height: 20px; display: none;" class="fa fa-spinner fa-spin "></i></button>
          </div>
        </form>
      </div>
      </div>
      
      <div id="bills_card" style="display: none; position: absolute; z-index: 1000; width: 120%; margin-top: 30px;" >
            <div class="col-lg-6 mb-4 " >

            <!-- Project Card Example -->
            <div class="card shadow mb-4">
              
                <div
                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                
                <h6 id="bills_header" style="color: brown;" class="m-0 font-weight-bold text-primary">Bills</h6>
                <h6 class="m-0 font-weight-bold text-primary"></h6>
                <h6 class="m-0 font-weight-bold text-primary"></h6>
                <h6 class="m-0 font-weight-bold text-primary"></h6>
                <h6 class="m-0 font-weight-bold text-grey" style="float: right;" id="labTot"></h6>
                <div class="dropdown no-arrow">
                    <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
                    <i onclick="openNewBillCard()" style="cursor: pointer; color: brown; margin-right: 10px;" title="Add new bill" class="fa fa-plus" aria-hidden="true"></i>
                    <i style="cursor: pointer; color: brown;" title="Download pending bills" onclick="downLoadBills('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"></i>
                    <i onclick="closeBillsCard()" style="margin-left: 10px; cursor: pointer; height: 20px; color: brown;" title="Close" class="fa fa-times" aria-hidden="true"></i>
                </div>
            </div>
                <!-- <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
                </div>
            -->

                <div class="card-body">
                    <!-- <div ></div> -->

                    <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                            <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                                <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                            <table class="table table-hover table-bordered table-striped " id="tableBills">
                                <thead style="font-size: 10px;position: sticky; top: -2px; background-color: white;">
                                    <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                                    <!-- <th>#</th> -->
                                    <th style="width: 200px;">Payee</th>
                                    <th style="width: 200px;">Item/Service</th>
                                    <!-- <th>Description</th> -->
                                    <th style="width: 200px;">Amount</th>
                                    <th style="width: 200px;">Billed</th>
                                    <th style="width: 200px;">Due</th>
                                    <th style="width: 200px;">Status</th>
                                    <th style="text-align: right; margin-right: 10px; width: 150px; ">Action</th>
    
                                </thead>
                                <tbody style="font-size: 9px;"  id = "tbodyBills">
                                
                                </tbody>
                                
                            </table>
                            </div>          

                    </div>


                  
                </div> 
            </div>

          

        </div>
      </div>
      
     
      <div id="namesPaymentMode"  style="margin-top: 5%; float: right; display: none;   margin-left: 30px; width: 250px; position: absolute; z-index: 1006;">
        <div   class="card" id="login23">
        <div class="card-body" >
          <div class="d-flex flex-column">
            
            <h4 onclick="setMyDate()" style="width: 100%; font-size: 15px; color: rgba(165, 42, 42, 0.938); text-align: center;" class="startForm">SET PAYABLE %</h4>
            <!-- Overtime <i onclick="closeBillsCard()" style="margin-left: 10px; cursor: pointer; height: 20px;float: right; color: rgb(22, 13, 13);" title="Close" class="fa fa-times" aria-hidden="true"></i> -->
            <hr>
            <label style="text-align: left;" for="" >Select criterion</label>
            <select name="" id="selectedMode" style="font-size: 10px;cursor: pointer;" type="text" class="form-control">
              <option value="">Select</option>
              <option style="display: none;" value="1">Full Previous Bal & Full for this week </option>
              <option style="display: none;"  value="2">Only Previous Balances</option>
              <option style="display: none;"  value="3">Only this Week's Total  </option>
              <option style="display: none;"  value="4">Partial for this Week </option>
              <option style="display: none;"  value="5">Partial Previous balances </option>
              <option style="display: none;" value="6">Full Previous & Partial for this week </option>
              <option style="display: none;" value="7">Partial Previous Bal & Full for this week  </option>
              <option value="8"> Set % of arrears and % of current week total  </option>
              <option style="display: none;"value="9">Carry all balances foward  </option>
              </select>
              <div id="week_per" style="display: none;">
                <label style="text-align: left;margin-top: 10px; width: 100%;" for="" >Set % payable for this week </label>
                <input type="number" id="week_per_val" max="100" required  style="height: 25px; font-size: 10px;width: 100%;"placeholder="%" >
              
              </div>

              <div id="prev_per"style="display: none;">
                <label style="text-align: left; margin-top: 10px;" for="" >Set % payable for arrears </label>
                <input type="number" id="prev_per_val" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;"placeholder="%" >
            
              </div>
              <input type="text" id="mode_value"  required name="begin" style="height: 25px; font-size: 10px;width: 100%; display: none;"placeholder="" >
           <div style="height: 1px;background: rgb(73, 4, 4);width: 100%; margin-top: 30px;"></div>

          <div style="text-align: center;">
            
               <button onclick="next()" style="height: 30px; font-size: 10px; align-items: center; margin-top: 10px; width: 60px;"id="btnNext" class="btn btn-primary"><b>Next</b></button>
                <button onclick="set()" style="height: 30px; font-size: 10px; align-items: center; margin-top: 10px;text-align: center; width: 60px; display: none; " id="btnSet" class="btn btn-primary"><b>Set</b></button>
            
           <button onclick="cancelMode()" style="height: 30px; font-size: 10px; align-items: center; margin-top: 10px; width: 60px;" class="btn btn-danger"><b>Clear</b></button>

          </div>
          </div>
          
        </div>
      </div>
      </div>

      <div id="namesAchiver"  style="margin-top: 6%; float: right; display: none;   margin-left: 50px; width: 350px; position: absolute; z-index: 1007;">
        <div   class="card" id="login23">
          <div style="margin-top: 10px;">
            <i title="Dowload History" onclick="closeArchive()" id="downloadTop2" class="fa fa-times" style=" float: right; size: 40px;margin-right: 20px;cursor: pointer;" aria-hidden="true"></i>
        
            <i onclick="saveHistory('xlsx')" style=" float: right; margin-right: 15px; cursor: pointer;" title="Dowload History" class="fa fa-download "aria-hidden="true"></i>
          </div>
          
        <div class="card-body" >
          <div class="d-flex flex-column">
            <div class="card-body"style="height: 400px; margin: 5px; width: 100%;">
              <!-- <div ></div> -->
              <!-- <h4 style="font-size: 16px; text-align: center;color: rgb(29, 5, 69);">Project Transactions</h4> -->
              <h4  style="width: 100%; font-size: 15px; color: brown; text-align: center;" class="startForm">PAYMENT HISTORY</h4>

              <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">
                <div style="width: 100%; max-height: 480px; height: 350px; "class="table-responsive">
                  <table class="table table-hover table-bordered table-striped " id="tablePaymentsHistry" style="height: 100px; width: 100%;">
                     <thead style="color: brown;font-size: 10px;position: sticky;top: 0; z-index: 1;background-color: white; margin-top: -2px;">
                      <th>Week ID</th>
                      <th>Amount</th>
                     
                     </thead>
                     <tbody id = "tbodyPayHist" style="font-size: 12px;">

                     </tbody>
                   
                   </table>
                 </div>         

               </div>

          </div> 
          

          </div>
          
        </div>
      </div>
      </div>

        <!-- Project Card Example -->
        <div class="card shadow mb-4" id="labor_lister" >

          <div style=" text-align: center; margin-top: 20px;color: brown;">
            <h4><b> SITE PAYMENTS</b></h4>

            

           <!-- <div style="border: 1px solid; margin-bottom: 10px;"> </div> -->
           

            <i title="Dowload Wagebill" onclick="savePayments('xlsx')" id="downloadTop2" class="fa fa-download" style=" float: right; size: 40px;margin-right: 20px;cursor: pointer;" aria-hidden="true"></i>
        
            <i onclick="showOverTime()" style=" float: right; margin-right: 15px; cursor: pointer;" title="Open field" class="fa fa-pencil-square-o" aria-hidden="true"></i>
            <i onclick=" confirmDay()" id="projector" style=" float: right; margin-right: 15px; cursor: pointer;" title="Project this week's wagebill" class="fa fa-eye" aria-hidden="true"></i>
            <i class="fa fa-credit-card" style="float: right; margin-right: 20px;cursor: pointer;" onclick="openPmode()" id="modeOpenner" aria-hidden="true" title="Payment Mode"></i>
            <i class="fa fa-credit-card" style="float: right; margin-right: 20px;cursor: pointer; display: none;" onclick="closePmode()" id="modeCloser" aria-hidden="true" title="Close"></i>
            <div  id="clicker"><i onclick="showachive()"  style=" float: right; margin-right: 15px; cursor: pointer;" title="Archive" class="fa fa-archive" aria-hidden="true" id="arch"> <sup id="alerter" style="display: none;"><span id="blinker2"><i onclick="functionhere()" title="Add to archive." style="color: red; cursor: pointer;  position: absolute; z-index: 1000; margin-left: -5px; animation: blink 2s ease-in infinite;" class="fa fa-arrow-circle-down" aria-hidden="true"></i></span> </sup></i></div>
      
            
            <div class="search-wrapperS "style="float: left; display: inline-flex; margin-left: 20px; margin-bottom: 5px;">
              <input type="date" id="date"  required name="begin" style="cursor: pointer;" >
                              
               
                <button style="font-size: 10px; width: 100px; margin-left: 2px;border-radius: 5px;background-color: rgb(92, 16, 16);color: aliceblue;border-color: rgb(92, 16, 16);"id="btnViewPayments" onclick="getDateFirst()" class="getClientsDetails" type="getClientsDetails"><b>VIEW</b></button>

              </div>
           
           

          </div>

            <div onclick="closePmode()"   class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
            <!-- <div style="align-items: center;">
              <h6 class="m-0 font-weight-bold text-primary"style="font-size: 11px; text-align: center;">Project Payments</h6>
            </div>
             -->
            <!-- ----------------------- -->
            
            <div style="align-items: center;display: flex; width: 100%;float: left;">

        <!-- <button onclick="back()">BACK</button> -->
                  
                    <div class="paymentSums" style="display: flex;">
                        <h4 id="laborTotal" style="margin-left: 20px;font-size: 11px;color: rgb(123, 4, 80);">Labor: Ksh</h4><span style="display: none;" id="lCounter" >0</span>
                        <h4 onclick="openBillsCard()" style="margin-left: 20px;font-size: 11px;color: rgb(39, 3, 147); cursor: pointer;" ><i title="View bills" style="cursor: pointer;" class="fa fa-sort-desc" aria-hidden="true"></i> <span id="OtherTotal">Bills: </span></h4>
                        <h3 id="prevBalH" style="margin-left: 20px;font-size: 11px;  color: rgb(216, 171, 7);">Total Arrears: Ksh<span id="prevBal">0</span><sup id="pendingStatus" style="float: right;"><span id="pendingStatus2" style="display: none;"><i onclick="getDateFirstForBAlances()" title="Some pending balances may have not been loaded. Click to load." style="color: red; cursor: pointer; " class="fa fa-circle" aria-hidden="true"></i></span><span id="balLoader" style="display: none;color: rgb(7, 7, 7);"><i  class="fa fa-spinner fa-spin "></i></span></sup></h3>
                        <h3 id="SumTotal" style="margin-left: 20px;font-size: 11px;">Total: Ksh0</h3>
                        <h3 id="payHolder" style="margin-left: 20px;font-size: 11px; text-align:right;"><span id="modePresenter" style="color: green;" ></span> <span id="totalPayable" style="color: green; display: none; margin-left: 20px;">0</span></h3>    

                        <h3 id="projectingStatus"style="margin-left: 20px;font-size: 11px; display: none; ">FALSE</h3>
                        <h3 id="SumProjectedH" style="margin-left: 20px;font-size: 11px; display: none; color: red;">Projected: Ksh<span id="SumProjected">0</span></h3>
                        <h3 id="SumTotalAll"style="margin-left: 20px;font-size: 11px; display: none; "><b>Total: Ksh</b><span id="SumTotalAllH">0</span></h3>
                    </div>
                   

                    
            </div>  
            <div style="float: right;width: 50%;">
            </div>
            <div  id="overtimeWrapper" class="search-wrapperS card"style="float: right;  display: inline-flex; margin-left: 20px; margin-bottom: 0px; display: none; position: inherit;z-index: 1000;">
              <input type="text" id="sign"  required name="begin" style="width: 12%;font-size: 10px; text-align: center; margin-left: 5px;border: 1px solid brown; border-radius: 3px;"placeholder="+-" >
              <input type="number" id="ovTime"  required name="begin" style="width: 70%;font-size: 10px; border: 1px solid brown; border-radius: 3px;"placeholder="Amount" >
                  
              <i title="Close" onclick="closeHolder()" style="margin-top: -15px; cursor: pointer;" class="fa fa-times" aria-hidden="true"></i>
            </div>
          
            
            <!-- -------------------------- -->
            
            <div class="dropdown no-arrow">
              
                <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> pending-->
              
                
            </div>
        </div>
            <!-- <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
            </div>
         -->
         
             <div class="card-body"style="height: 500px; margin: 5px;" onclick="closeArchive()">
                <!-- <div ></div> -->
                <!-- <h4 style="font-size: 16px; text-align: center;color: rgb(29, 5, 69);">Project Transactions</h4> -->
                     

                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">
                  <div style="width: 100%; max-height: 480px; height: 500px; "class="table-responsive">
                    <table class="table table-hover table-bordered table-striped " id="tablePayments" style="height: 100px;">
                       <thead style="color: brown;font-size: 10px;position: sticky;top: 0; z-index: 1;background-color: white; margin-top: -2px;">
                        <th>Name</th>
                        <th>ID</th>
                        <th>Phone</th>
                        <th>SubL</th>
                        <th>Role</th>
                        <th>Sun</th>
                        <th>Mon</th> 
                        <th>Tue</th>
                        <th>Wed</th>
                        <th>Thur</th>
                        <th>Fri</th>
                        <th>Sat</th>
                        <th>Overtime</th>
                        <th>Week_Total</th>
                        <th id="th15"><b>Paid</b></th>
                        <th id="th16"><b>Balance</b></th>
                        <th id="thprb" ><b>Arrears</b> </th>
                        <th id="thTot"><b>TOTAL_BAL</b></th>
                        <th id="thPayb"><b>PAYABLE</b></th>
                        
                        
                        <th id="thSt"><b>STATUS</b></th>

                       </thead>
                       <tbody id = "tbodyPDFC" style="font-size: 10px;">

                       </tbody>
                     
                     </table>
                   </div>         

                 </div>

            </div> 
        </div>

   </div>

   
</div>

</div>

<div id="attendanceForSite"style="margin: 40px; display:none">
  <div  class="row"style="width: 100%;">

<!-- =========================Day selector============================= Monday spinner-->


<!-- =========================End Day selector============================= -->

    <!-- Content Column -->
    <div class="card" style="width: 100%;">
      <!-- Trigger/Open The Modal -->
    

    <!-- The Modal -->
    <div id="myModal" class="modal" >

      <!-- Modal content -->
      <div class="modal-content" >
        <span class="close">&times;</span>
        <div style=" text-align: center; margin-top: 20px;color: brown; margin-right: 50px;margin-left: 50px;">
          
          <div class="centered">
            <div   class="card" id="login">
            <div class="card-body">
              <div class="d-flex flex-column align-items-center text-center">
                <h4 class="startForm">CLOCK WORKER</h4>
                <hr>
                <form action="">
                
                  <!-- <input onclick="getProjectNames()" type="text" placeholder="Select Project" id="email"  required style="cursor: pointer;"> -->
                  <input type="text" placeholder="Enter ID Number" id="idNumber" required>
                 
                  <hr>
                  <div class="row">
                    <div>
                      
                      
                    </div>
                    <div class="col-sm-12">
                      <button onclick="startRegistering()" id="btnClock" class="btn btn-info " target="__blank" style="width: 50%;" ><span id="okSpan">OK</span><i id="loader" style="height: 20px; display: none;" class="fa fa-spinner fa-spin "></i></button>
                    </div>
                  </div>
                  
                </form>
               
              </div>
              
            </div>
           </div>
           </div>
        </div>
      </div>
     

      

    </div>





        <!-- Project Card Example -->
        <div id="iiid" class="card shadow mb-4">
          <div style=" text-align: center; margin-top: 20px;color: brown;">
            <h4><b> SITE ATTENDANCE</b></h4>
          </div>
            <div
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
            <!-- <div style="align-items: center;">
              <h6 class="m-0 font-weight-bold text-primary"style="font-size: 11px; text-align: center;">Project Payments</h6>
            </div>
             -->
            <!-- ----------------------- -->
         
            <!-- -------------------------- -->
              <div class="search-wrapperS table-responsive table-wrapper-scroll-y my-custom-scrollbar2" style="display: flex;">
                <input type="date" id="dateAtendance" name="begin" >
                                
                 
                  
                <button style="font-size: 10px; width: 100px; margin-left: 2px;border-radius: 5px;background-color: rgb(92, 16, 16);color: aliceblue;border-color: rgb(92, 16, 16);"id="btnViewAt" onclick="getPendingS()" class="getClientsDetails" type="getClientsDetails"><b>VIEW</b></button>
                <!-- <button style="bac" id="myBtn">Open Modal</button> -->
                <div style="align-items: center; display: none;">
                  <i class="fa fa-clock-o" aria-hidden="true" id="myBtn" style="margin-left: 30px;"></i>
                </div>
                
              </div>
                  
              
             
            <div class="dropdown no-arrow">
           
                <i id="openSel" onclick="openDaySelector()" class="fa-li fa fa-clock-o " style=" font-size: 20px;cursor: pointer;display: none;"title="Mark register for a different day"></i>
                <i id="closeSel" onclick="closeDaySelector()" class="fa-li fa fa-power-off " style=" font-size: 20px;cursor: pointer; display: none;"title="Stop marking for a different day"></i>
                <i onclick="saveaTTENDANCE('xlsx')" id="downloadTop" class="fa fa-download" style=" font-size: 20px;size: 40px;margin-left: 20px;cursor: pointer;" aria-hidden="true"></i>
                 
                <div  id="daySelectorH" class="centered " style="margin-top: 20px; background-color: brown;border-bottom-left-radius: 20px; display: none; float: left; left: -200px;margin-right: 20px; height: 100%; position: absolute; z-index: 3021; width: 200px;">
                                <div style="background-color: brown; border-bottom-left-radius: 20px;"  class="card" id="login">
                                <div class="card-body">
                                  <select name="" id="selectedDay" style="font-size: 12px;cursor: pointer;" type="text" class="form-control">
                                    <option value="">Select Day</option>
                                    <option value="Monday">Monday</option>
                                    <option value="Tuesday">Tuesday</option>
                                    <option value="Wednesday">Wednesday           </option>
                                    <option value="Thursday">Thursday            </option>
                                    <option value="Friday">Friday            </option>
                                    <option value="Saturday">Saturday            </option>
                                    <option value="Sunday">Sunday            </option>
                                    
                                    </select>
                                  
                                </div>
                              </div>
                              </div>
                
            </div>
            
        </div>
            <!-- <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
            </div>
         -->
         
             <div class="card-body" style="height: 520px; margin: 5px;">
              <div style=" align-items: center;">
                <h4 style="font-size: 12px;">Total: <span id="attenCounter">0</span></h4>
            </div>
                <!-- <div ></div> -->
                <!-- <h4 style="font-size: 16px; text-align: center;color: rgb(29, 5, 69);">Project Transactions</h4> -->
                     

                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">
                  <div style="width: 100%;  height: 480px; "class="table-responsive">
                    <table class="table table-hover table-bordered table-striped " id="tableAttendance">
                       <thead style="color: brown;font-size: 11px;position: sticky;top: 0; z-index: 1;background-color: white; margin-top: -2px;">
                        <th>Name </th>
                        <th>ID</th>
                        <th>Sub-location</th>
                        <th  id="su">Sunday <i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="sunAll" class="fa fa-check" aria-hidden="true"></i></th>
                        <th id="m1">Monday <i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="m1All" title="Mark all" class="fa fa-check" aria-hidden="true"></i></th>
                        <th id="t1">Tuesday <i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="t1All" title="Mark all" class="fa fa-check" aria-hidden="true"></i></th>
                        <th id="w1">Wednesday<i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="w1All" title="Mark all" class="fa fa-check" aria-hidden="true"></i></th>
                        <th id="t2">Thursday <i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="t2All" title="Mark all" class="fa fa-check" aria-hidden="true"></i></th>
                        <th id="f1">Friday <i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="f1All" title="Mark all" class="fa fa-check" aria-hidden="true"></i></th>
                        <th id="s1">Saturday <i style="color:green; font-size:14px; float:right; display: none; cursor: pointer;" id="s1All" title="Mark all" class="fa fa-check" aria-hidden="true"></i></th>
                        
                         <!-- <th style="min-width: 100px;">Action</th>  -->
                        <!--<th>Status</th> -->

                       </thead>
                       <tbody id = "tbodyPS" style="font-size: 11px;">

                       </tbody>
                      <!-- <tbody id="holderMain">
                        <h3 id="holder"></h3>
                      </tbody> -->
                     
                     </table>
                   </div>         

                 </div>

            </div> 
        </div>

   </div>

   
</div>

</div>

<div id="staff_panel" style="margin: 30px;padding-top: 20px; padding-left: 20px; display: none;"class="card" >


  <h4 style="text-align: center; margin-bottom: 30px;margin-top: 10px; color: brown;"><b>STAFF RECORDS</b></h4>

  <!-- --------------------------------------------------- -->

   <div id="perBIG" class="card2 shadow mb-4" style=" position: absolute; z-index: 100; width: 1100px; display: none; background-color: white;border-radius: 5px;">
    <div style=" text-align: center; margin-top: 20px;color: brown;">
      <h4><b> IN-HOUSE SITE WORKERS</b></h4>
    </div>
      <div
      class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
      <!-- <div style="align-items: center;">
        <h6 class="m-0 font-weight-bold text-primary"style="font-size: 11px; text-align: center;">Project Payments</h6>
      </div>
       -->
      <!-- ----------------------- -->
   
      <!-- -------------------------- -->
        <div class="search-wrapperS table-responsive table-wrapper-scroll-y my-custom-scrollbar2" style="display: flex;">
          <!-- <input type="date" id="dateAtendance" name="begin" > -->
                          
           
            
          <!-- <button style="font-size: 10px; width: 100px; margin-left: 2px;border-radius: 5px;background-color: rgb(92, 16, 16);color: aliceblue;border-color: rgb(92, 16, 16);"id="btnViewAt" onclick="getPendingS()" class="getClientsDetails" type="getClientsDetails"><b>VIEW</b></button> -->
          <!-- <button style="bac" id="myBtn">Open Modal</button> -->
          <!-- <div style="align-items: center; display: none;">
            <i class="fa fa-clock-o" aria-hidden="true" id="myBtn" style="margin-left: 30px;"></i>
          </div> -->
          
        </div>
            
        
       
      <div class="dropdown no-arrow">
     
          <!-- <i id="openSel" onclick="openDaySelector()" class="fa-li fa fa-clock-o " style=" font-size: 20px;cursor: pointer;"title="Mark register for a different day"></i>
          <i id="closeSel" onclick="closeDaySelector()" class="fa-li fa fa-power-off " style=" font-size: 20px;cursor: pointer; display: none;"title="Stop marking for a different day"></i> -->
          <i onclick="closePerms()" id="downloadTop" class="fa fa-times" style=" font-size: 20px;size: 40px;margin-left: 20px;cursor: pointer; color: red;" aria-hidden="true" title="Close"></i>
           
          <div  id="daySelectorH" class="centered " style="margin-top: 20px; background-color: brown;border-bottom-left-radius: 20px; display: none; float: left; left: -200px;margin-right: 20px; height: 100%; position: absolute; z-index: 3021; width: 200px;">
                          <div style="background-color: brown; border-bottom-left-radius: 20px;"  class="card" id="login">
                          <div class="card-body">
                            <select name="" id="selectedDay" style="font-size: 12px;cursor: pointer;" type="text" class="form-control">
                              <option value="">Select Day</option>
                              <option value="Monday">Monday</option>
                              <option value="Tuesday">Tuesday</option>
                              <option value="Wednesday">Wednesday           </option>
                              <option value="Thursday">Thursday            </option>
                              <option value="Friday">Friday            </option>
                              <option value="Saturday">Saturday            </option>
                              <option value="Sunday">Sunday            </option>
                              
                              </select>
                            
                          </div>
                        </div>
                        </div>
          
      </div>
      
  </div>
      <!-- <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
      </div>
   -->
   
       <div class="card-body" style="height: 450px; margin: 5px;">
        <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

          <div id="tableTop" class="table-responsive" style=" height: 400px;">
              <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
          <table class="table table-hover table-bordered table-striped " id="tableCasuals">
              <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white;">
                  <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                  <th>Name</th>
                  <th>ID</th>
                  <th>SubL</th>
                  <th>Phone</th>
                  <th>C.Site</th> 
                  <th>Designation</th>
                  <th>Wage</th> 
                  <th style="min-width: 80px;">Action</th> 
                  
                  
                  
                  
              </thead>
              <tbody style="font-size: 9px;"  id = "tbodyPermanent2">
          
              </tbody>
              
          </table>
          </div>          

   </div>

      </div> 
  </div>
  <div id="tempBIG" class="card2 shadow mb-4" style=" position: absolute; z-index: 100; width: 1100px; display: none; background-color: white;border-radius: 5px;">
    <div style=" text-align: center; margin-top: 20px;color: brown;">
      <h4><b> TEMPORARY SITE WORKERS</b></h4>
    </div>
      <div
      class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
      <!-- <div style="align-items: center;">
        <h6 class="m-0 font-weight-bold text-primary"style="font-size: 11px; text-align: center;">Project Payments</h6>
      </div>
       -->
      <!-- ----------------------- -->
   
      <!-- -------------------------- -->
        <div class="search-wrapperS table-responsive table-wrapper-scroll-y my-custom-scrollbar2" style="display: flex;">
          <!-- <input type="date" id="dateAtendance" name="begin" > -->
                          
           
            
          <!-- <button style="font-size: 10px; width: 100px; margin-left: 2px;border-radius: 5px;background-color: rgb(92, 16, 16);color: aliceblue;border-color: rgb(92, 16, 16);"id="btnViewAt" onclick="getPendingS()" class="getClientsDetails" type="getClientsDetails"><b>VIEW</b></button> -->
          <!-- <button style="bac" id="myBtn">Open Modal</button> -->
          <!-- <div style="align-items: center; display: none;">
            <i class="fa fa-clock-o" aria-hidden="true" id="myBtn" style="margin-left: 30px;"></i>
          </div> -->
          
        </div>
            
        
       
      <div class="dropdown no-arrow">
     
          <!-- <i id="openSel" onclick="openDaySelector()" class="fa-li fa fa-clock-o " style=" font-size: 20px;cursor: pointer;"title="Mark register for a different day"></i>
          <i id="closeSel" onclick="closeDaySelector()" class="fa-li fa fa-power-off " style=" font-size: 20px;cursor: pointer; display: none;"title="Stop marking for a different day"></i> -->
          <i onclick="closeTemps()" id="downloadTop" class="fa fa-times" style=" font-size: 20px;size: 40px;margin-left: 20px;cursor: pointer; color: red;" aria-hidden="true" title="Close"></i>
           
          <div  id="daySelectorH" class="centered " style="margin-top: 20px; background-color: brown;border-bottom-left-radius: 20px; display: none; float: left; left: -200px;margin-right: 20px; height: 100%; position: absolute; z-index: 3021; width: 200px;">
                          <div style="background-color: brown; border-bottom-left-radius: 20px;"  class="card" id="login">
                          <div class="card-body">
                            <select name="" id="selectedDay" style="font-size: 12px;cursor: pointer;" type="text" class="form-control">
                              <option value="">Select Day</option>
                              <option value="Monday">Monday</option>
                              <option value="Tuesday">Tuesday</option>
                              <option value="Wednesday">Wednesday           </option>
                              <option value="Thursday">Thursday            </option>
                              <option value="Friday">Friday            </option>
                              <option value="Saturday">Saturday            </option>
                              <option value="Sunday">Sunday            </option>
                              
                              </select>
                            
                          </div>
                        </div>
                        </div>
          
      </div>
      
  </div>
      <!-- <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
      </div>
   -->
   
       <div class="card-body" style="height: 450px; margin: 5px;">
        <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

          <div id="tableTop" class="table-responsive" style=" height: 400px;">
              <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
          <table class="table table-hover table-bordered table-striped " id="tableCasuals">
              <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white;">
                  <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                  <th>Name</th>
                  <th>ID</th>
                  <th>SubL</th>
                  <th>Phone</th>
                  <th>C.Site</th> 
                  <th>Designation</th>
                  <th>Wage</th> 
                  <th style="min-width: 80px;">Action</th>  
                  
                  
                  
                  
              </thead>
              <tbody style="font-size: 9px;"  id = "tbodyE2">
          
              </tbody>
              
          </table>
          </div>          

   </div>

      </div> 
  </div>
  <!-- --------------------------------------------------- -->
  <div class="row">
   
    <!-- Content Column -->
    <div class="col-lg-6 mb-4">

        <!-- Project Card Example -->
        <div class="card2 shadow mb-4" >

            <div
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
            <h6 style="font-size: 14px;" class="m-0 font-weight-bold text-primary">IN-HOUSE</h6>
            
            <div class="dropdown no-arrow">
              <i id="loadingView22" onclick="openPermsBig()"  class="fa fa-arrows-alt" title="Enlarge View" aria-hidden="true" style="cursor: pointer; margin-right: 10px;"></i>
                <i onclick="savePemanent('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"style="cursor: pointer;"></i>
                
            </div>
        </div>
            <!-- <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
            </div>
         -->

             <div class="card-body" >
                <!-- <div ></div> -->
                <div id="editDetais2"  style="margin-top: 20px;margin-top: 1%;position: absolute; z-index: 2006; float: left; margin-left: 10%; width: 200PX; display: none;">
                  <div   class="card" id="login">
                  <div class="card-body">
                    <div>
                       <h4 id="itemSelect" style="width: 100%; cursor: grab; font-size: 14px; float: left;" class="startForm"><b>Edit Worker<i onclick="closeEditor2()" id="closeEdEditor" style="align-items: center; margin-left: 10px; cursor: pointer; height: 20px;  color: brown; float: right;" title="Close" class="fa fa-times" aria-hidden="true"></i></b></h4>
                 
                      

                    </div>
                     
                      <hr>
                      
                        <form action="" style="align-items: left; font-size: 11px;">
                          <label style="text-align: left;" for="" ><b>Name</b> </label>
                          <input style="width: 100%; " type="text" id="editNameIn" name="begin">
                          <label style="text-align: left;" for="" ><b>Sub-location</b> </label>
                          <input style="width: 100%; " type="text" id="editSubLIn" name="begin" >
                          <label style=" margin-top: 3px;align-items: left;" for=""><b>Phone</b></label>
                          <input style="width: 100%; "  type="number" id="editPhoneIn" name="begin" >
                          <label style=" margin-top: 3px;align-items: left;" for=""><b>Current Site</b></label>
                          <input style="width: 100%; "  type="text" id="editSiteIn" name="begin" > 
                          <label style=" margin-top: 3px;align-items: left;"for=""><b>Designation</b></label>
                          <input style="width: 100%; "  type="text" id="editDesigIn" name="begin" >
                          <label style=" margin-top: 3px;align-items: left;"for=""><b>Wage</b></label>
                          <input style="width: 100%; margin-bottom: 4PX; "  type="number" id="editWageIn" name="begin" > 
                          <input style="width: 100%; margin-bottom: 4PX;display: none;"  type="number" id="editIDIn" name="begin" > 
                          <input style="width: 100%; margin-bottom: 4PX;display: none;"  type="number" id="editTypIn" name="begin" > 
                          <input style="width: 100%; margin-bottom: 4PX;display: none;"  type="number" id="editProIn" name="begin" > 
                        </form>
                        
                     <div style="height: 1px;background: white;width: 100%;"></div>
                     <button id="editWorker2" onclick="editWorkersIn()" style="float: left; height: 30px; font-size: 14px; align-items: center; margin-top: 10px; border-radius: 10px; border-color: brown; margin-top: 10px;" >Submit</button>
                          
                    
                  </div>
                 </div>
                 </div>
                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                        <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                            <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                        <table class="table table-hover table-bordered table-striped " id="tablePermanent">
                            <thead style="font-size: 9px; position: sticky; top: -2px; background-color: white;">
                                <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                                <th>Name</th>
                                <th>ID</th>
                                <th>SubL</th>
                                <th>Phone</th>
                                <th>C.Site</th> 
                                <th>Desidnation</th>
                                <th>Allowance</th> 
                                <th style="min-width: 80px;">Actioin</th>
                               
                                
                                
                                
                            </thead>
                            <tbody style="font-size: 9px;" id = "tbodyPermanent">
                            
                            </tbody>
                            
                        </table>
                        </div>          

                 </div>


      
            </div> 
        </div>

     
    </div>
    <div class="col-lg-6 mb-4">

      <!-- Project Card Example -->
      <div class="card2 shadow mb-4" >

          <div
          class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
          <h6 style="font-size: 14px;"  class="m-0 font-weight-bold text-primary">TEMPORARY</h6>
          
          <div class="dropdown no-arrow">
              <i id="loadingView22" onclick="openCasBig()"  class="fa fa-arrows-alt" title="Enlarge View" aria-hidden="true" style="cursor: pointer; margin-right: 10px;"></i>
              <i onclick="saveCasuals('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true"style="cursor: pointer;"></i>
              
          </div>
      </div>
          <!-- <div class="card-header py-3">
              <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
          </div>
       -->

           <div class="card-body" >
              <!-- <div ></div> -->
              <!-- <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2"style="top: 50%; max-height: 300px; height: 300px;position: absolute; z-index: 3020;">
              <div id="editDetais" class="table-responsive" style="max-height: 300px; height: 300px;">
                <table class="table table-hover table-bordered table-striped" id="">
                  <i onclick="saveCasuals('xlsx')" id="downloadTop" class="fa fa-times-circle" aria-hidden="true"style="cursor: pointer; float: right;"></i>
                  <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white; background-color: brown;">
                   
                    <td><input type="text" id="nameEdit" name="begin" ></td>
                  
                    <input type="text" id="subLEdit" name="begin" >
                    <input type="number" id="editPhone" name="begin" >
                    <input type="text" id="editSite" name="begin" > 
                    <input type="text" id="editDesig" name="begin" >
                    <input type="number" id="editWage" name="begin" > 
                    
                    
                    
                    
                </thead>
              </table>
             </div>
            </div> -->


            <div id="editDetais"  style="margin-top: 20px;margin-top: 1%;position: absolute; z-index: 2006; float: left; margin-left: 10%; width: 200PX; display: none;">
              <div   class="card" id="login">
              <div class="card-body">
                
                  <h4 id="itemSelect" style="width: 100%; cursor: grab; font-size: 14px; float: left;" class="startForm"><b>Edit Worker<i onclick="closeEditor()" id="closeEditDetails" style="align-items: center; margin-left: 10px; cursor: pointer; height: 20px;  color: brown; float: right;" title="Close" class="fa fa-times" aria-hidden="true"></i></b></h4>
             
                 
                  <hr>
                  
                    <form action="" style="align-items: left; font-size: 11px;">
                      <label style="text-align: left;" for="" ><b>Name</b> </label>
                      <input style="width: 100%; " type="text" id="editName" name="begin" >
                      <label style="text-align: left;" for="" ><b>Sub-location</b> </label>
                      <input style="width: 100%; " type="text" id="editSubL" name="begin" >
                      <label style=" margin-top: 3px;align-items: left;" for=""><b>Phone</b></label>
                      <input style="width: 100%; "  type="number" id="editPhone" name="begin" >
                      <label style=" margin-top: 3px;align-items: left;" for=""><b>Current Site</b></label>
                      <input style="width: 100%; "  type="text" id="editSite" name="begin" > 
                      <label style=" margin-top: 3px;align-items: left;"for=""><b>Designation</b></label>
                      <input style="width: 100%; "  type="text" id="editDesig" name="begin" >
                      <label style=" margin-top: 3px;align-items: left;"for=""><b>Wage</b></label>
                      <input style="width: 100%; margin-bottom: 4PX; "  type="number" id="editWage" name="begin" > 
                      <input style="width: 100%; margin-bottom: 4PX;display: none;"  type="number" id="editID" name="begin" > 
                      <input style="width: 100%; margin-bottom: 4PX;display: none;"  type="number" id="editTyp" name="begin" > 
                      <input style="width: 100%; margin-bottom: 4PX;display: none;"  type="number" id="editPro" name="begin" > 
                    </form>
                    
                 <div style="height: 1px;background: white;width: 100%;"></div>
                 <button id="editWorker" onclick="editWorkers()" style="float: left; height: 30px; font-size: 14px; align-items: center; margin-top: 10px; border-radius: 10px; border-color: brown; margin-top: 10px;" >Submit</button>
                  
                      
                
              </div>
             </div>
             </div>
              <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                      <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                          <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                      <table class="table table-hover table-bordered table-striped " id="tableCasuals">
                          <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white;">
                              <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                              <th>Name</th>
                              <th>ID</th>
                              <th>SubL</th>
                              <th>Phone</th>
                              <th>C.Site</th> 
                              <th>Designation</th>
                              <th>Wage</th> 
                              <th style="min-width: 80px;">Action</th>  
                              
                              
                              
                              
                          </thead>
                          <tbody style="font-size: 9px;"  id = "tbodyE">
                      
                          </tbody>
                          
                      </table>
                      </div>          

               </div>


  
          </div> 
      </div>

   
  </div>
  <div class="col-lg-6 mb-4">

    <!-- Project Card Example -->
    <div class="card2 shadow mb-4" >

        <div
        class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
        <h6 style="font-size: 14px;" class="m-0 font-weight-bold text-primary">CONTRACT/PERMANENT</h6>
        
        <div class="dropdown no-arrow">
            <!-- <i id="loadingView2" class="fa-li fa fa-spinner fa-spin"></i> -->
            <i onclick="saveContract('xlsx')" id="downloadTop" class="fa fa-download" aria-hidden="true" style="cursor: pointer;"></i>
            
        </div>
    </div>
        <!-- <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Top Student Per Subject</h6>
        </div>
     -->

         <div class="card-body" >
            <!-- <div ></div> -->

            <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

                    <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
                        <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
                    <table class="table table-hover table-bordered table-striped " id="tableContract">
                        <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white;">
                            <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                            <th>Name</th>
                            <th>ID</th>
                            <th>SubL</th>
                            <th>Phone</th>
                            <th>C.Site</th> 
                            <th>Designation</th>
                            <th>Salary</th> 
                            <th style="min-width: 80px;">Action</th> 
                            
                            
                            
                            
                        </thead>
                        <tbody style="font-size: 9px;"  id = "tbodyContract">
                        
                        </tbody>
                        
                    </table>
                    </div>          

             </div>


    
        </div> 
    </div>

 
</div>

<div class="col-lg-6 mb-4">

  <!-- Project Card Example -->
  <div class="card2 shadow mb-4" >

      <div
      class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
      <h6 style="font-size: 14px;" class="m-0 font-weight-bold text-danger">QUICK ANALYTICS</h6>  <i  style="margin-right: 10px; float: right;"  class="fa fa-bar-chart text-danger" aria-hidden="true"></i>

      
      
  </div>
     

       <div class="card-body"style=" height: 340px; background-color: rgb(229, 231, 236);">
         
        <div class="chart">
          <canvas id="barChartStaff" style="min-height: 400px; height: 400px; max-height: 400px; max-width: 100%;"></canvas>
        </div>
       

  
      </div> 
  </div>


</div>
   
</div>

</div>

<!-- -----------------project schedule----------------- -->

<div id="projects_progress" class="card shadow mb-4"style="margin:55px; height: 100%; display: none; ">

  <div id="namesScheduler"  style="margin-top: 5%; float: right; display: none;   margin-left: 30px; width: 250px; position: absolute; z-index: 1006;">
    <div   class="card" id="login23">
    <div class="card-body" >
      <div class="d-flex flex-column">
        
        <h4  style="width: 100%; font-size: 18px; color: brown; text-align: center;" class="startForm">NEW SCHEDULE</h4>
        <!-- Overtime <i onclick="closeBillsCard()" style="margin-left: 10px; cursor: pointer; height: 20px;float: right; color: rgb(22, 13, 13);" title="Close" class="fa fa-times" aria-hidden="true"></i> -->
        <!-- <hr> -->
          <div >
            <label style="text-align: left; margin-top: 10px;font-size: 11px;" for="" ><b>Milestone</b>  </label>
            <input type="text" id="n_name" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;"placeholder="Short name" >

          </div>
          <div  >
            <label style="text-align: left;margin-top: 5px; width: 100%;font-size: 11px;" for="" ><b>Description</b> </label>
            <textarea type="text" id="act" max="100" required  style="height: 50px; font-size: 10px;width: 100%;"placeholder="A short description about the activity" ></textarea>
          
          </div>
          <div >
            <label style="text-align: left; margin-top: 5px;font-size: 11px;" for="" ><b>Starting Date</b></label>
            <input type="date" id="dateOne" max="100"  required  style="height: 25px; font-size: 10px;width: 100%; "placeholder="" >
        
          </div>
          <div >
            <label style="text-align: left; margin-top: 5px;font-size: 11px;" for="" ><b>Ending Date</b>  </label>
            <input type="date" id="dateTwo" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;"placeholder="" >
        
          </div>
          <div >
            <label style="text-align: left; margin-top: 5px;font-size: 11px;" for="" ><b>Color</b>  </label>
       
            <select name="" id="selectedColor" style="font-size: 10px;cursor: pointer;" type="text" class="form-control">
                  <option value="">Select</option>
                  <option value="greenClass">Green </option>
                  <option value="blueClass">Blue</option>
                  <option value="brownClass">Brown</option>
                  <option value="pinkClass">Pink</option>
                  <option value="redClass">Red</option>
                  <option value="greyClass">Grey</option>
                  <option value="orangeClass">Orange </option>
                  <option value="lightBlue">Light blue</option>
                  </select>
          </div>
        
          <div >
            <label style="text-align: left; margin-top: 5px; font-size: 11px;" for="" ><b>Milestone KIPs <span id="kpiCount"></span></b>  </label>
            <input type="text" id="act1" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;"placeholder="Stage 1" >
            <input type="text" id="act2" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;display: none;"placeholder="Stage 2" >
            <input type="text" id="act3" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;display: none;"placeholder="Stage 3" >
            <input type="text" id="act4" max="100"  required  style="height: 25px; font-size: 10px;width: 100%;display: none;"placeholder="Stage 4" >
            <i id="openM" onclick=" openField()" style="cursor: pointer; color: rgb(107, 96, 96); margin-right: 2px; float: right; font-size: 11px; margin-left: 8px;" title="Add new field" class="fa fa-plus" aria-hidden="true"></i>
            <i id="closeM" onclick=" closeField()" style="cursor: pointer; color: rgb(107, 96, 96); margin-right: 2px; float: right; font-size: 11px; display: none;" title="Close field" class="fa fa-times" aria-hidden="true"></i>

          </div>
          <!-- <input type="text" id="mode_value"  required name="begin" style="height: 25px; font-size: 10px;width: 100%; display: none;"placeholder="" > -->
       <div style="height: 1px;background: rgb(73, 4, 4);width: 100%; margin-top: 30px;"></div>

      <div style="text-align: center;">
        
           <button onclick="sumbitSchedule()" style="height: 30px; font-size: 10px; align-items: center; margin-top: 10px; width: 60px;" class="btn btn-primary"><b>Submit</b></button>
            <!-- <button onclick="set()" style="height: 30px; font-size: 10px; align-items: center; margin-top: 10px;text-align: center; width: 60px; display: none; " id="btnSet" class="btn btn-primary"><b>Set</b></button> -->
        
       <button onclick="cancelAction()" style="height: 30px; font-size: 10px; align-items: center; margin-top: 10px; width: 60px;" class="btn btn-danger"><b>Cancel</b></button>

      </div>
      </div>
      
    </div>
  </div>
  </div>

  <div id="milestonesDisplay"  style="margin-top: 5%; float: right; display: none;   margin-left: 30px; width: 250px; position: absolute; z-index: 1006;">
    <div   class="card" id="login23">
    <div class="card-body" >
      <div class="d-flex flex-column">
        
        <h4 id="msHeader"  style="width: 100%; font-size: 18px; color: brown; text-align: center;" class="startForm">MILESTONES</h4>
        <!-- Overtime <i onclick="closeBillsCard()" style="margin-left: 10px; cursor: pointer; height: 20px;float: right; color: rgb(22, 13, 13);" title="Close" class="fa fa-times" aria-hidden="true"></i> -->
        <!-- <hr> -->
        <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

          <div id="tableTop" class="table-responsive" style="max-height: 300px; height: 300px;">
              <!-- <button id="expEng"class="clickable" onclick="htmlTableToExcelTop('xlsx')">Export </button>  -->
              <div id="tableMilestone">
                <table class="table table-hover table-bordered table-striped " >
                  <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white;">
                      <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
          
                  </thead>
                  <tbody style="font-size: 10px; cursor: pointer;"  id = "tbodyMilestone">
                  
                  </tbody>
              
                 </table>
              </div>
                
              <div id="tableMilestoneActs"style="display: none;">

                 <table class="table table-hover table-bordered table-striped "   >
                    <thead style="font-size: 9px;position: sticky; top: -2px; background-color: white;">
                        <!-- <th class="clickable" onclick="showAll()">Subject</th> -->
                      <th>Activity/KPI</th>
                      <th>Status</th>
                    </thead>
                    <tbody style="font-size: 10px;"  id = "tbodyMilestoneActs">
                    
                    </tbody>
                    
                </table>
              </div>
         
          </div>          

   </div>
      </div>
      
    </div>
  </div>
  </div>


  <div style=" text-align: center; margin-top: 20px;color: brown; float: left;">
    
    <i onclick="openNewScheduleField()" style="cursor: pointer; color: rgb(107, 96, 96); margin-left: 20px; float: left;" title="Add Schedule" class="fa fa-calendar" aria-hidden="true"></i>
    <i id="cloud" onclick=" " style="cursor: pointer; color: rgb(107, 96, 96); margin-left: 20px; float: left;" title="Load master schedule" class="fa fa-cloud-download" aria-hidden="true"></i>
    <i id="mileStoneUp" onclick=" openMilUpdate()" style="cursor: pointer; color: rgb(107, 96, 96); margin-left: 20px; float: left;" title="Update milestone" class="fa fa-level-up" aria-hidden="true"></i>

    <h4><b>PROJECT MASTER SCHEDULE AND PROGRESS</b></h4>

  </div>
  <div>

  </div>
    <div onclick="closeScheduler()" class="card-header py-3 d-flex flex-row align-items-center justify-content-between">

    </div>
  
     <div onclick="closeScheduler()" class="card-body pdody" style="height: 650px; margin: 5px;">
     

        <div   class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2">

        
          <div  style="width: 100%; "class="table-responsive">

            
          <div class="cursor" id="liner">
                
                  <div class="vt"></div>
                  <!-- <div class="hl"></div> onmouseover="hideline()" onmouseout="showline()"-->
            
              </div>
          <div class="rescalendar" id="my_calendar_en" style="display: none;">
       
       
          </div>
          <div class="rescalendar" id="my_calendar_en2" style="display: none;">
       
       
          </div>
          <div class="rescalendar" id="my_calendar_en3" style="display: none;">
       
       
          </div>
          <div class="rescalendar" id="my_calendar_en4" style="display: none;">
       
       
          </div>
          <div class="rescalendar" id="my_calendar_en5" style="display: none;">
       
       
          </div>
          <div class="rescalendar" id="my_calendar_en6" style="display: none;">
       
       
          </div>
          <div id="navHolder" class="navigations" style="display: none; float: right;">
            <i onclick="backPage()" id="backMove" class="fa fa-caret-up" aria-hidden="true" style="margin-top: 10px; float: left; margin-left: 10px; cursor: pointer; display: none; font-size: 20px; margin-right: 10px;" title="Back"></i>
            <i onclick="nextPage()" id="nextMove" class="fa fa-caret-down" aria-hidden="true" style="margin-top: 10px; float: right; margin-right: 10px;  cursor: pointer; display: none; font-size: 20px; " title="Next page"></i>
          </div>
          
           </div>         

         </div>

    </div> 
</div>
<!-- ------------------------------ed PS myBar-->

<div id="sites_in_project"style="margin: 20px;display: none; ">
  <div class="row"style="width: 100%;">

    <!-- Content Column -->
    <div class="card" style="width: 100%; margin: 40px;background-color: #01101d46;">

<!-- ====================== -->

    <div style="display: none;" id="new_site_card">
      <div style="width: 300px; left: 10%; margin-top: 5%;position: absolute; z-index: 1003;" class="card card-primary">
      <div style="text-align: center;" class="card-header">
        <h3 style="font-size: 18px; float: left;" class="card-title">ADD NEW SITE</h3>
        <div style="float: right;">
          <i onclick="closeNewSiteCard()" style="margin-left: 10px; cursor: pointer; height: 20px; color: brown;" title="Close" class="fa fa-times" aria-hidden="true"></i>

        </div>
      </div>
    
      <!-- /.card-header start() -->
      <!-- form start -->
      <form>
        <div style="font-size: 10px;" class="card-body">
        
          <div class="form-group"style="margin-top: -10px;">
            <label for="exampleInputPassword1">Site Name</label>
            <input style="font-size: 10px; " type="" class="form-control" id="site_name"  placeholder="Type">
          </div>
          <div class="form-group"style="margin-top: -10px;">
              <label for="exampleInputPassword1">Client</label>
              <input style="font-size: 10px; " type="" class="form-control" id="s_owner"  placeholder="Type">
            </div>
            <div class="form-group"style="margin-top: -10px;">
              <label for="exampleInputPassword1">Structure</label>
              <input style="font-size: 10px; " type="text" class="form-control" id="struct" placeholder="Type">
            </div>
            <div class="form-group"style="margin-top: -10px;">
              <label for="exampleInputPassword1">Commencement Date</label>
              <input style="font-size: 10px;" type="date" class="form-control" id="c_date" placeholder="0">
            </div>
            <div class="form-group"style="margin-top: -10px;">
              <label for="exampleInputPassword1">Due Date</label>
              <input style="font-size: 10px;" type="date" class="form-control" id="d_date" placeholder="0">
            </div>
            <div class="form-group"style="margin-top: -10px;">
              <label for="exampleInputPassword1">Projected Cost</label>
              <input style="font-size: 10px;" type="text" class="form-control" id="cost" placeholder="0">
            </div>
          
            
          <div style="display: none;" class="form-group"style="margin-top: -10px;">
            <label for="exampleInputFile">File input</label>
            <div class="input-group">
              <div class="custom-file">
                <input type="file" class="custom-file-input" id="exampleInputFile">
                <label class="custom-file-label" for="exampleInputFile">Choose file</label>
              </div>
              <div class="input-group-append">
                <span class="input-group-text">Upload</span>
              </div>
            </div>
          </div>
          <div style="display: none;" class="form-check">
            <input type="checkbox" class="form-check-input" id="exampleCheck1">
            <label class="form-check-label" for="exampleCheck1">Check me out</label>
          </div>
        </div>
        <!-- /.card-body -->

        <div class="card-footer"style="margin-top: -10px;">
          <button id="btnRecordSite" type="button" onclick="recordSite()" class="btn btn-primary">Submit</button>
        </div>
      </form>
    </div>
    </div>
      <!-- ======== -->
      
        <!-- Project Card Example -->
        <div class="card shadow mb-4" style=" background-color: #01101d46;">
          <div style=" text-align: center; margin-top: 20px;color: brown; float: left;">
            
            <i onclick="openNewSiteCard()" style="cursor: pointer; color: rgb(12, 228, 48); margin-right: 10px; float: right;" title="Add new site" class="fa fa-plus" aria-hidden="true"></i>
            <h4 style="color: white;"><b> MY SITES</b></h4>
          </div>
          <div>

          </div>
            <!-- <div
            class="card-header py-3 d-flex flex-row align-items-center justify-content-between" style="background-color: #01101d46; height: 2px;">
      
        </div> -->
          
             <div class="card-body" style="height: 500px; margin: 5px; ">
               

                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar2" style="background-color: #fdfbfcf1; border-radius: 10px;">
                  <div style="width: 100%; max-height: 480px; height: 500px; "class="table-responsive">
                    <table class="table table-hover  table-striped" id="">
                       <thead style="color: rgb(11, 11, 12);font-size: 10px; background-color: white;">
                        <th >Site Name</th>
                        <th>Client</th>
                        <th>Structure</th>
                        <th>Commencement</th>
                        <th>Due Date</th>
                        <th>Labor</th>
                        <th>Material</th>
                        <th>O.Expenses</th>
                        <th>Total Cost</th>
                        <th>Budget Cost</th>
                        <th>Status</th>
                        <!-- <th>Total</th>
                        <th>Status</th> -->

                       </thead>
                       <tbody id = "tbodySVB" style="font-size: 10px; cursor: pointer; color: rgb(17, 9, 9);">

                       </tbody>

                       <!-- <div id="myProgress">
                        <div id="myBar"></div>
                      </div> -->


                     </table>
                   </div>         

                 </div>

            </div> 
        </div>

   </div>

   
</div>

</div>
<div id="sites" style="display: none;">
    <section class="inner-page" style="width: 100%; height: 1000px;">
      <div class="container">
        <div class="main-body">

            <div class="container" style="margin-left: 22px; width: 100%;height: 100%;">
                <iframe src="../Site Management/Main/dashboard.html" frameborder="0" style="width:100%; height: 800px"></iframe>
            
            </div>
        </div>
      </div>

    </section>
</div>

<div id="plotImages">
  <section id="portfolio" class="portfolio">
      <div  class="container" data-aos="fade-up">

        <!-- <div class="section-title">
          <h2>Designs</h2>
          <h3>Check out our <span>House Designs</span></h3>
          <p>We help you get a modern house design that you can actually implement on your home project</p>
        </div> -->

        <!-- <div class="row" data-aos="fade-up" data-aos-delay="100">
          <div class="col-lg-12 d-flex justify-content-center">
            <ul id="portfolio-flters">
              <li data-filter="*" class="filter-active">All</li>
              <li data-filter=".filter-app">Studio Appartment</li>
              <li data-filter=".filter-card">Bungalow</li>
              <li data-filter=".filter-web">Mansionettes</li>
            </ul>
          </div>
        </div> -->

      

      </div>
    </section>
</div>
    
  
</div>
    

  </main><!-- End #main -->

  
  

  <footer style="display: none;" id="footer" data-aos="fade-up" data-aos-easing="ease-in-out" data-aos-duration="500">

    <div class="footer-newsletter">
      <div class="container">
        <div class="row">
          <div class="col-lg-6">
            <h4>Our Newsletter</h4>
            <p>Catch the Wave of Inspiration! ðŸŒŸ Subscribe to Our Newsletter and Dive into a World of Design Excellence. Stay ahead of the curve with exclusive insights, tips, and updates delivered directly to your inbox. Don't miss out â€“ Join The Grant Ventures community today!</p>
          </div>
          <div class="col-lg-6">
            <form action="" method="post">
              <input type="email" name="email"><input type="submit" value="Subscribe">
            </form>
          </div>
        </div>
      </div>
    </div>

    
 
  </footer><!-- End Footer -->
  <!-- <div class="d-flex align-items-center justify-content-center" style="align-items: right; float: right;margin-right: 40px; margin-top: 17%;">
    <p>Powered by <span><b>NageMax Pro</b></span></p>
  </div> -->
  <div id="preloader"></div>
  <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/counterup/counterup.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script src="project_progress.js"></script>

  <script src="register.js"></script>
  <script src="server.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>
  <script src="horizontal-calendar-events-rescalendar/src/js/rescalendar.js"></script>


  

<script>
  
  var firebaseConfig = {
    apiKey: "add yours",
    authDomain: "add yours",
    databaseURL: "add yours",
    projectId: "add yours",
    storageBucket: "add yoursm",
    messagingSenderId: "add yours",
    appId: "add yours",
    measurementId: "add yours"
};
var parentDatabase = "SEAHAWK"
var projectForDesktop = getInputValue("email");
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
// var database = firebase.database().ref("Test Client");getInputValue()start()Sites Stock addCreated perBIG absolute

function showline(){
  document.getElementById("liner").style.display = "none"
}
function hideline(){
  document.getElementById("liner").style.display = "block"
}
function setMyDate(){
  var date  = getInputValue("date")
  var revwID = date.replaceAll("/","-")
  var wID = revwID.split('-').reverse().join('-')

  var fullDate = wID.split("-")
  var day = fullDate[0]
  var month = fullDate[1]
  var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")

  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")

  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  
 dateToUse = day +"-"+month+"-"+year
  // alert(wID)
}
const container = document.getElementById("container");

function makeRows(rows, cols,nam,stDate,endDate,loc,prog,typee,supl) {
  
  var projectSelected = document.getElementById("email") 
  var pin = document.getElementById("pN") 
  container.style.setProperty('--grid-rows', rows);
  container.style.setProperty('--grid-cols', cols);
  // for (c = 0; c < (rows * cols); c++) {
    
  // };
    let cell = document.createElement("div");
    let cell2 = document.createElement("div");
    let p1 = document.createElement("p")
    p1.innerText = prog
    cell.append(p1)
    cell.innerText = (nam);
    cell2.innerText = (stDate);
    cell.style.fontWeight ="bold"
    container.appendChild(cell).className = "grid-item";

    cell.addEventListener("click",()=>{
    
    projectSelected.value = nam
    pin.value = "9090"
    document.getElementById("names").style.display ="none"
    var pro = nam
    start(pro,typee,supl)
    calculateProjectPercentage(nam)
    
    var i = 0
  
    document.getElementById("myBar").style.display ="block"
   
    document.getElementById("logger").style.display ="none"
    
   })
    // container.appendChild(cell2).className = "grid-item";
};

// makeRows(5, 5);
function openMilUpdate(){
  document.getElementById('milestonesDisplay').style.display = "block"
  document.getElementById("tableMilestoneActs").style.display ="none"
  document.getElementById("tableMilestone").style.display ="block"

}
function closeOp(){
  document.getElementById("optioner2").style.display ="none"
  document.getElementById("updaterText").style.display ="block"
  document.getElementById("updaterIcon").style.display ="none"

}
function loadHistory(project){
  document.getElementById("alerter").style.display = "none"
  var database = firebase.database().ref(parentDatabase).child("Weeks").child(project).orderByChild("order").once("value",
        function(Snapshot){
          Snapshot.forEach(
            function(childSnapshort){
          var wName = childSnapshort.val().name
          var amount = childSnapshort.val().wage
          
          if(wName === undefined){
            wName = "running.."
            amount ="Ksh" + Intl.NumberFormat('en-US').format(amount)
          }
          if(amount == "Ksh NaN"){
            amount = "Ksh 0.00"
          }
           addHistToTable(wName,amount,project)

        })})
}
function addHistToTable(wName,amount,project){

    var tbody = document.getElementById("tbodyPayHist")
    var trow = document.createElement("tr");
    var td1 = document.createElement("td");
    var td2 = document.createElement("td");
    
  
    td1.innerHTML = wName;
    td2.innerHTML = amount;
    trow.appendChild(td1);
    trow.appendChild(td2);
    tbody.appendChild(trow);

   
  
 
    trow.addEventListener("click",()=>{
      
    })
   
    document.getElementById("arch").addEventListener("click",()=>{
      trow.remove()
    })
}
function addHist(wID,project,date,amount){
  var database = firebase.database().ref(parentDatabase).child("WeeksCountDown").once("value",
      function(Snapshot){

      var order = Snapshot.val().gibs


      var databaseR = firebase.database().ref(parentDatabase).child("Weeks").child(project).child(wID);
            var receivedDatabase = databaseR.update({        
            wage: amount,
            name:date,
            order:order
          }).then(
            updateOrder(order)
          )
        })
}
function updateOrder(order){
  var order = order - 1
  var databaseR = firebase.database().ref(parentDatabase).child("WeeksCountDown");
            var receivedDatabase = databaseR.update({        
            
            gibs:order
          })
}
function closeArchive(){
  document.getElementById("namesAchiver").style.display = "none"
}
function achiver(){
  
  var project = getInputValue("email");
  var date = getInputValue("date");
  var amountB = (document.getElementById("OtherTotal").innerHTML).replace("Pending Bills: Ksh ","").replaceAll(",",""); 
  var amountA = (document.getElementById("lCounter").innerHTML) 
  var amount= "Ksh "+Intl.NumberFormat('en-US').format((parseInt(biilsCount)+parseInt(amountA)))
  loadHistory(project)
  var revwID = date.replaceAll("/","-")
  var wID = revwID.split('-').reverse().join('-')

  var fullDate = wID.split("-")
  var day = fullDate[0]
  var month = fullDate[1]
  var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")

  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")

  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  
  var wID = day +"-"+month+"-"+year
  // alert(amount)//valueIn
  addHist(wID,project,date,amount)

  

}

function openPermsBig(){
  document.getElementById('perBIG').style.display = "block"
}
function closePerms(){
  document.getElementById('perBIG').style.display = "none"
}
function openCasBig(){
  document.getElementById('tempBIG').style.display = "block"
}
function closeTemps(){
  document.getElementById('tempBIG').style.display = "none"
}
function setQty(){
  document.getElementById("u_quantity").value = getInputValue("set_qty")
}
function openDaySelector1(){
      
      document.getElementById("daySelectorH3").style.display ="block"
   document.getElementById("togleOff1").style.display ="block"
   document.getElementById("togleOn1").style.display ="none"
   document.getElementById("hoValue").value = "on"
  // if (confirm("Workers will  be added to register of the selected day")) { 

   
   
   
  // } else {
    
    
  // }
}

function closeDaySelector1(){
document.getElementById("daySelectorH3").style.display ="none"
    document.getElementById("togleOff1").style.display ="none"
    document.getElementById("togleOn1").style.display ="block"
    document.getElementById("billDueDate").value =""
    document.getElementById("hoValue").value = "off"
  // if (confirm("Workers will now be added to today's register")) {
     
    
    
  // } else {
    
    
  // }
}
document.getElementById("mainProjects").addEventListener("click",()=>{
  countPages = 1
  document.getElementById("navHolder").style.display ="none"
})
var countPages = 1
function nextPage(){
  ++countPages
  if(countPages ==2){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="block"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
  }
  if(countPages ==3){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="block"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
    
  }
  if(countPages ==4){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="block"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
  }
  if(countPages ==5){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="block"
     document.getElementById("my_calendar_en6").style.display ="none"
     
  }
  if(countPages ==6){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="block"
     document.getElementById("nextMove").style.display ="none"
  }
  document.getElementById("backMove").style.display ="block"
}
function backPage(){
  --countPages
  if(countPages ==1){
    document.getElementById("backMove").style.display ="none"
    document.getElementById("my_calendar_en").style.display ="block"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
  }
  if(countPages ==2){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="block"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
  }
  if(countPages ==3){
    document.getElementById("my_calendar_en").style.display ="none"
    document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="block"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
  }
  if(countPages ==4){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="block"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="none"
     
  }
  if(countPages ==5){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="block"
     document.getElementById("my_calendar_en6").style.display ="none"
    
  }
  if(countPages ==6){
     document.getElementById("my_calendar_en").style.display ="none"
     document.getElementById("my_calendar_en2").style.display ="none"
     document.getElementById("my_calendar_en3").style.display ="none"
     document.getElementById("my_calendar_en4").style.display ="none"
     document.getElementById("my_calendar_en5").style.display ="none"
     document.getElementById("my_calendar_en6").style.display ="block"
     
  }
  document.getElementById("nextMove").style.display ="block" 
  
}
var countFields = 1
function openField(){
  ++countFields
  if(countFields > 4){
    countFields = 4
  }
  if(countFields ==2){
    document.getElementById('act2').style.display = "block"
    document.getElementById('closeM').style.display = "block"
  }
  if(countFields ==3){
    document.getElementById('act3').style.display = "block"
  }
  if(countFields ==4){
    document.getElementById('act4').style.display = "block"
    document.getElementById('openM').style.display = "none"
  }
  document.getElementById("kpiCount").innerHTML = countFields
  
}
function closeField(){
  --countFields
  if(countFields < 1){
    countFields = 1
  }
  if(countFields ==3){
    
    document.getElementById('act4').style.display = "none"
    document.getElementById('act4').value = ""
    document.getElementById('openM').style.display = "block"
  }
  if(countFields ==2){
    
    document.getElementById('act3').style.display = "none"
    document.getElementById('act3').value = ""
  }
  if(countFields ==1){
    document.getElementById('act2').value = ""
    document.getElementById('act2').style.display = "none"
    document.getElementById('closeM').style.display = "none"
  }
  document.getElementById("kpiCount").innerHTML = countFields
  
}
var typeArray = []
var countArray =[]
function showGrapghStaff() {
    /* ChartJS
     * -------
     * Here we will create a few charts using ChartJS ALL SUPPLIES.
     */

    //--------------
    //- AREA CHART -
    //--------------

    // Get context with jQuery - using jQuery's .get() method.
    // var areaChartCanvas = $('#areaChart').get(0).getContext('2d')

    var areaChartData = {
      labels  : typeArray,
      datasets: [
        {
          label               : 'Performance Index',
          backgroundColor     : 'rgba(60,141,188,0.9)',
          borderColor         : 'rgba(60,141,188,0.8)',
          pointRadius          : false,
          pointColor          : '#3b8bba',
          pointStrokeColor    : 'rgba(60,141,188,1)',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(60,141,188,1)',
          data                : countArray
        }
      
      ]
    }

    var areaChartOptions = {
      maintainAspectRatio : false,
      responsive : true,
      legend: {
        display: true
      },
      scales: {
        xAxes: [{
          gridLines : {
            display : false,
          }
        }],
        yAxes: [{
          gridLines : {
            display : false,
          }
        }]
      }
    }

    // This will get the first returned node in the jQuery collection.
    // new Chart(areaChartCanvas, {
    //   type: 'line',
    //   data: areaChartData,
    //   options: areaChartOptions
    // })

    //-------------
    //- LINE CHART -
    //--------------
    // var lineChartCanvas = $('#lineChart').get(0).getContext('2d')
    // var lineChartOptions = $.extend(true, {}, areaChartOptions)
    // var lineChartData = $.extend(true, {}, areaChartData)
    // lineChartData.datasets[0].fill = false;
    // lineChartData.datasets[1].fill = false;
    // lineChartOptions.datasetFill = false

    // var lineChart = new Chart(lineChartCanvas, {
    //   type: 'line',
    //   data: lineChartData,
    //   options: lineChartOptions
    // })

  

    

    //-------------
    //- BAR CHART -
    //-------------
    var barChartCanvas = $('#barChartStaff').get(0).getContext('2d')
    var barChartData = $.extend(true, {}, areaChartData)
    var temp0 = areaChartData.datasets[0]
    // var temp1 = areaChartData.datasets[1]
    barChartData.datasets[0] = temp0
    // barChartData.datasets[1] = temp0

    var barChartOptions = {
      responsive              : true,
      maintainAspectRatio     : false,
      datasetFill             : false
    }

    new Chart(barChartCanvas, {
      type: 'bar',
      data: barChartData,
      options: barChartOptions
    })

  
  }

function openNewScheduleField(){
  document.getElementById('namesScheduler').style.display = "block"
}
function closeScheduler(){
  document.getElementById('namesScheduler').style.display = "none"
  document.getElementById('milestonesDisplay').style.display = "none"
}
function cancelAction(){
  countFields = 1
  document.getElementById('openM').style.display = "block"
  document.getElementById('closeM').style.display = "none"
  document.getElementById('namesScheduler').style.display = "none"
  document.getElementById("n_name").value = ""
  document.getElementById("act").value = ""
  document.getElementById("dateOne").value = ""
  document.getElementById("dateTwo").value = ""
  document.getElementById('act2').style.display = "none"
  document.getElementById('act3').style.display = "none"
  document.getElementById('act4').style.display = "none"
  document.getElementById('act1').value = ""
  document.getElementById('act2').value = ""
  document.getElementById('act3').value = ""
  document.getElementById('act4').value = ""
  document.getElementById("kpiCount").innerHTML = countFields
}
function getMileCount(){
  
 
  if(act1 !=="" &act2 !=="" &act3 !=="" &act4 !==""){

  }
  if(countFields ==1){
    if(act1 !==""){

    }
  }
}
function sumbitSchedule(){
  innerCount = 1
  var act1 =      getInputValue("act1")
  var act2 =      getInputValue("act2")
  var act3 =      getInputValue("act3")
  var act4 =      getInputValue("act4")

  var act_name =getInputValue("n_name")
  var de =      getInputValue("act")
  var begDate = getInputValue("dateOne")
  var finDate = getInputValue("dateTwo")
  var color = getInputValue("selectedColor")
  if(act_name !=="" &de !=="" &begDate !=="" &finDate !==""&color !==""&act1 !==""){
  


      var begDate =  begDate.replaceAll("/","-")
      var finDate = finDate.replaceAll("/","-")
      var act_name = act_name.replaceAll(" ","_")
      var project_name = getInputValue("email")
      
      var database = firebase.database().ref(parentDatabase).child("Master Schedule").child(project_name).child("Counter").once("value",
        function(Snapshot){
          if(Snapshot.exists()){
             var counter =parseInt(Snapshot.val().current_count) +1
          }
          else{
            var counter = "1"
          }
           
   
            var billsDatabase = firebase.database().ref(parentDatabase).child("Master Schedule").child(project_name).child("Record").child(counter);
            var receivedDatabase = billsDatabase.update({  

              name:counter+"."+act_name,
              description:de,
              date1:begDate,
              date2:finDate,
              percentage:"0",
              number:counter,
              color:color
          
              

              }).then(
                  
                  setNewCount(counter,project_name,act1,act2,act3,act4)

              );

         });     
      }
      else{
        alert("Please fill all fields")
      }
}
function setNewCount(counter,project_name,act1,act2,act3,act4){
  var billsDatabase = firebase.database().ref(parentDatabase).child("Master Schedule").child(project_name).child("Counter");
            var receivedDatabase = billsDatabase.update({  

              current_count:counter
          
              

              }).then(
                // recordActCount(project_name,act1,counter),save
                recordActivities(project_name,act1,counter)
              );
}
function recordActCount(project_name,act1,counter){
  var billsDatabase = firebase.database().ref(parentDatabase).child("Master Schedule").child(project_name).child("Activities Counter").child(counter);
      var receivedDatabase = billsDatabase.update({  

        count:countFields,
        number:counter,


    }).then(
      recordActivities(project_name,act1,counter)
    )
}
function recordActivities(project_name,act1,counter){
  var billsDatabase = firebase.database().ref(parentDatabase).child("Master Schedule").child(project_name).child("Activities").child(counter).child(act1);
      var receivedDatabase = billsDatabase.update({  

        name:act1,
        status:"Pending",
        percentage:"0",
        number:counter,
        groupCount:countFields
     
    
        

    }).then(
      ++innerCount,
      loop(project_name,counter)
      
    )
}

function loop(project_name,counter){
 
  if(countFields >= innerCount){
    if(innerCount ==2){
      var act1 = getInputValue("act2")
      recordActivities(project_name,act1,counter)
    }
    if(innerCount ==3){
      var act1 = getInputValue("act3")
      recordActivities(project_name,act1,counter)
    }
    if(innerCount ==4){
      var act1 = getInputValue("act4")
      recordActivities(project_name,act1,counter)
    }
  }
  else{
    countFields = 1
    alert("New schedule added successfully")
    document.getElementById("n_name").value = ""
    document.getElementById("act").value = ""
    document.getElementById("dateOne").value = ""
    document.getElementById("dateTwo").value = ""
    document.getElementById('act1').value = ""
    document.getElementById('act2').value = ""
    document.getElementById('act3').value = ""
    document.getElementById('act4').value = ""
    document.getElementById('act2').style.display = "none"
    document.getElementById('act3').style.display = "none"
    document.getElementById('act4').style.display = "none"
    document.getElementById('closeM').style.display = "none"
    document.getElementById('openM').style.display = "block"
    document.getElementById("kpiCount").innerHTML = countFields
  }
  
}
var innerCount = 1
function cancelMode(){
    document.getElementById('week_per').style.display = "none"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('namesPaymentMode').style.display = "none"
    document.getElementById('modeOpenner').style.display = "block"
    document.getElementById('modeCloser').style.display = "none"
    document.getElementById('week_per_val').value =""
    document.getElementById('prev_per_val').value =""
    document.getElementById('selectedMode').value =""
    document.getElementById('btnNext').style.display = "inline-flex"
    document.getElementById('btnSet').style.display = "none"

}
function set(){
  valueIn = 0
  var pp = getInputValue('prev_per_val')
  var wp = getInputValue('week_per_val')
  if(pp ===""){
    pp = "0"
  }
  if(wp ===""){
    wp = "0"
  }
  if(pp > 100){
    alert("Maximum percentage is 100%")
  }
  else{
    if(wp > 100){
        alert("Maximum percentage is 100%")
      }
      else{
          var md = getInputValue("selectedMode")
          if(md ===""){

            document.getElementById('mode_value').value =""
          }
          if(md ==="1"){
          
            document.getElementById('mode_value').value ="Full previous & full  week's totals"
          
          }
          if(md ==="2"){

          document.getElementById('mode_value').value ="Only previous balances"
          document.getElementById('mode_value').value ="Only previous balances"
          }
          if(md ==="3"){
            
            document.getElementById('mode_value').value ="Only this week's totals"
          }
          if(md ==="4"){

          document.getElementById('mode_value').value =wp+"% of this week's total"
          }
          if(md ==="5"){
        
          document.getElementById('mode_value').value =pp+"% of previous balances"
          }
          if(md ==="6"){
          
            document.getElementById('mode_value').value ="Full previous & "+ wp+"% of week's total"
          }
          if(md ==="7"){
        
            document.getElementById('mode_value').value =pp+"% of previous & full week's total"
          }
          if(md ==="8"){

            document.getElementById('mode_value').value =pp+"% of previous & "+wp+"% of week's total"
          }
          if(md ==="9"){

          document.getElementById('mode_value').value ="NILL"
          }
          var mode_value = getInputValue('mode_value')
          var datePayer = getInputValue("date")
          var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
                function(Snapshot){
                    
                    
                     if(dateToUse ==""){
                      var date = Snapshot.val().current_week
                      }else{
                        var date = dateToUse
                      }
                    if (confirm("Setting payment mode for the week of "+date+" to ("+mode_value+ ")?")) {

                      document.getElementById('btnNext').style.display = "inline-flex"
                      document.getElementById('btnSet').style.display = "none"
                      document.getElementById('namesPaymentMode').style.display = "none"
                      document.getElementById('modeOpenner').style.display = "block"
                      document.getElementById('modeCloser').style.display = "none"
                        // var date = "2-6-2024" //MOLO 1

                       
                        startSetting(date,datePayer)
                    
                    } 
                    else {
                    
                  
                    }
                });


      }
  }
  



}
var dateToUse = ""
function next(){
  var pp = getInputValue("prev_per_val")
  
  var md = getInputValue("selectedMode")
  if(md ===""){
    document.getElementById('week_per').style.display = "none"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('mode_value').value =""
  }
  if(md ==="1"){
    document.getElementById('week_per').style.display = "none"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"
  
  
  }
  if(md ==="2"){
    document.getElementById('week_per').style.display = "none"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"

  }
  if(md ==="3"){
    document.getElementById('week_per').style.display = "none"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
    document.getElementById('btnSet').style.display = "inline-flex"
    document.getElementById('mode_value').value ="Only this week's totals"
  }
  if(md ==="4"){
    var pp = getInputValue("prev_per_val")
    var wp = getInputValue('week_per_val')
    document.getElementById('week_per').style.display = "block"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"
  document.getElementById('mode_value').value =wp+"% of this week's total"
  }
  if(md ==="5"){
    var pp = getInputValue("prev_per_val")
    var wp = getInputValue('week_per_val')
    document.getElementById('prev_per').style.display = "block"
    document.getElementById('week_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"
  document.getElementById('mode_value').value =pp+"% of previous balances"
  }
  if(md ==="6"){
    var pp = getInputValue("prev_per_val")
    var wp = getInputValue('week_per_val')
    document.getElementById('week_per').style.display = "block"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"
  document.getElementById('mode_value').value ="Full previous & "+ wp+"% of week's total"
  }
  if(md ==="7"){
    var pp = getInputValue("prev_per_val")
    var wp = getInputValue('week_per_val')
    document.getElementById('prev_per').style.display = "block"
    document.getElementById('week_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"
  document.getElementById('mode_value').value =pp+"% of previous & full week's total"
  }
  if(md ==="8"){
    var pp = getInputValue("prev_per_val")
    var wp = getInputValue('week_per_val')
    document.getElementById('prev_per').style.display = "block"
    document.getElementById('week_per').style.display = "block"
    document.getElementById('btnNext').style.display = "none"
  document.getElementById('btnSet').style.display = "inline-flex"
  document.getElementById('mode_value').value =pp+"% of previous & "+wp+"% of week's total"
  }
  if(md ==="9"){
    document.getElementById('mode_value').value = "Nill"
    document.getElementById('prev_per').style.display = "none"
    document.getElementById('week_per').style.display = "none"
    document.getElementById('btnNext').style.display = "none"
    document.getElementById('btnSet').style.display = "inline-flex"
  
  }
}


function openPmode(){
  document.getElementById('namesPaymentMode').style.display = "block"
  document.getElementById('modeOpenner').style.display = "none"
  document.getElementById('modeCloser').style.display = "block"
}
function closePmode(){
  closeArchive()
  document.getElementById('namesPaymentMode').style.display = "none"
  document.getElementById('modeCloser').style.display = "none"
  document.getElementById('modeOpenner').style.display = "block"
}

const cursorVT = document.querySelector('.vt')
const cursorHL = document.querySelector('.hl')

document.addEventListener('mousemove', e => {
  cursorVT.setAttribute('style', `left: ${e.clientX}px;`)
  cursorHL.setAttribute('style', `top: ${e.clientY}px;`)
})

// --project progress js---

// -------end----------

function finder(){
  const d = new Date();

}


    function closeUsager(){
      document.getElementById("rUsage").style.display ="none"
      document.getElementById("u_item").disabled = "false"
      document.getElementById   ("u_item").value =""
      document.getElementById("unit").value =""
        document.getElementById  ("u_quantity").value =""
    
      document.getElementById  ("picker").value =""
    
    document.getElementById("w_site").value =""
    }
    function loadUsageSites(){
        // alert(nam)
       
        var projectForDesktop = getInputValue("email");
        var database = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).once("value",
        function(Snapshot){
            Snapshot.forEach(
            function(childSnapshort){
                
                var nam = childSnapshort.val().siteName
    
                addUsageSitesToTable(nam)
            }
            )
       
    
      });
    
    }
    function addUsageSitesToTable(nam){
     
    var projectSelected = document.getElementById("w_site") 
    
    var tbody = document.getElementById("sitesTbody");
    var trow = document.createElement("tr");
    var td1 = document.createElement("td");
    var td2 = document.createElement("td");
    td2.style.marginLeft ="10px"
    
    td1.innerHTML = count++;
    td2.innerHTML = nam;
    // trow.appendChild(td1);
    trow.appendChild(td2);
    tbody.appendChild(trow);
    //  trow.remove();
   

    document.getElementById("namesSites").style.display ="block"
    document.getElementById("w_site").addEventListener("click",()=>{
        trow.remove();
        
       
      })
   
    trow.addEventListener("click",()=>{
      
      projectSelected.value = nam
      document.getElementById("namesSites").style.display ="none"
      
    
      
     })
    }
  
function recordUsage(){
    var u_item = getInputValue   ("u_item")
    var unit = getInputValue("unit")
    var u_quantity = getInputValue  ("u_quantity")
  
    var picker = getInputValue  ("picker")
   
    var b_desc = getInputValue("w_site")
    var project_name = getInputValue("email")

    if(project_name !==""&&b_desc !==""&&u_item !==""&&u_quantity !==""&&picker !==""&&unit !==""){
      document.getElementById("loaderU").style.display = "block"
          document.getElementById("okSpanU").style.display = "none"
          document.getElementById("btnRecordUsage").disabled = true
            
            var b_d_date = "day +"-"+month+"-"+year"


            var currentdate = new Date(); 
                var id =currentdate.getFullYear() 
                    
                        + (currentdate.getMonth()+1) 
                        + ("0"+currentdate.getDate()).slice(-2)  
                        + ("0"+currentdate.getHours()).slice(-2) 
                        + ("0"+currentdate.getMinutes()).slice(-2) 
                        + ("0"+currentdate.getSeconds()).slice(-2);
                        
                var date = ("0"+currentdate.getDate()).slice(-2) + "-"
                        + (currentdate.getMonth()+1)  + "-" 
                        + currentdate.getFullYear()
                var month = (currentdate.getMonth()+1)
                var year = currentdate.getFullYear() 

                var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
                function(Snapshot){
                    var c_week = Snapshot.val().current_week
        
                    // alert(date)projectNames
                    checkAvailability(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit)
                   
                });

    }
    else{
        alert("Fill all fields")
    }
  

}
function checkAvailability(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit){
  var database = firebase.database().ref(parentDatabase).child("Sites Stock").child(project_name).child(u_item).once("value",
        function(Snapshot){
       
            var rawqty = Snapshot.val().quantity

            var y = parseInt(u_quantity)
            var x = parseInt(rawqty)

            if(x>=y){
              getOrder(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit)
            }
            else{
              alert("Available "+u_item+" is less than specified quantity.")
              document.getElementById("rUsage").style.display ="none"
              document.getElementById("u_item").disabled = "false"
              document.getElementById("loaderU").style.display = "none"
              document.getElementById("okSpanU").style.display = "block"
              document.getElementById("btnRecordUsage").disabled = false
            }
        })

}
function getWeek(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit,order){

var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
  function(Snapshot){
      var week = Snapshot.val().current_week
    
        uploadDataU(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit,order,week)
       });
       
}

function uploadDataU(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit,order,week){
  var projectForDesktop = getInputValue("email")
  
  var billsDatabase = firebase.database().ref(parentDatabase).child("Web Usages").child(project_name).child("Records").child(id);
  var receivedDatabase = billsDatabase.update({  


    collector:picker,
    date:date,
    week:week,
    order:order,
    item:u_item,
    unit:unit,
    week:c_week,
    quantity:u_quantity,
    site_to:b_desc,
    


    }).then(
        updateOrderU(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,week)
        

    );

}
function getOrder(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit){
    var database = firebase.database().ref(parentDatabase).child("WeeksCountDown").once("value",
        function(Snapshot){
          
            
            var order = (parseInt(Snapshot.val().gibs)-1).toString()
          
            getWeek(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,unit,order)
        });
}
function updateOrderU(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,week){

    var databaseR  = firebase.database().ref(parentDatabase).child("WeeksCountDown");
        var receivedDatabase = databaseR.update({

        gibs: order,
        
        }).then(
          

          updateStockU(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,week)
          );
}
function updateStockU(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,week){
    var database = firebase.database().ref(parentDatabase).child("Sites Stock").child(project_name).child(u_item).once("value",
        function(Snapshot){
          if(Snapshot.exists()){
            var rawqty = Snapshot.val().quantity

            var qty = (parseInt(rawqty)-parseInt(u_quantity)).toString()
          }
          else{
            var qty = i_qty
          }
      

            
            var databaseR = firebase.database().ref(parentDatabase).child("Sites Stock").child(project_name).child(u_item);
            var receivedDatabase = databaseR.update({

            
            quantity:qty,
           
            

            }).then(
            
            updateSiteCost(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,week)
            
            );

          
         
         

        });
}
function updateSiteCost(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,week){
  var u_price = getInputValue   ("u_price")
  var cost = parseInt(u_price)*parseInt(u_quantity)
// alert(cost)
  var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(project_name).child(b_desc).child("Materials Used").child(u_item).once("value",
        function(Snapshot){
                
            if(Snapshot.exists()){

              var currentCost = Snapshot.val().wage
              var currentQuantity = Snapshot.val().quantity 

              var newCostNow = (parseInt(cost)+ parseInt(currentCost)).toString()
              var newQuanity = (parseInt(u_quantity)+ parseInt(currentQuantity)).toString()
            }
            else{
               
              var newCostNow = cost
              var newQuanity = u_quantity
              
            }
           
            
                var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(project_name).child(b_desc).child("Materials Used").child(u_item);
                  var receivedDatabase = databaseR.update({        
                  
                  item: u_item,
                  week:week,
                  unit:unit,
                  quantity:newQuanity,
                  
                  wage:newCostNow

                  }).then(
                      
                  updateSiteMaterialCost(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,u_price,cost)
                      
                  );
              
          
          })
     
}
function updateSiteMaterialCost(project_name,b_desc,u_item,u_quantity,picker,date,c_week,id,order,unit,u_price,cost){

  var database = firebase.database().ref(parentDatabase).child("Constructions").child(project_name).child(b_desc).child("Materials Cost").once("value",
        function(Snapshot){
            var newS = Snapshot.val().wage
            // alert(newS)
          
            var newCost = (parseInt(newS)+parseInt(cost)).toFixed(0).toString()

           
          
                    var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(project_name).child(b_desc).child("Materials Cost");
                    var receivedDatabase = databaseR.update({
                    

                    wage:newCost,
                    

                    }).then(
                       alert("Usage recorded successfully"),
                      document.getElementById("rUsage").style.display ="none",
                      document.getElementById("u_item").disabled = "false",

                      document.getElementById   ("u_item").value ="",
                      document.getElementById("unit").value ="",
                      document.getElementById  ("u_quantity").value ="",
                      
                      document.getElementById  ("picker").value ="",
                      
                      document.getElementById("w_site").value ="",
                      document.getElementById("loaderU").style.display = "none",
                      document.getElementById("okSpanU").style.display = "block",
                      document.getElementById("btnRecordUsage").disabled = false
                        
                     );

          
            
         
        });
   
}
function closeEditor(){
  // document.getElementById("editName").value  =""
  // document.getElementById("editSubL").value  =""
  // document.getElementById("editPhone").value =""
  // document.getElementById("editSite").value  =""
  // document.getElementById("editDesig").value =""
  // document.getElementById("editWage").value  =""
  // document.getElementById("editID").value  =""
  // document.getElementById("editTyp").value =""
  // document.getElementById("editPro").value  =""
  document.getElementById("editDetais").style.display ="none"
}
function closeEditor2(){
  // document.getElementById("editNameIn").value  =""
  // document.getElementById("editSubLIn").value  =""
  // document.getElementById("editPhoneIn").value =""
  // document.getElementById("editSiteIn").value  =""
  // document.getElementById("editDesigIn").value =""
  // document.getElementById("editWageIn").value  =""
  // document.getElementById("editIDIn").value  =""
  // document.getElementById("editTypIn").value =""
  // document.getElementById("editProIn").value  =""
  document.getElementById("editDetais2").style.display ="none"
}
function editWorkersIn(){
  var editName  = getInputValue("editNameIn")
  var editSubL  = getInputValue("editSubLIn")
  var editPhone = getInputValue("editPhoneIn")
  var editSite  = getInputValue("editSiteIn")
  var editDesig = getInputValue("editDesigIn") 
  var editWage  = getInputValue("editWageIn")
  var Id  = getInputValue("editIDIn")
  var Type  = getInputValue   ("editTypIn")
  var Project   = getInputValue("email");
  var projectForDesktop =Project
//  alert(Id)
   var databaseR = firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(Project).child("14-3-2022").child(Id);
    var receivedDatabase = databaseR.update({
    

      designation: editDesig,
      location:editSubL,
      name:editName,
      phone:editPhone,
      site:editSite,
      wage:editWage,
      

    }).then(
      alert("Details updated successfully"),
      // getEnquiries(parentDatabase,projectForDesktop),

      // document.getElementById("editNameIn").value  ="",
      // document.getElementById("editSubLIn").value  ="",
      // document.getElementById("editPhoneIn").value ="",
      // document.getElementById("editSiteIn").value  ="",
      // document.getElementById("editDesigIn").value ="",
      // document.getElementById("editWageIn").value  ="",
      // document.getElementById("editIDIn").value  ="",
      // document.getElementById("editTypIn").value ="",
      // document.getElementById("editProIn").value  ="",
      document.getElementById("editDetais2").style.display ="none"

    );
}
function editWorkers(){  
  var editName  = getInputValue("editName")
  var editSubL  = getInputValue("editSubL")
  var editPhone = getInputValue("editPhone")
  var editSite  = getInputValue("editSite")
  var editDesig = getInputValue("editDesig") 
  var editWage  = getInputValue("editWage")
  var Id  = getInputValue     ("editID")
  var Type  = getInputValue   ("editTyp")
  var Project   = getInputValue("email");
  var projectForDesktop =Project
   var databaseR = firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(Project).child("14-3-2022").child(Id);
    var receivedDatabase = databaseR.update({
    

      designation: editDesig,
      location:editSubL,
      name:editName,
      phone:editPhone,
      site:editSite,
      wage:editWage,
      

    }).then(
      alert("Details updated successfully"),
    
      // getEnquiries(parentDatabase,projectForDesktop),

      // document.getElementById("editName").value  ="",
      // document.getElementById("editSubL").value  ="",
      // document.getElementById("editPhone").value ="",
      // document.getElementById("editSite").value  ="",
      // document.getElementById("editDesig").value ="",
      // document.getElementById("editWage").value  ="",
      // document.getElementById("editID").value  ="",
      // document.getElementById("editTyp").value ="",
      // document.getElementById("editPro").value  ="",
      document.getElementById("editDetais").style.display ="none"

    );

}
var i = 0;
function move2(i) {
  if (i == 0) {
    i = 1;
    var elem = document.getElementById("myBar");
    var width = 1;
    var id = setInterval(frame, 100);
    function frame() {
      if (width >= 100) {
        clearInterval(id);
        i = 0;
        elem.style.display ="none"
      } else {
        width++;
        elem.style.width = width + "%";
      }
    }
  }
}
function saveVData() {
  window.jsPDF = window.jspdf.jsPDF;
    var pdf = new jsPDF('l', 'pt', 'A4');

    // pdf.cellInitialize();
    pdf.setFontSize(10);
    $.each( $('#tablePayments tr'), function (i, row){
        $.each( $(row).find("td, th"), function(j, cell){
            var txt = $(cell).text().trim() || " ";
            var width = (j==4) ? 40 : 70; //make 4th column smaller
          
            
            pdf.cell(10, 50, width, 20, txt, i);
        });
    });

    pdf.save('sample-file.pdf');
}

// ---------------------------------------------------------
function showOverTime(){
  document.getElementById("overtimeWrapper").style.display = "block"
}
function openNewSiteCard(){
  document.getElementById("new_site_card").style.display = "block"
}
function closeNewSiteCard(){
  document.getElementById("new_site_card").style.display = "none"
  document.getElementById("site_name").value = ""
  document.getElementById("s_owner").value = ""
  document.getElementById("struct").value = ""
  document.getElementById("c_date").value = ""
  document.getElementById("d_date").value = ""
  document.getElementById("cost").value = ""
}
function recordSite(){
      var name =      getInputValue("site_name")
      var owner     = getInputValue("s_owner")
      var structure = getInputValue("struct")
      var c_date =    getInputValue("c_date")
      var d_date =    getInputValue("d_date")
      var cost=       getInputValue("cost")

      if(name !==""&&owner!==""&&structure!==""&&c_date!==""&&d_date!==""&&cost!==""){
        var projectForDesktop = getInputValue("email")
        var billsDatabase = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(name);
        var receivedDatabase = billsDatabase.update({  


          siteName:name,
          siteOwner:owner,
          structure:structure,
          commencementDate:c_date,
          completionDate:d_date,
          project:projectForDesktop,
          projectCost:cost,
          status:"Ongoing"


          }).then(
            addLabor(parentDatabase,projectForDesktop)

          );
      }
      else{
        alert("Please fill add fields")
      }

}
function addLabor(parentDatabase,projectForDesktop){
  var name =      getInputValue("site_name")
  var billsDatabase = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(name).child("Labor Cost");
        var receivedDatabase = billsDatabase.update({  

          
         
          wage:"0"


          }).then(
            addMaterialCost(parentDatabase,projectForDesktop)

          );
}
function addMaterialCost(parentDatabase,projectForDesktop){
  var name =      getInputValue("site_name")
  var billsDatabase = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(name).child("Materials Cost");
        var receivedDatabase = billsDatabase.update({  

          
         
          wage:"0"


          }).then(
            addOtherEx(parentDatabase,projectForDesktop)

          );
}
function addOtherEx(parentDatabase,projectForDesktop){
  var name =      getInputValue("site_name")
  var billsDatabase = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(name).child("Other Expenses");
        var receivedDatabase = billsDatabase.update({  

          
         
          wage:"0"


          }).then(
            // var supl = "0"
            getPSVB(parentDatabase,projectForDesktop,"0","single"),
              
              alert("Site created successfully")

          );
}
function closeHolder(){
  document.getElementById("overtimeWrapper").style.display = "none"
  document.getElementById("ovTime").value =""
  document.getElementById("sign").value =""
}
function setWeekDate(){
      var currentdate = new Date(); 
      var date = currentdate.getDate()+ "-"
                + (currentdate.getMonth()+1)  + "-" 
                + currentdate.getFullYear()

        const weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

        const d = new Date();
        let day = weekday[d.getDay()];  

      
      
        
        if(day === "Sunday"){
          var database = firebase.database().ref(parentDatabase).child("Weeks")
          var receivedDatabase = database.update({
                    

            current_week: date
                   
                    

                    })
          

        }
        else{
          // correct()
        }
       

    }
     
function correct(){

  firebase.database().ref("SEAHAWK").child("Staffs").child("Casual").child("BUSIA CAIP").child("Weekly Data").child("15-1-2024").once("value",
  function(cTasks){
    cTasks.forEach(
      function(childRecord){

          var Date = childRecord.val().date;
          var desig = childRecord.val().designation;
          var Id = childRecord.val().id;
          var locations = childRecord.val().location;
          var Name = childRecord.val().name;
          var Phone = childRecord.val().phone;
          var Project = childRecord.val().project;
          var Site = childRecord.val().site;
          var Type = childRecord.val().type;
          var Wage = childRecord.val().wage;
          var WorkID = childRecord.val().workID;

          upDateWorkers(locations,desig,Id,Name,Phone,Project,Site,Type,Wage);
      })
  
});

}
function  upDateWorkers(locations,desig,Id,Name,Phone,Project,Site,Type,Wage){
  var databaseR = firebase.database().ref("SEAHAWK").child("Staffs").child(Type).child(Project).child("14-3-2022").child(Id);
    var receivedDatabase = databaseR.update({
    

      designation: desig,
      location:locations,
      name:Name,
      phone:Phone,
      site:Site,
      wage:Wage,
      

    })
}
function chooseSite(){
        // alert(nam)
        var projectForDesktop = getInputValue("email");
        var database = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).once("value",
        function(Snapshot){
            Snapshot.forEach(
            function(childSnapshort){
                
                var nam = childSnapshort.val().siteName
    
                addItemToTeble(nam)
            }
            )
       
    
      });
    
    }
function addItemToTeble(nam){
        
    var projectSelected = document.getElementById("billDesc") 
    
    var tbody = document.getElementById("itemsTable");
    var trow = document.createElement("tr");
    var td1 = document.createElement("td");
    var td2 = document.createElement("td");
    td2.style.marginLeft ="10px"
    
    td1.innerHTML = count++;
    td2.innerHTML = nam;
    // trow.appendChild(td1);
    trow.appendChild(td2);
    tbody.appendChild(trow);
    //  trow.remove();
    document.getElementById("mainProjects").addEventListener("click",()=>{
    trow.remove()
    })
   
    document.getElementById("names4").style.display ="block"
   
    document.getElementById("billDesc").addEventListener("click",()=>{
        trow.remove();
        
        
      })
    
    trow.addEventListener("click",()=>{
      
      projectSelected.value = nam
      document.getElementById("names4").style.display ="none"
      
    
      
     })
    }

// --------------------------------------------------------
function recordBill(){
  var payee = getInputValue   ("payee")
  var b_item = getInputValue  ("billItem")
  var b_desc = getInputValue  ("billDesc")
  var state = getInputValue  ("hoValue")
  var b_amnt = getInputValue  ("billAmount")
  var b_d_dater = getInputValue("billDueDate")

    var revwID = b_d_dater.replaceAll("/","-")
    var wID = revwID.split('-').reverse().join('-')

    var fullDate = wID.split("-")
    var day = fullDate[0]
    var month = fullDate[1]
    var year = fullDate[2]

    if(state =="on"){
        if(payee !==""&&b_desc !==""&&b_d_dater !==""&&b_amnt !==""&&b_item !==""){
          document.getElementById("loaderSpan").style.display = "block"
          document.getElementById("mainSpan").style.display = "none"
          document.getElementById("btnRecordBill").disabled = true
          var revwID = b_d_dater.replaceAll("/","-")
              var wID = revwID.split('-').reverse().join('-')

              var fullDate = wID.split("-")
              var day = fullDate[0]
              var month = fullDate[1]
              var year = fullDate[2]

              if(day.charAt(0) === "0"){
              var day = day.replaceAll("0","")
              
              }
              if(month.charAt(0) === "0"){
              var month = month.replaceAll("0","")
              
              }
              if(year.charAt(0) === "0"){
              var year = year.replaceAll("0","")

              }
              
              var b_d_date = day +"-"+month+"-"+year


              var currentdate = new Date(); 
                  var id =currentdate.getFullYear() 
                      
                          + (currentdate.getMonth()+1) 
                          + ("0"+currentdate.getDate()).slice(-2)  
                          + ("0"+currentdate.getHours()).slice(-2) 
                          + ("0"+currentdate.getMinutes()).slice(-2) 
                          + ("0"+currentdate.getSeconds()).slice(-2);
                          
                  var date = ("0"+currentdate.getDate()).slice(-2) + "-"
                          + (currentdate.getMonth()+1)  + "-" 
                          + currentdate.getFullYear()
                  var month = (currentdate.getMonth()+1)
                  var year = currentdate.getFullYear() 

                  var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
                  function(Snapshot){
                      var c_week = Snapshot.val().current_week
          
                      // alert(date)
                      var status = "Pending"
                      uploadData(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,status)
                  });

      }
      else{
          alert("Fill all fields")
      }
    }

    else{
      if(b_desc !==""&&b_amnt !==""&&b_item !==""&&payee !==""){
        document.getElementById("loaderSpan").style.display = "block"
          document.getElementById("mainSpan").style.display = "none"
          document.getElementById("btnRecordBill").disabled = true
          // var revwID = b_d_dater.replaceAll("/","-")
          //     var wID = revwID.split('-').reverse().join('-')

          //     var fullDate = wID.split("-")
          //     var day = fullDate[0]
          //     var month = fullDate[1]
          //     var year = fullDate[2]

          //     if(day.charAt(0) === "0"){
          //     var day = day.replaceAll("0","")
              
          //     }
          //     if(month.charAt(0) === "0"){
          //     var month = month.replaceAll("0","")
              
          //     }
          //     if(year.charAt(0) === "0"){
          //     var year = year.replaceAll("0","")

          //     }
              
              var b_d_date =""

              
              var currentdate = new Date(); 
                  var id =currentdate.getFullYear() 
                      
                          + (currentdate.getMonth()+1) 
                          + ("0"+currentdate.getDate()).slice(-2)  
                          + ("0"+currentdate.getHours()).slice(-2) 
                          + ("0"+currentdate.getMinutes()).slice(-2) 
                          + ("0"+currentdate.getSeconds()).slice(-2);
                          
                  var date = ("0"+currentdate.getDate()).slice(-2) + "-"
                          + (currentdate.getMonth()+1)  + "-" 
                          + currentdate.getFullYear()
                  var month = (currentdate.getMonth()+1)
                  var year = currentdate.getFullYear() 

                  var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
                  function(Snapshot){
                      var c_week = Snapshot.val().current_week
          
                      // alert(date)
                      var status = "Paid"
                      uploadData(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,status)
                  });

      }
      else{
          alert("Fill all fields")
      }
    }
  

}

function uploadData(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,status){
  var projectForDesktop = getInputValue("email")
  var billsDatabase = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child("Data").child(id);
  var receivedDatabase = billsDatabase.update({  


    payee:payee,
    item:b_item,
    desc:b_desc,
    amount:b_amnt,
    due:b_d_date,
    date:date,
    week:c_week,
    bill_id:id,
    status:status


    }).then(
        
        updateBillsAccount(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id)

    );

}
function updateBillsAccount(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id){
  var projectForDesktop = getInputValue("email")

  firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(c_week).once("value",
  function(cTasks){

      if(cTasks.exists()){
         
          var amountOther = cTasks.val().gibs;
          var toCost = parseInt(b_amnt) + parseInt(amountOther)
          


      }
      else{
          var toCost = parseInt(b_amnt) + parseInt("0")
         
      }
      var wID = c_week 
      // getInputValue("date") only pending
      var billsDatabase = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(c_week);
      var receivedDatabase = billsDatabase.update({  


        gibs:toCost
       


        }).then(
          updateSiteExpenses(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id),
          retreiveBills(wID)
          

        );

      });

// ----------------------------------------------

 
}
function updateSiteExpenses(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id){
  var projectForDesktop = getInputValue("email")
  var site = b_desc

  firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(site).child("Other Expenses").once("value",
  function(cTasks){

      if(cTasks.exists()){
         
          var amountOther = cTasks.val().wage;
          var toCost = parseInt(b_amnt) + parseInt(amountOther)
          


      }
      else{
        var toCost = b_amnt
      }
      var billsDatabase = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(site).child("Other Expenses");
         var receivedDatabase = billsDatabase.update({  


          wage:toCost



        }).then(
          updateOtherExpensesList(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id)
        )
      })

}
function updateOtherExpensesList(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id){
  var projectForDesktop = getInputValue("email")
  var site = b_desc
  var billsDatabase = firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(site).child("Other Expense List").child(id);
         var receivedDatabase = billsDatabase.update({  


          item:b_item,
          amount:b_amnt
          



        }).then(
          document.getElementById("loaderSpan").style.display = "none",
          document.getElementById("mainSpan").style.display = "block",
          document.getElementById("btnRecordBill").disabled = false,
          document.getElementById("payee").value = "",
          document.getElementById("billItem").value = "",
          document.getElementById("billDesc").value = "",
          document.getElementById("billAmount").value = "",
          document.getElementById("billDueDate").value = "",
            
          alert("Bill recorded successfully")
        )

}

function retreiveBills(wID){
  billsTotal = 0
  biilsCount = 0
  // alert(wID)
  var projectForDesktop =getInputValue("email")
  // var wID = day +"-"+month+"-"+year
  firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).once("value",
        function(cTasks){
       

              if(cTasks.exists()){

                firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child("Data").once("value",
                function(cTasks){
                cTasks.forEach(
                  function(childRecord){

                    var payee = childRecord.val().payee     
                    var b_item = childRecord.val().item     
                    var b_desc = childRecord.val().desc      
                    var b_amnt = childRecord.val().amount    
                    var b_d_date = childRecord.val(). due       
                    var date = childRecord.val(). date      
                    var c_week = childRecord.val(). week      
                    var id = childRecord.val(). bill_id  
                    var sta = childRecord.val(). status 
                    var new_week = childRecord.val(). new_week  
                    
                    if(wID === c_week){
                      biilsCount +=parseFloat(b_amnt)
                    }
                    if(new_week !== undefined){
                      c_week = new_week
                    }
                    if(c_week == wID){
                     getMyWeek(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,sta,wID)
                    }
                  })})
               
                  
                
              }
              else{
                  window.alert("No record found for "+wID+". Only pending balances will be loaded")
              }

 
        });
// -----------------------------
  
  

}
function getMyWeek(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,sta,wID){
  var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
        function(Snapshot){

          var Week_date = Snapshot.val().current_week
          addBillsToTable(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,sta,Week_date,wID)
          
          })
}
var billsTotal = 0
var countBills = 0
function addBillsToTable(payee,b_item,b_desc,b_amnt,b_d_date,date,c_week,id,sta,Week_date,wID){
  
// tbodyBills bills_header

  var tbody = document.getElementById("tbodyBills");
  var trow = document.createElement("tr");
  var td1 = document.createElement("td");
  var td2 = document.createElement("td");
  var td3 = document.createElement("td");
  var td4 = document.createElement("td");
  var td5 = document.createElement("td");
  var td6 = document.createElement("td");
  var td7 = document.createElement("td");
  var td8 = document.createElement("td");
  var td9 = document.createElement("td");
  var td10 = document.createElement("td");
  var btn = document.createElement("button");
  var btnCancel = document.createElement("button");
  var btnEdit = document.createElement("button");

  

// td7.style.cursor ="pointer"

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "9px";
btn.style.background = "red";
btn.style.color = "white";
btn.style.padding = "2px";

btnCancel.style.width = "50px";
btnCancel.style.height = "16px";
btnCancel.style.marginTop = "10px";
btnCancel.innerText = "Approve";
btnCancel.style.fontSize = "9px";
btnCancel.style.background = "green";
btnCancel.style.padding = "2px";
btnCancel.style.color = "white";

                      


td2.innerHTML = payee;
td3.innerHTML = b_item;

td4.innerHTML = b_amnt;
td5.innerHTML = date;
td6.innerHTML = b_d_date;
td7.innerHTML = sta;

// td10.innerHTML = pCost;
var delet =  document.createElement("i");
delet.innerHTML = `<i title ="Delete entry" style="float: right; margin-left:5px;cursor:pointer; color:red" class="fa fa-trash" aria-hidden="true"></i>`
td8.appendChild(delet)
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8);
// trow.appendChild(td9);
// trow.appendChild(td10);
// trow.appendChild(btn);
// trow.appendChild(btnCancel); Pendin

tbody.appendChild(trow);
var foward =  document.createElement("i");

foward.innerHTML= `<i title ="Bring forward to current week" style="float: right; margin-right:5px;cursor:pointer" class="fa fa-share" aria-hidden="true"></i>`
var tick =  document.createElement("i");
tick.innerHTML= `<i onclick = "doe()" title ="Update to Paid" style="float: right; color:green; fontSize:16px;cursor:pointer;" class="fa fa-check" aria-hidden="true"></i>`
if(sta ==="Pending"){
  billsTotal +=parseFloat(b_amnt)
}

 
// alert(billsTotal)biilsCount = 0
// const otherExp = document.getElementById("OtherTotal")archive()
// otherExp.innerHTML = "Pending Bills: Ksh "+ Intl.NumberFormat('en-US').format(billsTotal)
document.getElementById("mainProjects").addEventListener("click",()=>{
  var countBills = 0
  biilsCount = 0
trow.remove()
})
document.getElementById("projector").addEventListener("click",()=>{
 
 trow.remove()
 var countBills = 0
 biilsCount = 0

 
})
document.getElementById("btnSet").addEventListener("click",()=>{
  var countBills = 0
 biilsCount = 0
trow.remove()

})
var week_date = getInputValue("date")



document.getElementById("bills_header").innerHTML = "Bills for the week of "+week_date

document.getElementById("btnRecordBill").addEventListener("click",()=>{

  trow.remove()
  var countBills = 0

})
document.getElementById("btnViewPayments").addEventListener('click',() => {
          
        
          trow.remove();
          var countBills = 0
          })

if(sta ==="Pending"){
  var wk =getInputValue("date")
var revwID = wk.replaceAll("/","-")
var wID = revwID.split('-').reverse().join('-')

var fullDate = wID.split("-")
var day = fullDate[0]
var month = fullDate[1]
var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")
 
  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")
 
  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  
  var my_week = day +"-"+month+"-"+year
  // td7.innerHTML = sta +foward+`<i onclick = "doe()" title ="Update to Paid" style="float: right; fontSize:16px;cursor:pointer;" class="fa fa-check" aria-hidden="true"></i>`;
  td8.appendChild(tick)
  // td7.title = "Update to Paid"
  //   td7.style.cursor ="pointer"
  tick.addEventListener("click",()=>{
      if (confirm("Update bill status to PAID?")) {
        var currentdate = new Date(); 
        var date = ("0"+currentdate.getDate()).slice(-2) + "-"
                    + (currentdate.getMonth()+1)  + "-" 
                    + currentdate.getFullYear()
            
        
        updateBillStatus(id,date,td7)
        
    } else {
      
      
    }


    })
    if(my_week !==Week_date){
      // alert(week_date+" "+Week_date)
      td8.appendChild(foward)
      foward.addEventListener("click",()=>{
            if (confirm("Move to current week?")) {
              td7.innerHTML = "Loading..."
              td7.style.color = "red"
              var currentdate = new Date(); 
              var date = ("0"+currentdate.getDate()).slice(-2) + "-"
                          + (currentdate.getMonth()+1)  + "-" 
                          + currentdate.getFullYear()
              
              carryForward(id,date,td7,Week_date,b_amnt,c_week)
              
              
          } else {
            
            
          }
          })
    }
   
  }
  delet.addEventListener("click",()=>{
    var Week_date = getInputValue("date")
    if (confirm("Delete entry?")) {
      td7.innerHTML = "Loading..."
      td7.style.color = "red"
      var currentdate = new Date(); 
      var date = ("0"+currentdate.getDate()).slice(-2) + "-"
                  + (currentdate.getMonth()+1)  + "-" 
                  + currentdate.getFullYear()
      var wk =getInputValue("date")
      var revwID = wk.replaceAll("/","-")
      var wID = revwID.split('-').reverse().join('-')

      var fullDate = wID.split("-")
      var day = fullDate[0]
      var month = fullDate[1]
      var year = fullDate[2]

        if(day.charAt(0) === "0"){
        var day = day.replaceAll("0","")
      
        }
        if(month.charAt(0) === "0"){
        var month = month.replaceAll("0","")
      
        }
        if(year.charAt(0) === "0"){
        var year = year.replaceAll("0","")

        }
        
        var c_week = day +"-"+month+"-"+year           
            
      deteleEntry(id,date,td7,Week_date,b_amnt,c_week)
      
      
  } else {
    
    
  }
  })

document.getElementById("btnViewPayments").addEventListener('click',() => {
          
        
          trow.remove();
  })


}
function deteleEntry(id,date,td7,Week_date,b_amnt,c_week){
  var projectForDesktop = getInputValue("email")
  var billReff = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child("Data").child(id)
  var receivedDatabase = billReff.remove().then(
    
    balanceWeek(id,date,td7,Week_date,b_amnt,c_week),

  )
}
function carryForward(id,date,td7,Week_date,b_amnt,c_week){
//  alert("okay")
var projectForDesktop = getInputValue("email")
  var billsDatabase = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child("Data").child(id);
  var receivedDatabase = billsDatabase.update({  


    new_week:Week_date
    


    }).then(
      
      updateBillsAccount2(id,date,td7,Week_date,b_amnt,c_week)

    );
}
function updateBillsAccount2(id,date,td7,Week_date,b_amnt,c_week){
  var projectForDesktop = getInputValue("email")

  firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(Week_date).once("value",
  function(cTasks){

      if(cTasks.exists()){
         
          var amountOther = cTasks.val().gibs;
          var toCost = parseInt(b_amnt) + parseInt(amountOther)
          


      }
      else{
          var toCost = parseInt(b_amnt) + parseInt("0")
         
      }
      var wID = Week_date 
      // getInputValue("date") only pending
      var billsDatabase = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(Week_date);
      var receivedDatabase = billsDatabase.update({  


        gibs:toCost
       


        }).then(
          
          balanceWeek(id,date,td7,Week_date,b_amnt,c_week)
          

        );

      });

// ----------------------------------------------

 
}
function balanceWeek(id,date,td7,Week_date,b_amnt,c_week){
  var Week_date = getInputValue("date")
  var projectForDesktop = getInputValue("email")

  firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(c_week).once("value",
  function(cTasks){

      if(cTasks.exists()){
         
          var amountOther = cTasks.val().gibs;
          var toCost =   parseInt(amountOther) - parseInt(b_amnt)
          


      }
      else{
          var toCost = parseInt("0")
         
      }
      var wID = Week_date 
      // getInputValue("date") only pending
      var billsDatabase = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(c_week);
      var receivedDatabase = billsDatabase.update({  


        gibs:toCost
       


        }).then(
          // td7.style.color = "black",achiver
          td7.innerHTML = "DONE"
          

        );

      });

// ----------------------------------------------

 
}
function updateBillStatus(id,date,td7){

  var projectForDesktop = getInputValue("email")
  var billsDatabase = firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child("Data").child(id);
  var receivedDatabase = billsDatabase.update({  


    status:"Paid"


    }).then(
      td7.innerHTML = "Paid",
        alert("Bill status updated to PAID")

    );
}
function closeBillsCard(){
  document.getElementById("bills_card").style.display = "none"
}
function openBillsCard(){
  document.getElementById("bills_card").style.display = "block"
}
function closeNewBillCard(){
  document.getElementById("new_bill_card").style.display = "none"
}
function openNewBillCard(){
  document.getElementById("new_bill_card").style.display = "block"
}
function startRegistering(){
  document.getElementById("btnClock").disabled = true
  var userID = getInputValue("idNumber")
  var date = document.getElementById("date")
  var projectForDesktop = getInputValue("email");
  var pro = projectForDesktop;
 
  document.getElementById("loader").style.display = "block"
  document.getElementById("okSpan").style.display = "none"
  document.getElementById("btnClock").disabled = true
  
  
  // document.getElementById("btnClock").innerHTML = ``
 
  if(userID !==""){
    // alert(pro)
    // alert(userID)
    var database = firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").child(userID).once("value",
      function(Snapshot){

       
            if(Snapshot.exists()){
                  var id = Snapshot.val().workID;
                  var nme = Snapshot.val(). name;
                  var wage = Snapshot.val(). wage;
                  var w_site = Snapshot.val(). site;
                  var w_desig = Snapshot.val(). designation;
                  var locations = Snapshot.val().location;
                  
                
                  getWeekID(locations,id,nme,pro,wage,w_site,w_desig);
            }
            else{

              var database = firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").child(userID).once("value",
              function(Snapshot){

                
                    if(Snapshot.exists()){
                          var id = Snapshot.val().workID;
                          var nme = Snapshot.val(). name;
                          var wage = Snapshot.val(). wage;
                          var w_site = Snapshot.val(). site;
                          var w_desig = Snapshot.val(). designation;
                          var locations = Snapshot.val().location;
                          
                      
                          getWeekID(locations,id,nme,pro,wage,w_site,w_desig);
                    }
                    else{
                      var database = firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").child(userID).once("value",
                      function(Snapshot){

                       
                            if(Snapshot.exists()){
                                  var id = Snapshot.val().workID;
                                  var nme = Snapshot.val(). name;
                                  var wage = Snapshot.val(). wage;
                                  var w_site = Snapshot.val(). site;
                                  var w_desig = Snapshot.val(). designation;
                                  var locations = Snapshot.val().location;
                                  
                              
                                  getWeekID(locations,id,nme,pro,wage,w_site,w_desig);
                            }
                            else{
                              document.getElementById("loader").style.display = "none"
                              document.getElementById("okSpan").style.display = "block",
                              document.getElementById("btnClock").disabled = false
                              alert("Worker with ID number ("+userID+") does not exist at "+pro)

                            }
                            

                   
      
                        })
                      

                    }
                    

                    
                
        
      
      
              })
              

            }
            

      
        
      
      
      })
  }
  else{
    document.getElementById("loader").style.display = "none",
    document.getElementById("okSpan").style.display = "block"
    document.getElementById("btnClock").disabled = false
    alert("Please fill in worker ID")

  }
 

}

function startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt){
  // document.getElementById("btnClock").disabled = true
  var userID = id
  var date = document.getElementById("date")
  var projectForDesktop = getInputValue("email");
  var pro = projectForDesktop;
 
  // document.getElementById("loader").style.display = "block"
  // document.getElementById("okSpan").style.display = "none"
  // document.getElementById("btnClock").disabled = true
  
  
  // document.getElementById("btnClock").innerHTML = ``
 
  if(userID !==""){
    // alert(pro)
    // alert(userID)
    var database = firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").child(userID).once("value",
      function(Snapshot){

       
            if(Snapshot.exists()){
                  // var id = Snapshot.val().workID;
                  var nme = Snapshot.val(). name;
                  var wage = Snapshot.val(). wage;
                  var w_site = Snapshot.val(). site;
                  var w_desig = Snapshot.val(). designation;
                  
                  var locations = Snapshot.val().location;
                
                
                  getWeekID(locations,id,nme,pro,wage,w_site,w_desig,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt);
            }
            else{

              var database = firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").child(userID).once("value",
              function(Snapshot){

                
                    if(Snapshot.exists()){
                          // var id = Snapshot.val().workID;
                          var nme = Snapshot.val(). name;
                          var wage = Snapshot.val(). wage;
                          var w_site = Snapshot.val(). site;
                          var w_desig = Snapshot.val(). designation;
                          var locations = Snapshot.val().location;
                          
                      
                          getWeekID(locations,id,nme,pro,wage,w_site,w_desig,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt);
                    }
                    else{
                      var database = firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").child(userID).once("value",
                      function(Snapshot){

                       
                            if(Snapshot.exists()){
                                  // var id = Snapshot.val().workID;
                                  var nme = Snapshot.val(). name;
                                  var wage = Snapshot.val(). wage;
                                  var w_site = Snapshot.val(). site;
                                  var w_desig = Snapshot.val(). designation;
                                  var locations = Snapshot.val().location;
                                  
                              
                                  getWeekID(locations,id,nme,pro,wage,w_site,w_desig,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt);
                            }
                            else{
                              // document.getElementById("loader").style.display = "none"
                              // document.getElementById("okSpan").style.display = "block",
                              // document.getElementById("btnClock").disabled = false
                              alert("Worker with ID number ("+userID+") does not exist at "+pro)

                            }
                            

                   
      
                        })
                      

                    }
                    

                    
                
        
      
      
              })
              

            }
            

      
        
      
      
      })
  }
  else{
    document.getElementById("loader").style.display = "none",
    document.getElementById("okSpan").style.display = "block"
    document.getElementById("btnClock").disabled = false
    alert("Please fill in worker ID")

  }
 

}
 function getWeekID(locations,id,nme,pro,wage,w_site,w_desig,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt){
  // alert(nme)
    var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
        function(Snapshot){
            var date = Snapshot.val().current_week
            
      
            // alert(locations+" "+id+" "+nme+" "+pro+" "+wage+" "+w_site+" "+w_desig)
            updateAttendance  (locations,id,nme,date,pro,wage,w_site,w_desig,nme,pickedDay,td4,td5,td6,td7,td8,td9,td10,wID,td1,trowAtt)
        });
  }
  function  updateAttendance (locations,id,nme,date,pro,wage,w_site,w_desig,nme,pickedDay,td4,td5,td6,td7,td8,td9,td10,wID,td1,trowAtt)
    {
    //  var selectedDay =  getInputValue("selectedDay")

    //  if(selectedDay ==""){
    //   const weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

    //   const d = new Date();
    //   var day = weekday[d.getDay()];

    //  }
    //  else{
    //  
    //  }
     
      
       var day = pickedDay

      var database = firebase.database().ref(parentDatabase).child("Attendance").child(pro).child("Dates").child(date).child(id).child(day).once("value",
        function(Snapshot){
          
            var dayValue = Snapshot.val()
            
            if(dayValue ==="Present"){
              // document.getElementById("loader").style.display = "none",
              // document.getElementById("okSpan").style.display = "block"
              // document.getElementById("btnClock").disabled = false
              // alert(nme+" already clocked for "+day)
              if(day =="Sunday"){
                td4.style.color ="black"
                td4.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              if(day =="Monday"){
                td5.style.color ="black"
                td5.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              if(day =="Tuesday"){
                td6.style.color ="black"
                td6.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              if(day =="Wednesday"){
                td7.style.color ="black"
                td7.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              if(day =="Thursday"){
                td8.style.color ="black"
                td8.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              if(day =="Friday"){
                td9.style.color ="black"
                td9.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              if(day =="Saturday"){
                td10.style.color ="black"
                td10.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
              }
              
            }
            else{
              
                  
              var databaseR = firebase.database().ref(parentDatabase).child("Attendance").child(pro).child("Dates").child(date).child(id);
                var receivedDatabase = databaseR.update({

                
                [day]:"Present"
              

                }).then(
                  updatePayment(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt)
                )

            }
            
        

            
        });
     
  
    }
    function updatePayment(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt){
      

    
        var database = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(date).child(id).once("value",
        function(Snapshot){

            var new_wage = (parseInt(Snapshot.val().wage)+parseInt(wage));

                var databaseR = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(date).child(id);
                var receivedDatabase = databaseR.update({  


                [day]:wage,
                wage:new_wage,
                status:"pending",
            

                }).then(
                    updateSiteAccounts(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt)
                    

                );

        });
       
    }
function updateSiteAccounts(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt){

        var currentdate = new Date(); 
        var childKey =currentdate.getFullYear() +
               "-" 
               +(currentdate.getMonth()+1)  + "-" 
                +   ("0"+currentdate.getDate()).slice(-2) 
                +  " "  
                + ("0"+currentdate.getHours()).slice(-2) + ":"  
                + ("0"+currentdate.getMinutes()).slice(-2) + ":" 
                + ("0"+currentdate.getSeconds()).slice(-2);

                var dateNow = currentdate.getDate() + "-"
                  + (currentdate.getMonth()+1)  + "-" 
                  + currentdate.getFullYear()
                var wwage = wage

          var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(w_site).child("Worker").child(id).once("value",
          function(Snapshot){
                
            if(Snapshot.exists()){
              updateSiteLabor(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt)
               

            }
            else{
               var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(w_site).child("Worker").child(id);
              var receivedDatabase = databaseR.update({        
              
              date: w_desig,
              
              name:nme,
              
              workID:wage,

              }).then(
                updateSiteLabor(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt)
                 
                  
              );
            }
           
          
             
          
          })

        // var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(w_site).child("Workers").child(childKey);
        // var receivedDatabase = databaseR.update({        
        
        // date: dateNow,
        
        // name:nme,
        
        // workID:wage,

        // }).then(
            
           
            
        // );
 }  
var wagerCount = 0
function updateSiteLabor(locations,id,nme,date,pro,wage,w_site,w_desig,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt){ 
  
    var database = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(w_site).child("Labor Cost").once("value",
        function(Snapshot){
            var newS = Snapshot.val().wage
            // alert(newS)
          
            var newCost = (parseInt(Snapshot.val().wage)+parseInt(wage)).toFixed(0).toString()

           
          
                    var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(w_site).child("Labor Cost");
                    var receivedDatabase = databaseR.update({
                    

                    wage:newCost,
                    

                    }).then(
                      updateWeeksLabor(locations,id,nme,date,pro,wage,w_site,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt)
                   
                    
                        
                     );

          
            
         
        });
   
    }
   function updateWeeksLabor(locations,id,nme,date,pro,wage,w_site,day,td4,td5,td6,td7,td8,td9,td10,nme,wID,td1,trowAtt) {
        
       var database = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date).once("value",
        function(Snapshot){
                
            if(Snapshot.exists()){
                var newS = Snapshot.val().wage
               
                var wwage2 = (parseInt(newS)+parseInt(wage)).toFixed(0)
                // alert(parseInt(wwage2))start
            }
            else{
              var wwage2 = wage
            }
            
            
            //
                    var databaseR = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date);
                    var receivedDatabase = databaseR.update({
                    

                    wage:wwage2
                    

                    }).then(

                    finishSingleReg(td4,td5,td6,td7,td8,td9,td10,day,wID,td1,trowAtt,id,nme)
                      // td1.style.color ="black",
                      // td1.innerHTML =   "<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark as presesnt'>  "+nme,
                      // document.getElementById("loader").style.display = "none",
                      // document.getElementById("okSpan").style.display = "block",
                      // document.getElementById("btnClock").disabled = false,
                      // document.getElementById("idNumber").value = "",
                      //  alert(nme +" successfully marked present for "+day)
                        
                     );

          // 179600
            
         
        });
   
   }   

function  finishSingleReg(td4,td5,td6,td7,td8,td9,td10,day,wID,td1,trowAtt,id,nme){
  stateOfView = "Reload register first"
  if(day =="Sunday"){
      td4.style.color ="black"
      td4.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
      td4.title ="Reload register first"
      td4.style.cursor ="not-allowed"
      td4. addEventListener("click",()=>{
    // trowAtt.remove()
      // if (confirm(nme+" will be marked absent on this week's register")) {
      //   var pickedDay = "Sunday"
      //   td1.innerHTML ="Loading..."
      //   td1.style.color ="red"
      //   td4.innerHTML =""
      //   var sun =""
      //   var pickedDay = day
      //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
      // //  td4. addEventListener("click",()=>{})
          
      // } else {

      // }
    })
  }
  if(day =="Monday"){
    td5.style.color ="black"
    td5.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td5.title ="Reload register first"
    td5.style.cursor ="not-allowed"
    td5. addEventListener("click",()=>{


  //   if (confirm(nme+" will be marked as absent on Monday")) {
  //     td1.innerHTML="Loading..."
  //     var pickedDay = "Monday"
  //     td1.style.color ="red"
  //     td5.innerHTML=""
  //     var mon =""
  //       // trowAtt.remove()
  //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
  //   //  td5. addEventListener("click",()=>{})
        
  //   } else {

  // }
})
  }
  if(day =="Tuesday"){
    td6.style.color ="black"
    td6.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`

    td6.title ="Reload register first"
    td6.style.cursor ="not-allowed"
    td6. addEventListener("click",()=>{
    
    // if (confirm(nme+" will be marked as absent on Tuesday")) {
    //   var pickedDay = "Tuesday"
    //   td1.innerHTML="Loading..."
    //   td1.style.color ="red"
    //   td6.innerHTML=""
    //   var tue =""
    //     // trowAtt.remove()
    //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
    //   // td6. addEventListener("click",()=>{})
        
    // } else {

    // }
    })
  }
  if(day =="Wednesday"){
    td7.style.color ="black"
    td7.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td7.title ="Reload register first"
    td7.style.cursor ="not-allowed"
    td7. addEventListener("click",()=>{
    // var pickedDay = "Wednesday"
    // if (confirm(nme+" will be marked as absent on  Wednesday")) {
    
      
    //   td1.innerHTML="Loading..."
    //   td1.style.color ="red"
    //   td7.innerHTML=""
    //   var wed =""
    //   // trowAtt.remove()
    // revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt) 
    // //  td7. addEventListener("click",()=>{})
    // } else {

    // }
   })
  }
  if(day =="Thursday"){
    td8.style.color ="black"
    td8.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td8.title ="Reload register first"
    td8.style.cursor ="not-allowed"
    td8. addEventListener("click",()=>{
    

    // if (confirm(nme+" will be marked as absent on Thursaday")) {
    //   var pickedDay = "Thursday"
    //   td1.innerHTML="Loading..."
    //   td1.style.color ="red"
    //   td8.innerHTML=""
    //   var thur =""
    //     // trowAtt.remove()
    //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
    // //  td8. addEventListener("click",()=>{})
        
    //   } else {

    //   }
    })
  }
  if(day =="Friday"){
    // alert("here")
    td9.style.color ="black"
    td9.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td9.title ="Reload register first"
    td9.style.cursor ="not-allowed"
    td9. addEventListener("click",()=>{
      
      // if (confirm(nme+" will be marked as absent on Friday")) {
      //   var pickedDay = "Friday"
      //   td1.innerHTML="Loading..."
      //   td1.style.color ="red"
      //   td9.innerHTML=""
      //   var fri =""
      //     // trowAtt.remove()
      // revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
      // //  td9. addEventListener("click",()=>{})
          
      // } else {

      // }
    })

  }
  if(day =="Saturday"){
    td10.style.color ="black"
    td10.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`

    td10.title ="Reload register first"
    td10.style.cursor ="not-allowed"
    td10.addEventListener("click",()=>{
    
    // if (confirm(nme+" will be marked as absent on Saturday")) {
    //     var pickedDay = "Saturday"
    //     td1.innerHTML ="Loading..."
    //     td1.style.color ="red"
    //     var sat =""
    //     td10.innerHTML=""
    //     // trowAtt.remove()
    //     revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
    //     // td10. addEventListener("click",()=>{})
        
    //   } else {

    //   }
    })
  }
}
   function autoUpdateAtt(locations,id,nme,date){
  var databaseR = firebase.database().ref(parentDatabase).child("Attendance").child("BUSIA CAIP").child("Dates").child("15-1-2024").child(id);
        var receivedDatabase = databaseR.update({ 

                    
                
          ["Monday"]:"Present",
          ["Tuesday"]:"",
          ["Wednesday"]:"",
          ["Thursday"]:"",
          ["Friday"]:"",
          ["Saturday"]:"",
          ["Sunday"]:"",
          name:nme,
          location:locations,
          
          clock:"out",
      
          workID: id
      

          });
}

var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal
btn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
var span = document.getElementsByClassName("close")[0];
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
function fetchWeekPayments(){

}
function downLoadBills(type){
  var date = getInputValue("date")
  var projectForDesktop = getInputValue("email")
  var doc_name = projectForDesktop+" bills for the week of "+date


  var data = document.getElementById('tableBills');

  var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
  XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
  XLSX.writeFile(excelFile, doc_name +'.'+ type); 

}

function saveaTTENDANCE(type){
  var date = getInputValue("dateAtendance")
  var projectForDesktop = getInputValue("email")


  var doc_name =projectForDesktop+ " Attendance for the week of "+date


  var data = document.getElementById('tableAttendance');

  var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
  XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
  XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}
function saveContract(type){
  var projectForDesktop = getInputValue("email")

var doc_name = "Contract workers at "+projectForDesktop


var data = document.getElementById('tableContract');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 

}
function saveHistory(type){
  
  var projectForDesktop = getInputValue("email")

  var doc_name =projectForDesktop+ " Payment History "


  var data = document.getElementById('tablePaymentsHistry');

  var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
  XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
  XLSX.writeFile(excelFile, doc_name +'.'+ type); 
}
function savePayments(type){
  var date = getInputValue("date")
  var projectForDesktop = getInputValue("email")

var doc_name =projectForDesktop+ " Payment for the week of "+date


var data = document.getElementById('tablePayments');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 

// pro projects_progress tbodyExps
}
function saveOtherEx(type){
  // var date = getInputValue("date")
  var projectForDesktop = getInputValue("email")

var doc_name ="Other expenses at "+ projectForDesktop


var data = document.getElementById('tableExps');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 

// pro projects_progress tbodyExps
}
function showSites(){
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("liner").style.display ="none"
  document.getElementById("projects_progress").style.display ="none"
  document.getElementById("list").style.display ="flex"
  document.getElementById("store_panel").style.display ="none"
  document.getElementById("sites_in_project").style.display ="block"
  document.getElementById("logger").style.display ="none"
  document.getElementById("staff_panel").style.display ="none"
  document.getElementById("attendanceForSite").style.display ="none"
  document.getElementById("paymentsForSite").style.display ="none"
  document.getElementById("sites_in_project2").style.display ="none"
}
function showStore(){
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("liner").style.display ="none"
  document.getElementById("projects_progress").style.display ="none"
  document.getElementById("list").style.display ="flex"
  document.getElementById("store_panel").style.display ="block"
  document.getElementById("sites_in_project").style.display ="none"
  document.getElementById("logger").style.display ="none"
  document.getElementById("staff_panel").style.display ="none"
  document.getElementById("attendanceForSite").style.display ="none"
  document.getElementById("paymentsForSite").style.display ="none"
  document.getElementById("sites_in_project2").style.display ="none"
}
function openStaff(){
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("liner").style.display ="none"
  document.getElementById("projects_progress").style.display ="none"
  document.getElementById("sidebar").style.display ="none"
  document.getElementById("list").style.display ="flex"
  document.getElementById("store_panel").style.display ="none"
  document.getElementById("sites_in_project").style.display ="none"
  document.getElementById("logger").style.display ="none"
  document.getElementById("staff_panel").style.display ="block"
  document.getElementById("attendanceForSite").style.display ="none"
  document.getElementById("paymentsForSite").style.display ="none"
  document.getElementById("sites_in_project2").style.display ="none"

}
function openAttendance(){
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("liner").style.display ="none"
  document.getElementById("projects_progress").style.display ="none"
  document.getElementById("sidebar").style.display ="none"
  document.getElementById("list").style.display ="flex"
  document.getElementById("store_panel").style.display ="none"
  document.getElementById("sites_in_project").style.display ="none"
  document.getElementById("logger").style.display ="none"
  document.getElementById("staff_panel").style.display ="none"
  document.getElementById("attendanceForSite").style.display ="block"
  document.getElementById("paymentsForSite").style.display ="none"
  document.getElementById("sites_in_project2").style.display ="none"

}
function openPayments(){
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("liner").style.display ="none"
  document.getElementById("projects_progress").style.display ="none"
  document.getElementById("sidebar").style.display ="none"
  document.getElementById("list").style.display ="flex"
  document.getElementById("store_panel").style.display ="none"
  document.getElementById("sites_in_project").style.display ="none"
  document.getElementById("logger").style.display ="none"
  document.getElementById("staff_panel").style.display ="none"
  document.getElementById("attendanceForSite").style.display ="none"
  document.getElementById("paymentsForSite").style.display ="block"
  document.getElementById("sites_in_project2").style.display ="none"

}
function showsingleSiteDetails(){
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("liner").style.display ="none"
  document.getElementById("projects_progress").style.display ="none"
  document.getElementById("sidebar").style.display ="none"
  document.getElementById("list").style.display ="flex"
  document.getElementById("store_panel").style.display ="none"
  document.getElementById("sites_in_project").style.display ="none"
  document.getElementById("logger").style.display ="none"
  document.getElementById("staff_panel").style.display ="none"
  document.getElementById("attendanceForSite").style.display ="none"
  document.getElementById("paymentsForSite").style.display ="none"
  document.getElementById("sites_in_project2").style.display ="block"

}
function start(pro,typee,supl){

 
  // var pro ="Gems Phase 1" 
  var pl = getInputValue("pN")
  var pro = getInputValue("email")

  var database = firebase.database().ref(parentDatabase).child("Clientel").child(pro).once("value",
  function(Snapshot){
    if(Snapshot.exists()){

      var storedPIN= Snapshot.val().password;
      
      if (storedPIN === ""){
        document.getElementById("names").style.display ="block"
        alert(pro +" is not registered in our database. Please contact our customer care to update the project")
      }
      else{
        if(storedPIN === pl){
          // showDetails(pro,pl)window
          // alert("GOOD TO GO!")
          getReadyT(pro,typee,supl)
          var id ="0"
          var blueClass = "blueClass"
          startCreation(parentDatabase,id,blueClass)
          // addCreated()
        }
        else{
          document.getElementById("names").style.display ="block"
          document.getElementById("myBar").style.display ="none" 
          alert("The project selected has not been activated")
        }
      }
    }
    else{
      document.getElementById("names").style.display ="block"
      document.getElementById("myBar").style.display ="none" 
      alert("The project selected has not been activated")
    }
  });

  
}
function showDetails(pro,pl){
  var database = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child("Clients").child(pl).once("value",
  function(Snapshot){

    var  tDN = Snapshot.val().TitleDeedNumber;
    var  totalPaid = Snapshot.val().amout
    var  bal = Snapshot.val().balance
    var  phone = Snapshot.val().phoneNumber
    var  location = Snapshot.val().residence
    var  associates = Snapshot.val().Associates
    var  name = Snapshot.val().fullname

    var tS ="COMPLETE"

    var intAmount = parseInt(totalPaid)
    var intBal = parseInt(bal)
    var intFullAmount = intAmount + intBal
    var  fullAmount = intFullAmount.toString();

    if(intBal > 0){
      var tS ="IN PROGRESS.."
    }

    if(tDN ===""){
      var tDN ="Not Processed"
      var tS = "IN PROGRESS.."
      
    }
    if(totalPaid ===""){
      var totalPaid ="No Record.."
      
      var fullAmount ="No Record.."
     
      
    }
    if(bal ===""){
      var bal ="No Record.."
      
      var fullAmount ="No Record.."
     
      
    }
    if(phone===""){
      var phone ="No Record.."
      
    }
    if(location ===""){
      var location ="No Record.."
      
    }
    if(associates ===""){
      var associates ="None"
      
    }

   addToView(pro,pl,tDN,totalPaid,bal,phone,location,associates,tS,fullAmount,name)

  });
}

function addToView(pro,pl,tDN,totalPaid,bal,phone,location,associates,tS,fullAmount,name){
  // 
  var pN = document.getElementById("Pname")
  var plot = document.getElementById("plotNumber")
  var tdn = document.getElementById("titleDeedNo")
  var fA = document.getElementById("fAmount")
  var paid = document.getElementById("tPaid")
  var bl = document.getElementById("balance")
  var trSt = document.getElementById("ts")
  var phn = document.getElementById("phone")
  var loc = document.getElementById("location")
  var ass = document.getElementById("associates")
  var n = document.getElementById("name")

  pN.innerHTML =pro;
  plot.innerHTML=pl;
  tdn.innerHTML=tDN;
  fA.innerHTML="Ksh "+ fullAmount;
  paid.innerHTML="Ksh "+ totalPaid;
  bl.innerHTML="Ksh "+ bal;
  trSt.innerHTML=tS;
  phn.innerHTML="PHONE: "+ phone;
  loc.innerHTML="ADDRESS: "+ location;
  ass.innerHTML="ASSOCIATES: "+ associates;
  n.innerHTML= name;

showAll();
  


}
function showAll(){
  //,,
  var login = document.getElementById("login")
  var details = document.getElementById("details")
  var mainM = document.getElementById("mainM")
  // var images = document.getElementById("plotImages");
  
  // images.style.display = "block"
  
  login.style.display = "none"
  details.style.display = "block"
  mainM.style.display = "block"
  
}

function subscribe(){
  var mail = getInputValue("mail")

  if(mail !==""){
  var currentDate = new Date();
  var day = currentDate.getDate();
  var month = currentDate.getMonth()+1;
  var year = currentDate.getFullYear()
  var hour = currentDate.getHours();
  var munit = currentDate.getMinutes();
  var seconds = currentDate.getSeconds()

  if(day < 10){
    var day = "0"+day
  }
  if(month < 10){
    var month = "0"+month
  }

  var date = year+"-"+month+"-"+day
  var fullDate = hour+":"+munit+":"+seconds
  var recDate = date+" "+fullDate

  var database = firebase.database().ref("Subscribers").child(recDate);
  var newDatabase = database.update({

    email:mail,
    Date:date

  })
  alert("Thank You For Subscribing To Our Monthly Update")

  }
  else{
    alert("Please Enter Email Address!")
  }
  

  
}
function showImages(){
  
  var login = document.getElementById("login")
  var details = document.getElementById("details")
  var mainM = document.getElementById("mainM")
  var images = document.getElementById("plotImages");
  
  images.style.display = "block"

  login.style.display = "none"
  details.style.display = "none"
  mainM.style.display = "none"
  
  // images.style.height="400px"
  var back = document.getElementById("back");

  back.addEventListener("click",()=>{
    images.style.display = "none"

    login.style.display = "none"
    details.style.display = "block"
    mainM.style.display = "block"

  })

}

function getInputValue(id){
  return document.getElementById(id).value
}
window.onload = getProsOnStart()

function loadProjects2(){
 var pro = getInputValue("email")
  var average = (parseFloat(totalValue/countMilestones)).toFixed(1)
  if(average =="NaN"){
    var average = 0
  }
  var databaseR = firebase.database().ref(parentDatabase).child("projectNames").child(pro);
    var receivedDatabase = databaseR.update({  


      progress:average,
      


    }).then(
      getProsOnStart()
    )
}

var countMilestones = 0
var totalValue = 0
function calculateProjectPercentage(nam){
  totalValue = 0
  countMilestones = 0
  var database = firebase.database().ref(parentDatabase).child("Master Schedule").child(nam).child("Record").once("value",
  function(cTasks){
      cTasks.forEach(
        function(childRecord){
          if(childRecord.exists()){
            var launched = childRecord.val().percentage
            ++countMilestones
            totalValue = totalValue + parseInt(launched)
          }
          else{

          }
          
          // alert(countMilestones)Constructions
        })
      })
}
function getProsOnStart(){
  setWeekDate()
 container.remove
  // document.getElementById("sites_in_project").style.display ="block"
    var database = firebase.database().ref(parentDatabase).child("projectNames").orderByChild("name").once("value",
  function(Snapshot){
    Snapshot.forEach(
      function(childSnapshort){
          var nam = childSnapshort.val().name
          var stDate = childSnapshort.val().date1
          var endDate = childSnapshort.val().date2
          var loc = childSnapshort.val().location
          var prog = childSnapshort.val().progress
          var typee = childSnapshort.val().type
          var supl = childSnapshort.val().supllies
          var imgSrc = childSnapshort.val().image

          if(supl === undefined){
            supl = "0"
          }
          if(nam ==="MOLO 1"){
           
          }
          else{
             addNameToTable(nam,stDate,endDate,loc,prog,typee,supl,imgSrc)
              makeRows(1, 3,nam,stDate,endDate,loc,prog,typee,supl);
          }

        
      }
    )
   

  });
}
function getProjectNames(){
  

  document.getElementById("names").style.display ="block"



}
var count = 1
function addNameToTable(nam,stDate,endDate,loc,prog,typee,supl,imgSrc){
  
  var projectSelected = document.getElementById("email") 
  var pin = document.getElementById("pN") 
//  var imgSrc = "https://seahawklogistics.co.ke/assets/img/ol2.jpeg"
  var tbody = document.getElementById("projectsAvailable");
  var trow = document.createElement("tr");
  var td1 = document.createElement("td");
  var td2 = document.createElement("td");
  var td3 = document.createElement("td");
  var td4 = document.createElement("td");
  var td5 = document.createElement("td");
  var td6 = document.createElement("td");
  var imageH = document.createElement("img");
//  td2.style.marginLeft ="10px"
td6.style.textAlign ="center"
td6.style.color ="red"
imageH.innerHTML = imgSrc
td2.style.fontFamily = "sans-serif"
// tbody.style.padding ="1rem"
  // td2.style.border= "1px solid";
  // td3.style.border= "1px solid";
  // td4.style.border= "1px solid";
  // td5.style.border= "1px solid";
  // td6.style.border= "1px solid";
  td1.innerHTML = count++;
    
  if(nam ==="MOLO 1"){
    td2.innerHTML = nam+" (F)";
  }
  else{
     td2.innerHTML = `<img style="height:36px; width:36px; margin-right:2rem; border-radius: 50%; vertical-align:midlle;" src =  `+imgSrc+`>`+ nam
  }
  td3.innerHTML = loc
  td4.innerHTML = stDate
  // td5.innerHTML = endDate
  if(prog >= 50 && prog < 75){
    td6.style.color ="yellow"
    td6.innerHTML = '<progress style="height:20px;vertical-align:middle; margin-right:5px;" id="file" value= "'+prog+'" max="100"> </progress>'+" "+ prog+"%"
  }
  if(prog > 75 ){
    td6.style.color ="green"
    td6.innerHTML = '<progress style="height:20px;vertical-align:middle; margin-right:5px;" id="file" value= "'+prog+'" max="100"> </progress>'+" "+ prog+"%"
  }
  if(prog < 50 ){
    td6.style.color ="brown"
    td6.innerHTML = '<progress style="height:20px; vertical-align:middle; margin-right:5px;" id="file" value= "'+prog+'" max="100"> </progress>'+" "+ prog+"%"
  }
 
  
  
  // trow.appendChild(td1);Attendance supValue
  trow.appendChild(td2);
  trow.appendChild(td3);
  trow.appendChild(td4);
  // trow.appendChild(td5);
  trow.appendChild(td6);
  tbody.appendChild(trow);
  //  trow.remove();
  var supV = document.getElementById("supValue").innerHTML
  document.getElementById("mainProjects").addEventListener("click",()=>{
    trow.remove()
    
    // setSupplies(pro,typee,supV)
  })
  trow.addEventListener("mouseover",()=>{
   
    trow.style.color = "white"
    trow.style.backgroundColor = "rgba(165, 42, 42, 0.521)"
    
  })
  trow.addEventListener("mouseout",()=>{
    trow.style.color = "white"
    trow.style.backgroundColor ="#24011c1c"
  })
  trow.addEventListener("click",()=>{
    
    projectSelected.value = nam
    pin.value = "9090"
    document.getElementById("names").style.display ="none"
    var pro = nam
    start(pro,typee,supl)
    calculateProjectPercentage(nam)
    
    var i = 0
  
    document.getElementById("myBar").style.display ="block"
   
    document.getElementById("logger").style.display ="none"
    
   })
}

function showProjects(){
  loadProjects2()
  document.getElementById("scheduleLoader").style.display ="none"

  document.getElementById("my_calendar_en").style.display ="none"
  document.getElementById("my_calendar_en2").style.display ="none"
  document.getElementById("my_calendar_en3").style.display ="none"
  document.getElementById("my_calendar_en4").style.display ="none"
  document.getElementById("my_calendar_en5").style.display ="none"
  document.getElementById("my_calendar_en6").style.display ="none"
  document.getElementById("projectIdentity").innerHTML ="My Projects"
    document.getElementById("names").style.display ="block"
    document.getElementById("list").style.display ="none"
    document.getElementById("store_panel").style.display ="none"
    document.getElementById("sites_in_project").style.display ="none"
    document.getElementById("projects_progress").style.display ="none"
    document.getElementById("liner").style.display ="flex"
    document.getElementById("logger").style.display ="none"
    document.getElementById("staff_panel").style.display ="none"
    document.getElementById("attendanceForSite").style.display ="none"
    document.getElementById("paymentsForSite").style.display ="none"
    document.getElementById("sites_in_project2").style.display ="none"
    document.getElementById("SumProjectedH").style.display ="none"
    document.getElementById("SumTotalAll").style.display ="none"
    // document.getElementById("prevBalH").style.display ="none"
}               

function showProjectSchedule(){
  
  document.getElementById("navHolder").style.display ="block"
  // document.getElementById("projectIdentity").innerHTML ="My Projects"
    document.getElementById("names").style.display ="none"
    // document.getElementById("list").style.display ="none"
    document.getElementById("store_panel").style.display ="none"
    document.getElementById("sites_in_project").style.display ="none"
    document.getElementById("projects_progress").style.display ="flex"
    document.getElementById("liner").style.display ="flex"
    document.getElementById("logger").style.display ="none"
    document.getElementById("staff_panel").style.display ="none"
    document.getElementById("attendanceForSite").style.display ="none"
    document.getElementById("paymentsForSite").style.display ="none"
    document.getElementById("sites_in_project2").style.display ="none"
    // document.getElementById("SumProjectedH").style.display ="none"
    // document.getElementById("SumTotalAll").style.display ="none"
    moker()

}
function moker(){
    addCreated()

}
 

// MIZIZI AFRICA H  ASALI start
// var parentDatabase = "SEAHAWK";
// var projectForDesktop = nam;
var projectForDesktop = getInputValue("email")
function saveCasuals(type){
var doc_name = "Temporary workers"

var data = document.getElementById('tableCasuals');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 

}
function savePemanent(type){
var doc_name = "Permanent workers"

var data = document.getElementById('tablePermanent');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 
}
function postNewReceivedU(){
alert("The system now uses chain opperation which must start by sending documents to client for signing")
window.location.href ="dashboard.html";
}
function ostNewReceived(){
var d = getInputValue("rDate")
var No = getInputValue("rTNo")
var N = getInputValue("rName")

aveReceived(d,No,N);


}

function saveSitesMain(type){

var doc_name = "GEMs_Sites"

var data = document.getElementById('tableSites');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}
function saveSites(type){


var doc_name = document.getElementById("site_id").innerHTML

var data = document.getElementById('tableSingle_site');

var excelFile = XLSX.utils.table_to_book(data, {sheet: doc_name});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}
function saveStock(type){

var doc_name = "Stock"


var data = document.getElementById('tableStock');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}

function saveTools(type){

var doc_name = "Tools"


var data = document.getElementById('tableTools');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}
function saveUsages(type){

var doc_name = "Usages"


var data = document.getElementById('tableUsage');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}
function saveSuplies(type){

var doc_name = "Supplies"


var data = document.getElementById('tableSuplies');

var excelFile = XLSX.utils.table_to_book(data, {sheet: "sheet1"});
XLSX.write(excelFile, { bookType: type, bookSST: true, type: 'base64' });
XLSX.writeFile(excelFile, doc_name +'.'+ type); 


}
function saveReceived(doc,name,contact,d){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var date = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = date+" "+fullDate

var databaseR = firebase.database().ref('Title Deeds').child("Received").child(recDate);
var receivedDatabase = databaseR.update({

order: "-"+date+" "+fullDate,
recordDate: date+" "+fullDate,
date: date,
titleDeedNo:doc,
name:name,
phone:contact

});
updateRNo(d)
var modal = document.getElementById("eventsModal1")
modal.style.display ="none"

}

function postEnquiry(){
var desc = getInputValue("eDesc")
var media = getInputValue("eMedia")
var phone = getInputValue("ePhone")
var email = getInputValue("eEmail")
var name = getInputValue("eName")
saveEnquiry(desc,media,phone,email,name);

}
function saveEnquiry(desc,media,phone,email,name){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var date = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = date+" "+fullDate

var databaseR = firebase.database().ref('Enquiry').child(recDate);
var receivedDatabase = databaseR.update({

Datee:recDate,
name:name,
media:media,
phone:phone,
email:email,
Description:desc

});

updateENo()


}
function updateENo()
{

firebase.database().ref('enquiryTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseE= firebase.database().ref('enquiryTot');
                                      var receivedDatabase = databaseE.update({

                                          totR:newReceived

                                      });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"
})  


}
function updateRNo(d){

firebase.database().ref('rTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseE= firebase.database().ref('rTot');
                                      var receivedDatabase = databaseE.update({

                                          totR:newReceived

                                      });

                                      deletePT(d);
                  
              
                
})  


}
function updateSentNo(d){

firebase.database().ref('SentTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseSS= firebase.database().ref('SentTot');
                                      var receivedDatabase = databaseSS.update({

                                          totR:newReceived

                                      });
                                      deletePS(d);
                  
              
                  alert("Operation Successfull")
                  
              // window.location.href ="dashboard.html"
})  


}
function updateSVNo(){

firebase.database().ref('SiteVNo').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseK= firebase.database().ref('SiteVNo');
                                      var receivedDatabase = databaseK.update({

                                          totR:newReceived

                                      });
                  
              
                  alert("Operation Successfull")
                  
              // window.location.href ="dashboard.html"

              var form = document.getElementById("fSVB")
              form.reset();
})  


}
function updateDNo(d){

firebase.database().ref('DispTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseSD= firebase.database().ref('DispTot');
                                      var receivedDatabase = databaseSD.update({

                                          totR:newReceived

                                      });
                                      deleteReady(d);
                  
              
              //     alert("Operation Successfull")
                  
              // window.location.href ="dashboard.html"Sites Stock
})  


}
function updatePNo(d){

firebase.database().ref('pendingSTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseHD= firebase.database().ref('pendingSTot');
          var receivedDatabase = databaseHD.update({

              totR:newReceived

          });
          deletePDFC(d);

              
              //     alert("Operation Successfull")
                  
              // window.location.href ="dashboard.html"
})  


}
function updateUNo(){

firebase.database().ref('OfficeUTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseE= firebase.database().ref('OfficeUTot');
                                      var receivedDatabase = databaseE.update({

                                          totR:newReceived

                                      });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"
})  


}
function updateENo(){

firebase.database().ref('enquiryTot').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseE= firebase.database().ref('enquiryTot');
                                      var receivedDatabase = databaseE.update({

                                          totR:newReceived

                                      });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"
})  


}

function ostSent(){


var date = getInputValue("sDate")
var doc = getInputValue("sDoc")
var name = getInputValue("sName")
var id = getInputValue("sID")
var rider = getInputValue("sRider")
saveSent(date,doc,name,id,rider);

}
function saveSent(doc,name,contact,d){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat +" "+fullDate

var databaseR = firebase.database().ref('Title Deeds').child("Pending").child(recDate);
var receivedDatabase = databaseR.update({

Datee:dat,
name:name,
Doc:doc,
id:contact,
// Rider:rider,
order:"-"+recDate,
d:recDate


});

updateSentNo(d)

}

function postSiteVisit(){

var pop = getInputValue("svPopVal")
var phone = getInputValue("svPhoneNumber")
var name = getInputValue("sVName")
var time = getInputValue("sVTime")
var date = getInputValue("svDat")
var pNo = getInputValue("plotNumberr")
var d = ""
var email = "felishtech@gmail.com"
saveSV(date,pop,name,time,pNo,phone,d,email);

}
function saveSV(date,pop,name,time,pNo,phone,d,email){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()
if (month < 10){

month = "0"+month


} 
var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate
var order = day+month+year


var databaseR = firebase.database().ref('Site Visits').child(recDate);
var receivedDatabase = databaseR.update({

Datee:date,
name:name,
project:pNo,
time:time,
Phone:phone,
Pop:pop,
id:recDate,
order:"-"+order,
email:email



});


sendMailToClient(email,name,time,date,pop,pNo);


}
function sendMailToClient(email,name,time,date,pop,pNo){

Email.send({
Host:"smtp.gmail.com",
Username:"felishtech@gmail.com",
Password:"rghbpljsntkaaayf",
To: email,
From:"customerrelations@greenhavenproperties.co.ke",
Subject: `GREEN HAVEN PROPERTIES - Site Visit Approved!.`,
Body:`
Dear <b>${name}</b>.
<br/> 
<br/>
We are pleased to inform you that your site visit booking for <b>${pNo}</b> project
on <b>${date}</b> at <b>${time}</b> has been approved. We have made a reservation for 
<b>${pop}</b> person(s) as requested in your booking. <br/>
We will be expecting you at our office at Diani Beach Shopping Center, First Floor.<br/>
<br/><b>Office Location Link: </b>https://www.google.co.ke/maps/place/Green+Haven+Properties/@-4.2991197,39.5785867,765m/data=!3m2!1e3!4b1!4m5!3m4!1s0x1840461c9417c2cd:0x338159c6302e582d!8m2!3d-4.2991251!4d39.5807754?hl=en

<br/><br/>
<b>Please keep time.. Thank You.!
  </b><br/><br/><b> Regards, Green Haven Properties<br/>Address: P.O.Box 5556-80401 Diani Beach <br/>Contact: +254700086333<br/>
  Website: www.greenhavenproperties.co.ke</b>`,

}).then()

updateSVNo()
// alert("Payment notification sent to the client") 
}




function ostTitleDisp(){

          
var dDate = getInputValue("dispDate")
var dName = getInputValue("dispName")
var dTDN = getInputValue("dispTDN")
var disID = getInputValue("dispID")
var dPhone = getInputValue("dispPhone")
// var pNo = getInputValue("plotNumberr")
postT(dDate,dName,dTDN,disID,dPhone);

}
function postT(phone,name,doc,d){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate

var Odat =year+month+day
var OfullDate = hour+munit+seconds
var Order = dat+fullDate

var databaseR = firebase.database().ref('Title Deeds').child("Dispatched").child(recDate);
var receivedDatabase = databaseR.update({


Datee:dat,
name:name,
tNo:doc,
id:recDate,
phone:phone,
order:"-"+Order


});

updateDNo(d)


}

function ostPS(){

var psDate = getInputValue("pSDate")
var pSName = getInputValue("pSName")
var pSDoc = getInputValue("pSDoc")
var pSPhone = getInputValue("pSPhone")
// var dPhone = getInputValue("dispPhone")
// var pNo = getInputValue("plotNumberr")
postP(psDate,pSName,pSDoc,pSPhone);

}
function postP(psDate,pSName,pSDoc,pSPhone,d){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate

var databaseR = firebase.database().ref('Pending Signatures').child(recDate);
var receivedDatabase = databaseR.update({


Datee:psDate,
name:pSName,
Doc:pSDoc,
phone:pSPhone,
order:"-"+psDate,
d:recDate


});

updatePNo(d)

}

function postPDFC(){

var name = getInputValue("CName")
var date = getInputValue("datE")
var doc = getInputValue("PDoc")
var cont = getInputValue("contact")
// var dPhone = getInputValue("dispPhone")
// var pNo = getInputValue("plotNumberr")
postPD(name,date,doc,cont);

}
function postPD(name,date,doc,cont){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate

var databaseR = firebase.database().ref('Pending Documents').child(recDate);
var receivedDatabase = databaseR.update({


Datee:date,
name:name,
Doc:doc,
phone:cont,
order:"-"+recDate,
d:recDate


});

updatePDNo()

}

function updatePDNo(){
firebase.database().ref('PendingDocNo').once("value",
function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV +1;
      var newReceived = intToRec.toString();
      
      var databaseK= firebase.database().ref('PendingDocNo');
                                      var receivedDatabase = databaseK.update({

                                          totR:newReceived

                                      });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"
})  


}

function postUpdate(){

var descrip = getInputValue("updateDesc")

postU(descrip);

}
function postU(descrip){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate

var databaseR = firebase.database().ref('Office Updates').child(recDate);
var receivedDatabase = databaseR.update({

Desc:descrip,
date:recDate,
order:"-"+recDate


});

updateUNo()

}

function openModal1(){
var modal = document.getElementById("eventsModal1");
modal.style.display = "block"
}


function openModal2(){
var modal = document.getElementById("eventsModal2");
modal.style.display = "block"
}

function openModal3(){
var modal = document.getElementById("eventsModal3");
modal.style.display = "block"
}

function openModal4(){
var modal = document.getElementById("eventsModal4");
modal.style.display = "block"
}

function openModal5(){
var modal = document.getElementById("eventsModal5");
modal.style.display = "block"
}

function openModal6(){
var modal = document.getElementById("eventsModal6");
modal.style.display = "block"
}

function openModal7(){
var modal = document.getElementById("eventsModal7");
modal.style.display = "block"
}

function openModal8(){
var modal = document.getElementById("eventsModal8");
modal.style.display = "block"
}


function openEnquiries(){
var dispatchedT = document.getElementById("SVBContainer")
dispatchedT.style.display ="none"

var enquiries = document.getElementById("enquiryContainer")
enquiries.style.display ="block"

var enquiries = document.getElementById("oContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pDContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pContainer")
enquiries.style.display ="none"

var readyT = document.getElementById("readyT")
readyT.style.display ="none"

var upcomingSV = document.getElementById("upcomingSV")
upcomingSV.style.display ="none"

var pendingT = document.getElementById("pendingT")
pendingT.style.display ="none"

var dispatchedT = document.getElementById("dispatchedT")
dispatchedT.style.display ="none"

}
function openSignatures(){
var dispatchedT = document.getElementById("SVBContainer")
dispatchedT.style.display ="none"

var enquiries = document.getElementById("pContainer")
enquiries.style.display ="block"

var enquiries = document.getElementById("enquiryContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("oContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pDContainer")
enquiries.style.display ="none"

var readyT = document.getElementById("readyT")
readyT.style.display ="none"

var upcomingSV = document.getElementById("upcomingSV")
upcomingSV.style.display ="none"

var pendingT = document.getElementById("pendingT")
pendingT.style.display ="none"

var dispatchedT = document.getElementById("dispatchedT")
dispatchedT.style.display ="none"
}
function openOU(){
var dispatchedT = document.getElementById("SVBContainer")
dispatchedT.style.display ="none"

var enquiries = document.getElementById("oContainer")
enquiries.style.display ="block"

var enquiries = document.getElementById("pDContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("enquiryContainer")
enquiries.style.display ="none"

var readyT = document.getElementById("readyT")
readyT.style.display ="none"

var upcomingSV = document.getElementById("upcomingSV")
upcomingSV.style.display ="none"

var pendingT = document.getElementById("pendingT")
pendingT.style.display ="none"

var dispatchedT = document.getElementById("dispatchedT")
dispatchedT.style.display ="none"




}
// 
function openSites(){
  // oContainer
var enquiries = document.getElementById("sites_in_project2")
enquiries.style.display ="block"

var enquiries = document.getElementById("sites_in_project")
enquiries.style.display ="none"

// var enquiries = document.getElementById("pContainer")
// enquiries.style.display ="none"

// var enquiries = document.getElementById("enquiryContainer")Permanent
// enquiries.style.display ="none"

// var readyT = document.getElementById("readyT")
// readyT.style.display ="none"

// var upcomingSV = document.getElementById("upcomingSV")
// upcomingSV.style.display ="none"

// var pendingT = document.getElementById("pendingT")
// pendingT.style.display ="none"

// var dispatchedT = document.getElementById("dispatchedT")
// dispatchedT.style.display ="none"

// var dispatchedT = document.getElementById("SVBContainer")
// dispatchedT.style.display ="none"

// var dispatchedT = document.getElementById("cost_holder")
// dispatchedT.style.display ="block"



}
function openSVB(){
var enquiries = document.getElementById("oContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pDContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("enquiryContainer")
enquiries.style.display ="none"

var readyT = document.getElementById("readyT")
readyT.style.display ="none"

var upcomingSV = document.getElementById("upcomingSV")
upcomingSV.style.display ="none"

var pendingT = document.getElementById("pendingT")
pendingT.style.display ="none"

var dispatchedT = document.getElementById("dispatchedT")
dispatchedT.style.display ="none"

var dispatchedT = document.getElementById("SVBContainer")
dispatchedT.style.display ="block"




}

function openPendingDocs(){
var dispatchedT = document.getElementById("SVBContainer")
dispatchedT.style.display ="none"

var enquiries = document.getElementById("pDContainer")
enquiries.style.display ="block"

var enquiries = document.getElementById("oContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("enquiryContainer")
enquiries.style.display ="none"

var readyT = document.getElementById("readyT")
readyT.style.display ="none"

var upcomingSV = document.getElementById("upcomingSV")
upcomingSV.style.display ="none"

var pendingT = document.getElementById("pendingT")
pendingT.style.display ="none"

var dispatchedT = document.getElementById("dispatchedT")
dispatchedT.style.display ="none"


}
function back(){
var dispatchedT = document.getElementById("SVBContainer")
dispatchedT.style.display ="none"

var enquiries = document.getElementById("enquiryContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("oContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pContainer")
enquiries.style.display ="none"

var enquiries = document.getElementById("pDContainer")
enquiries.style.display ="none"

var readyT = document.getElementById("readyT")
readyT.style.display ="block"

var upcomingSV = document.getElementById("upcomingSV")
upcomingSV.style.display ="block"

var pendingT = document.getElementById("pendingT")
pendingT.style.display ="block"

var dispatchedT = document.getElementById("dispatchedT")
dispatchedT.style.display ="block"

}
function setSupplies(pro,typee,supV){

  if(typee === "single"){

    var databaseR = firebase.database().ref(parentDatabase).child('projectNames').child(pro);
      var receivedDatabase = databaseR.update({

      supllies:supV,
     

      });
  }
}
//not in use
function correctDatess2(){

var projectForDesktop =getInputValue("email")
firebase.database().ref(parentDatabase).child("Web Supplies").child(projectForDesktop).child("Records").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var dat = childRecord.val().date;
      var childKey = childRecord.val().id;

      if(dat === "27-11-2024"){
        dat = "27-2-2024"
      }
      if(dat === "26-11-2024"){
        dat = "26-2-2024"
      }
      if(dat === "02-11-2024"){
        dat = "02-2-2024"
      }
    
      if(childKey === undefined){
        
      }
      else{
        var initDate = Date.parse("2124-12-31")
       
        var date = ((initDate - (Date.parse(dat.split("-").reverse().join("-"))))/100000);
    
        // alert(date)
         var databaseR = firebase.database().ref(parentDatabase).child("Web Supplies").child(projectForDesktop).child("Records").child(childKey);
          var receivedDatabase = databaseR.update({

           order: date,
         
           date: dat,
         

           })
       }

})
// phone

});
}
function getReadyT(pro,typee,supl){
  supKaunter = 0
var projectForDesktop =pro
firebase.database().ref(parentDatabase).child("Web Supplies").child(projectForDesktop).child("Records").orderByChild("order").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var Date = childRecord.val().date;
      var Item = childRecord.val().item;
      var supplier = childRecord.val().name.toUpperCase();
      var Quantity = childRecord.val().quantity.replaceAll(" ","");
      var tPrice = childRecord.val().total_price;
      var refNo = childRecord.val().reference;
      var id = childRecord.val().id;

      if(refNo === undefined){
        refNo = "N/A"
      }
      if(id === undefined){
        id = "NA"
      }
      if(parentDatabase ==="SEAHAWK"){
        if(supplier ==="SELF"){
          var supplier = parentDatabase
        }
      }
      
      addReadyToTable(Date,Item,supplier,Quantity,tPrice,refNo,typee,supl,pro,id);
      document.getElementById("projectIdentity").innerHTML ="My Projects/"+projectForDesktop
      

})
// phone

});
      getSiteV(parentDatabase,projectForDesktop);
      getPSVB(parentDatabase,projectForDesktop,supl,typee)
      getPendingT(parentDatabase,projectForDesktop);
      getDispatched(parentDatabase,projectForDesktop);
      getEnquiries(parentDatabase,projectForDesktop);
      // getPendingS(parentDatabase,projectForDesktop);
      getOU(parentDatabase,projectForDesktop);
      getENo(parentDatabase,projectForDesktop);
      
      // getDFC(parentDatabase,projectForDesktop);
      // getSVR(parentDatabase,projectForDesktop);

  var i = 0
  if (i == 0) {
    i = 1;
    var elem = document.getElementById("myBar");
    var width = 1;
    var id = setInterval(frame, 10);
    function frame() {
      if (width >= 100) {
        clearInterval(id);
        i = 0;
        // tbody.appendChild(trow);
        elem.style.width = 1 + "%";
     
        elem.style.display ="none"
        document.getElementById("list").style.display ="flex"
        document.getElementById("my_calendar_en").style.display ="block"
        document.getElementById("sites_in_project").style.display ="flex"
        document.getElementById("liner").style.display ="flex"
      } else {
        elem.style.display ="block"
        width++;
        elem.style.width = width + "%";
      
      }
    }
  }
}
function getSVR(parentDatabase,projectForDesktop){
var fld = document.getElementById("sVr")

var database = firebase.database().ref("SVRtot").once("value",
function(Snapshot){
var totalSVR = Snapshot.val().totR;

fld.innerHTML = "Site Visit Requests: "+totalSVR;
})
}
var supKaunter = 0
function addReadyToTable(Date,Item,supplier,Quantity,tPrice,refNo,typee,supl,pro,id){
var tbody = document.getElementById("tbodyReady");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var btn = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Dispatched";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";

td1.innerHTML = Date;
td2.innerHTML = Item.toUpperCase();
td3.innerHTML = supplier.toUpperCase();
td4.innerHTML = Quantity;
td5.innerHTML = "Ksh"+ Intl.NumberFormat('en-US').format(tPrice);
td6.innerHTML = refNo;
trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
// trow.appendChild(btn); myBar 
tbody.appendChild(trow);
supKaunter +=parseInt(tPrice)

var newAmount = parseInt(document.getElementById("supCounter").innerHTML)+parseInt(tPrice)
document.getElementById("supCounter").innerHTML = supKaunter
// newAmount
document.getElementById("supValue").innerHTML = Intl.NumberFormat('en-US').format(document.getElementById("supCounter").innerHTML)
document.getElementById("mainProjects").addEventListener("click",()=>{
  document.getElementById("supCounter").innerHTML = "0"
  trow.remove()
  var supV = document.getElementById("supValue").innerHTML
  setSupplies(pro,typee,supV)
})
// document.getElementById("list").style.display ="flex"2981950
// document.getElementById("my_calendar_en").style.display ="block"7604720 
// document.getElementById("projects_progress").style.display ="flex"
// document.getElementById("liner").style.display ="flex"
btn.addEventListener("click",()=>{
var phone = number;
var name =nme;

postT(phone,name,doc,d);
})
if(id !=="NA"){
  td1.title="Edit Date"
  td2.title="Edit Item"
  td3.title="Edit Supplier"
  td4.title="Edit Quantity"
  td5.title="Edit Cost"
  td6.title="Edit Ref"
  trow.style.cursor = "cell"
  td1.addEventListener("click",()=>{
    // alert("okay") 
    document.getElementById("optioner2").style.display ="block"
    document.getElementById("editor").value = Date
    document.getElementById("updaterText").innerHTML = td1.title
    document.getElementById("updater").addEventListener("click",()=>{

      document.getElementById("updaterText").style.display ="none"
      document.getElementById("updaterIcon").style.display ="block"
          keyy = "date"
          var vvalue = getInputValue("editor")
          if(vvalue !==""){
              updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
          }

    })
   
  })
  td2.addEventListener("click",()=>{
    // alert("okay") 
    document.getElementById("optioner2").style.display ="block"
    document.getElementById("editor").value = Item
    document.getElementById("updaterText").innerHTML = td2.title
    document.getElementById("updater").addEventListener("click",()=>{

      document.getElementById("updaterText").style.display ="none"
      document.getElementById("updaterIcon").style.display ="block"
          keyy = "item"
          var vvalue = getInputValue("editor")
          if(vvalue !==""){
              updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
          }

    })
   
  })
  td3.addEventListener("click",()=>{
    // alert("okay") 
    document.getElementById("optioner2").style.display ="block"
    document.getElementById("editor").value = supplier
    document.getElementById("updaterText").innerHTML = td3.title
    document.getElementById("updater").addEventListener("click",()=>{

      document.getElementById("updaterText").style.display ="none"
      document.getElementById("updaterIcon").style.display ="block"
          keyy = "name"
          var vvalue = getInputValue("editor")
          if(vvalue !==""){
              updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
          }

    })
   
  })
  td4.addEventListener("click",()=>{
    // alert("okay") 
    document.getElementById("optioner2").style.display ="block"
    document.getElementById("editor").value = Quantity
    document.getElementById("updaterText").innerHTML = td4.title
    document.getElementById("updater").addEventListener("click",()=>{

      document.getElementById("updaterText").style.display ="none"
      document.getElementById("updaterIcon").style.display ="block"
          keyy = "quantity"
          var vvalue = getInputValue("editor")
          if(vvalue !==""){
              updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
          }

    })
   
  })
  td5.addEventListener("click",()=>{
    // alert("okay") 
    document.getElementById("optioner2").style.display ="block"
    document.getElementById("editor").value = tPrice
    document.getElementById("updaterText").innerHTML = td5.title
    document.getElementById("updater").addEventListener("click",()=>{

      document.getElementById("updaterText").style.display ="none"
      document.getElementById("updaterIcon").style.display ="block"
          keyy = "total_price"
          var vvalue = getInputValue("editor")
          if(vvalue !==""){
              updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
          }

    })
   
  })
  td6.addEventListener("click",()=>{
    // alert("okay") 
    document.getElementById("optioner2").style.display ="block"
    document.getElementById("editor").value = refNo
    document.getElementById("updaterText").innerHTML = td6.title
    document.getElementById("updater").addEventListener("click",()=>{
      document.getElementById("updaterText").style.display ="none"
      document.getElementById("updaterIcon").style.display ="block"
          keyy = "reference"
          var vvalue = getInputValue("editor")
          if(vvalue !==""){
              updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
          }

    })
   
  })
}
else{
  trow.style.cursor = "not-allowed"
}


}
function updateSUpDetails(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro){
  var databaseR = firebase.database().ref(parentDatabase).child("Web Supplies").child(pro).child("Records").child(id);
  var receivedDatabase = databaseR.update({
  
    [keyy]:vvalue

  }).then(
    finishEditing(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro)
  )

}
function finishEditing(id,keyy,vvalue,td1,td2,td3,td4,td5,td6,pro){
  if(keyy =="date"){
    td1.innerHTML = vvalue
    td1.style.color ="red"
  }
  if(keyy =="item"){
    td2.innerHTML = vvalue
    td2.style.color ="red"
  }
  if(keyy =="name"){
    td3.innerHTML = vvalue
    td3.style.color ="red"
  }
  if(keyy =="quantity"){
    td4.innerHTML = vvalue
    td4.style.color ="red"
  }
  if(keyy =="total_price"){
    td5.innerHTML = vvalue
    td5.style.color ="red"
  }
  if(keyy =="reference"){
    td6.innerHTML = vvalue
    td6.style.color ="red"
  }
  document.getElementById("optioner2").style.display ="none"
  document.getElementById("updaterText").style.display ="block"
  document.getElementById("updaterIcon").style.display ="none"
}
function getPSVB(parentDatabase,projectForDesktop,supl,typee){
firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var cDate = childRecord.val().commencementDate;
      var pCost = childRecord.val().completionDate;
      var Contractor = childRecord.val().contractor;
      var Project = childRecord.val().project;
      var stName = childRecord.val().siteName;
      var Owner = childRecord.val().siteOwner;
      var sType = childRecord.val().structure;
      var cost = childRecord.val().projectCost;
      var Status = childRecord.val().status;

      // var pop = childRecord.val().Pop;
      // var phone = childRecord.val().Phone;window

      if(stName ==="FENCING"|stName ==="GARDENING"|stName ==="IRON WORKS"){
         
      }
      else{
          
      getLaborCost(cDate,pCost,Contractor,Project,stName,Owner,sType,projectForDesktop,cost,Status,supl,typee);
      }
  })

});
}
function getLaborCost(cDate,pCost,Contractor,Project,stName,Owner,sType,projectForDesktop,cost,Status,supl,typee){
  // alert(stName)Attendance
firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Labor Cost").once("value",
function(cTasks){
// cTasks.forEach(
//     function(childRecord){

      
      var lCostR = cTasks.val().wage;
      var lCost =parseFloat(lCostR).toFixed(2);
          
      getMaterialsCost(cDate,pCost,Contractor,Project,stName,Owner,sType,lCost,projectForDesktop,cost,Status,supl,typee);
     
  // }
  // )

});
}
function getMaterialsCost(cDate,pCost,Contractor,Project,stName,Owner,sType,lCost,projectForDesktop,cost,Status,supl,typee){
firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Materials Cost").once("value",
function(cTasks){
// cTasks.forEach(
//     function(childRecord){

      var totalConstCostR = cTasks.val().wage;
      var mCost =  parseFloat(totalConstCostR).toFixed(2);

      if(typee ==="single"){
        mCost = supKaunter
      }
          
      getLogisticsCost(cDate,pCost,Contractor,Project,stName,Owner,sType,lCost,mCost,projectForDesktop,cost,Status);
     
  // }
  // )

});
}
function getLogisticsCost(cDate,pCost,Contractor,Project,stName,Owner,sType,lCost,mCost,projectForDesktop,cost,Status){
firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Other Expenses").once("value",
function(cTasks){
// cTasks.forEach(
//     function(childRecord){

      var expCost = cTasks.val().wage;

      var totalConstCostR = parseFloat(expCost)+parseFloat(lCost)+parseFloat(mCost);
      let totalConstCost = totalConstCostR.toFixed(2);
          
      addSVBToTable(cDate,pCost,Contractor,Project,stName,Owner,sType,lCost,mCost,expCost,totalConstCost,projectForDesktop,cost,Status);
     
  // }
  // )

});
}
function addSVBToTable(cDate,pCost,Contractor,Project,stName,Owner,sType,lCost,mCost,expCost,totalConstCost,projectForDesktop,cost,Status){
var tbody = document.getElementById("tbodySVB");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8 = document.createElement("td");
var td9 = document.createElement("td");
var td10 = document.createElement("td");
var td11 = document.createElement("td");
var btn = document.createElement("button");
var btnCancel = document.createElement("button");
var btnEdit = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "9px";
btn.style.background = "red";
btn.style.color = "white";
btn.style.padding = "2px";

btnCancel.style.width = "50px";
btnCancel.style.height = "16px";
btnCancel.style.marginTop = "10px";
btnCancel.innerText = "Approve";
btnCancel.style.fontSize = "9px";
btnCancel.style.background = "green";
btnCancel.style.padding = "2px";
btnCancel.style.color = "white";

var prog = 50     
var   amountC = mCost//.replaceAll(",","")
var   lC = lCost.replaceAll(",","")

var   totC = parseInt(amountC)+parseInt(lCost)+parseInt(expCost)
// trow.style.backgroundColor ="#0225441e"
td11.style.color ="green"
td11.style.fontWeight = "bold"
td1.innerHTML = stName;
td2.innerHTML = Owner;
td3.innerHTML = sType;
td4.innerHTML = cDate;
td5.innerHTML = pCost
td6.innerHTML = "Ksh "+ Intl.NumberFormat('en-US').format(lCost);
td7.innerHTML = "Ksh "+ Intl.NumberFormat('en-US').format(amountC);
td8.innerHTML = "Ksh "+ Intl.NumberFormat('en-US').format(expCost);
td9.innerHTML = "Ksh "+ Intl.NumberFormat('en-US').format(totC);
td10.innerHTML= "Ksh "+ Intl.NumberFormat('en-US').format(cost)
td11.innerHTML = Status; //'<progress style=""id="file" value= "'+prog+'" max="100"> </progress>'+" "+ prog+"%"

trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8);
trow.appendChild(td9);
trow.appendChild(td10);
trow.appendChild(td11);
// trow.appendChild(btn);
// trow.appendChild(btnCancel);
tbody.appendChild(trow);

// document.getElementById("myBar").style.display ="none"


// var i = 0
// if (i == 0) {
//     i = 1;
//     var elem = document.getElementById("myBar");
//     var width = 1;
//     var id = setInterval(frame, 10);
//     function frame() {
//       if (width >= 100) {
//         clearInterval(id);
//         i = 0;
//         tbody.appendChild(trow);
//         elem.style.width = 1 + "%";
     
//         elem.style.display ="none"
//         document.getElementById("list").style.display ="flex"
//         document.getElementById("my_calendar_en").style.display ="block"
//         document.getElementById("projects_progress").style.display ="flex"
//         document.getElementById("liner").style.display ="flex"
//       } else {
//         elem.style.display ="block"
//         width++;
//         elem.style.width = width + "%";
      
//       }
//     }
//   }
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
document.getElementById("btnRecordSite").addEventListener("click",()=>{

      var name =      getInputValue("site_name")
      var owner     = getInputValue("s_owner")
      var structure = getInputValue("struct")
      var c_date =    getInputValue("c_date")
      var d_date =    getInputValue("d_date")
      var cost =      getInputValue("cost")

      if(name !==""&&owner!==""&&structure!==""&&c_date!==""&&d_date!==""&&cost!==""){
        trow.remove()
      }
  
})
btn.addEventListener("click",()=>{
deleteSVB(d);
})
trow.addEventListener("click",()=>{
document.getElementById("pageLabel").innerHTML = stName+" ACCOUNT"
loadDataForSingleProject(stName,totalConstCost,lCost,projectForDesktop)
loadOtherEx(stName,Owner)
loadLabor(stName,totalConstCost)
openSites()
// fetchWeekPayments()
document.getElementById("site_id").innerHTML = stName+" ("+Owner+")"
})


btnCancel.addEventListener("click",()=>{

var name = nme;
saveSV(date,pop,name,time,pNo,phone,d,email);
deleteSVB(d);

})
}
// totTot labTot
function loadDataForSingleProject(stName,totalConstCost,lCost,projectForDesktop){
  
firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Materials Used").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){
      var Item = childRecord.val().item;
      var Qty = childRecord.val().quantity;
      var amount = childRecord.val().wage;
      var unit = childRecord.val().unit;

      if(unit === undefined){
        unit = "Unit(s)"
      }

      addSiteDataToTable(Item,Qty,amount,unit)
     
      // addSiteDataToTable(Item,Qty,amount,Wage,exname,exAmnt,totalConstCost)

  })})
  // loadLabor(stName,Item,Qty,amount,totalConstCost)

}
function loadLabor(stName,totalConstCost){
  var projectForDesktop = getInputValue("email")

firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Labor Cost").once("value",
function(cTasks){

      
      var Wage = cTasks.val().wage;

     document.getElementById("labTot").innerText = "Total: Ksh "+ Intl.NumberFormat('en-US').format(Wage)
     document.getElementById("totTot").innerHTML = "(Ksh "+ Intl.NumberFormat('en-US').format(totalConstCost)+")"

  }).then(
    firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Materials Cost").once("value",
    function(cTasks){

      
      var Wage = cTasks.val().wage;

     document.getElementById("mateialsValue").innerText = "Total: Ksh "+ Intl.NumberFormat('en-US').format(coster)
     document.getElementById("totClienDeposit").innerHTML = "(Ksh "+ Intl.NumberFormat('en-US').format(totalConstCost)+")"

  })
  ).then(
    firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Other Expenses").once("value",
    function(cTasks){

      
      var Wage = cTasks.val().wage;

     document.getElementById("otherExpValue").innerText = "Total: Ksh "+ Intl.NumberFormat('en-US').format(Wage)
    //  document.getElementById("totClienDeposit").innerHTML = "(Ksh "+totalConstCost+")"

  })
  ).then(
    getWorkForce(stName)
  );
}

function getWorkForce(stName){
  var projectForDesktop = getInputValue("email")
        firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Worker").orderByChild("date").once("value",
        function(cTasks){
        cTasks.forEach(
          function(childRecord){

            var name = childRecord.val().name
            var date = childRecord.val().date
            var idR = childRecord.val().workID
            // alert(id)
          var id =  Intl.NumberFormat('en-US').format(idR)
          getWage(name,date,id)
          }
      

)});

}
function getWage(name,date,id){
  var projectForDesktop = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(projectForDesktop).child("14-3-2022").child(id).once("value",
  function(cTasks){
  

      var paid = id
    
    
  addWorkForceToTable(name,date,id,paid)
 });

}
countWorkers = 0;
function addWorkForceToTable(name,date,id,paid){
 
var tbody = document.getElementById("tbodyLabor");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");



                      

// td1.innerHTML = ++countWorkers; startSetting
td2.innerHTML = name;
td3.innerHTML = date;
td4.innerHTML ="Ksh "+ paid;


// trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);


tbody.appendChild(trow);
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
document.getElementById("l1").addEventListener("click",()=>{
  trow.remove()

})
document.getElementById("l1b").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l2").addEventListener("click",()=>{
  trow.remove()

})
document.getElementById("l3").addEventListener("click",()=>{
  trow.remove()

})
document.getElementById("l4").addEventListener("click",()=>{
  trow.remove()

})
document.getElementById("l5").addEventListener("click",()=>{
  trow.remove()

})


showsingleSiteDetails()

}
function loadOtherEx(stName,Owner){
  var projectForDesktop = getInputValue("email")

firebase.database().ref(parentDatabase).child("Constructions").child(projectForDesktop).child(stName).child("Other Expense List").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){
      
      var exAmntr = childRecord.val().amount;
      var exname = childRecord.val().item;
      var exAmnt = Intl.NumberFormat('en-US').format(exAmntr)
      addSiteExDataToTable(stName,exAmnt,exname,Owner)
     

  })})
}
function  addSiteExDataToTable(stName,exAmnt,exname,Owner){
var tbodyEx = document.getElementById("tbodyExps");
var trowEx = document.createElement("tr");
var td1Ex = document.createElement("td");
var td2Ex = document.createElement("td");
td1Ex.innerHTML = exname;
td2Ex.innerHTML =  "Ksh "+exAmnt
trowEx.appendChild(td1Ex);
trowEx.appendChild(td2Ex);
tbodyEx.appendChild(trowEx);

document.getElementById("mainProjects").addEventListener("click",()=>{
trowEx.remove()
})

document.getElementById("l1").addEventListener("click",()=>{
  trowEx.remove()

})
document.getElementById("l1b").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l2").addEventListener("click",()=>{
  trowEx.remove()

})
document.getElementById("l3").addEventListener("click",()=>{
  trowEx.remove()

})
document.getElementById("l4").addEventListener("click",()=>{
  trowEx.remove()

})
document.getElementById("l5").addEventListener("click",()=>{
  trowEx.remove()

})


}
var coster = 0
function addSiteDataToTable(Item,Qty,amount,unit){
var tbodyM = document.getElementById("tbodyMats");

var trow = document.createElement("tr");


var td1M = document.createElement("td");
var td2M = document.createElement("td");
var td3M = document.createElement("td");


td1M.innerHTML = Item;
td2M.innerHTML = Qty+" "+unit;
td3M.innerHTML = "Ksh "+ Intl.NumberFormat('en-US').format(amount);

trow.appendChild(td1M); 
trow.appendChild(td2M);
trow.appendChild(td3M);


tbodyM.appendChild(trow);
coster = coster+parseInt(amount)

// coster +=parseInt(amount1)

// var newAmount = parseInt(document.getElementById("supCounter").innerHTML)+parseInt(tPrice)
// document.getElementById("supCounter").innerHTML = coster

document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
coster = 0
})
document.getElementById("l1").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l1b").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l2").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l3").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l4").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})
document.getElementById("l5").addEventListener("click",()=>{
  trow.remove()
  coster = 0

})

}
function getSiteV(parentDatabase,projectForDesktop){
  var projectForDesktop = getInputValue("email")
firebase.database().ref(parentDatabase).child("Web Usages").child(projectForDesktop).child("Records").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var Date = childRecord.val().date;
      var Item = childRecord.val().item;
      var Qty = childRecord.val().quantity;
      var siteTo = childRecord.val().site_to;
      var cBy = childRecord.val().collector;
      var unit = childRecord.val().unit;
      // var email = childRecord.val().email;
      // var pop = childRecord.val().Pop;
      // var phone = childRecord.val().Phone;

      addSVToTable(Date,Item,Qty,siteTo,cBy,unit);
  })

});
}
function addSVToTable(Date,Item,Qty,siteTo,cBy,unit){
var tbody = document.getElementById("tbodySV");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var btn = document.createElement("button");
var btnCancel = document.createElement("button");
var btnEdit = document.createElement("button");




btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";

btnCancel.style.width = "50px";
btnCancel.style.height = "16px";
btnCancel.style.marginTop = "10px";
btnCancel.innerText = "Update";
btnCancel.style.fontSize = "9px";
btnCancel.style.background = "pink";
btnCancel.style.padding = "2px";

// btnEdit.style.width = "50px";
// btnEdit.style.height = "16px";
// btnEdit.style.marginTop = "10px";
// btnEdit.innerText = "Cancel";
// btnEdit.style.fontSize = "9px";
// btnEdit.style.background = "green";
// btnEdit.style.color = "white";
// btnEdit.style.padding = "2px";

// <td onclick="showAlert()">Date</td>
//                                <td>Time</td> 
//                                <td>Name</td>
//                                 <td>Project</td>
//                                 <td>Phone</td>
//                                 <td>Email</td>
//                                 <td>Pop</td>
//                                 <td>Action</td>

td1.innerHTML = Item.toUpperCase();
td2.innerHTML = Qty+" "+unit;
td3.innerHTML = cBy;
td4.innerHTML = siteTo;
td5.innerHTML = Date;
// td6.innerHTML = email;

// td6.innerHTML = pop;

trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
// trow.appendChild(td6);
// trow.appendChild(btn);
// trow.appendChild(btnCancel);

tbody.appendChild(trow);

// usCount +=parseInt(tPrice)


// document.getElementById("uValue").innerHTML =  Intl.NumberFormat('en-US').format(usCount)

document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
btn.addEventListener("click",()=>{
deleteSV(d);
})
}
var usCount = 0
var uCounter = 0
function getPendingT(parentDatabase,projectForDesktop){
firebase.database().ref(parentDatabase).child("Tools").child(projectForDesktop).once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var qty = childRecord.val().quantity;
      var nme = childRecord.val().name;
      var unit = childRecord.val().unit; 
      var tPrice = childRecord.val().unit_price;
      // var id = childRecord.val().id;
      // var rider = childRecord.val().Rider;
      // var d = childRecord.val().d;
      // var phone = childRecord.val().Phone;

      addToolsT(qty,nme,unit,tPrice);
  })

});
}
function addToolsT(qty,nme,unit,tPrice){
var tbody = document.getElementById("tbodyPending");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
// var td3 = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Received";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";



td1.innerHTML = nme;
td2.innerHTML = qty+" "+unit;
// td3.innerHTML =doc ;
// td4.innerHTML = id;
// td5.innerHTML = rider;


trow.appendChild(td1); 
trow.appendChild(td2);
// trow.appendChild(td3);
// trow.appendChild(td4);
// trow.appendChild(td5);

// trow.appendChild(btn);
// trow.appendChild(btnCancel);

tbody.appendChild(trow);
var price = parseInt(tPrice)*parseInt(qty)
uCounter +=parseInt(price)

// var newAmount = parseInt(document.getElementById("usageCounter").innerHTML)+parseInt(tPrice)
document.getElementById("usageValue").innerHTML =  Intl.NumberFormat('en-US').format(uCounter)

document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
uCounter = 0
})

btn.addEventListener("click",()=>{
var name = nme;
var contact = id;

saveReceived(doc,name,contact,d)
})
}
// ===========================
function correctPrices(){
  alert("Starting correction")
  var projectForDesktop = getInputValue("email")
firebase.database().ref(parentDatabase).child("Sites Stock").child(projectForDesktop).once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var Date = childRecord.val().date;
      var Item = childRecord.val().item;
      var lSup = childRecord.val().name;
      var unit = childRecord.val().unit;
      var Qty = childRecord.val().quantity;
      var uP = childRecord.val().unit_price;
   
     if(lSup == "TBC"){
      getPrices(projectForDesktop,Item)
     }
      
      
  })

});
}
function getPrices(projectForDesktop,Item) {
  firebase.database().ref(parentDatabase).child("Web Supplies").child(projectForDesktop).child("Records").orderByChild("item").equalTo(Item).once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var Date = childRecord.val().date;
      var Item = childRecord.val().item;
      var supplier = childRecord.val().name.toUpperCase();
      var Quantity = childRecord.val().quantity;
      var tPrice = childRecord.val().total_price;

      // var u_priceCorrected =(parseFloat(tPrice)/ (parseFloat( Quantity.match(/\d/g).join("")))).toFixed(2).toString()
      
      updatePrice(projectForDesktop,Item,supplier)

})

});
}
function updatePrice(projectForDesktop,Item,supplier){
  var databaseR = firebase.database().ref(parentDatabase).child("Sites Stock").child(projectForDesktop).child(Item);
            var receivedDatabase = databaseR.update({

            
     name:supplier,
           
            

  })
}
// ===========================Web

function getDispatched(parentDatabase,projectForDesktop){
  var projectForDesktop = getInputValue("email")
firebase.database().ref(parentDatabase).child("Sites Stock").child(projectForDesktop).once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var Date = childRecord.val().date;
      var Item = childRecord.val().item;
      var lSup = childRecord.val().name;
      var unit = childRecord.val().unit;
      var Qty = childRecord.val().quantity;
      var uP = childRecord.val().unit_price;
      // var pop = childRecord.val().Pop;
      // var phone = childRecord.val().Phone;

      var decimalStart=(Qty+unit).slice(Qty.search(/(\d+)/));
      var decimalEnd=decimalStart.search(/[^.0-9]/);
      var ExtractedNumber= decimalStart.slice(0,decimalEnd);

      // alert(ExtractedNumber)
      if(ExtractedNumber > 0){

         addDToT(Date,Item,lSup,Qty,uP,unit); 
      }
      else{
          // alert(decimalStart)
          
      }
      
  })

});
}
function addDToT(Date,Item,lSup,Qty,uP,unit){
var tbody = document.getElementById("tbodyDispatched");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
// var td3 = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");


btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Delivered";
btn.style.fontSize = "9px";
btn.style.background = "orange";
btn.style.color = "white";
btn.style.padding = "2px";


td1.innerHTML = Item.toUpperCase();
td2.innerHTML = Qty + unit;
td3.innerHTML = "Ksh"+uP;
td4.innerHTML = lSup;
td5.innerHTML = Date;
td6.innerHTML = `<i style="cursor: pointer;"title="Record usage for this material" class="fa fa-pencil" aria-hidden="true"></i>`


trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
// trow.appendChild(btn);
// trow.appendChild(btnCancel);

tbody.appendChild(trow);

var tPrice = parseInt(Qty)*parseInt(uP)
usCount +=parseInt(tPrice)


document.getElementById("uValue").innerHTML =  Intl.NumberFormat('en-US').format(usCount)

document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
usCount = 0
})

btn.addEventListener("click", ()=>
{
addToDelivered(id,date,nme,Tn,phone);
})
td6.addEventListener("click",()=>{
    document.getElementById("u_item").value = Item
    document.getElementById("unit").value = unit
    document.getElementById("u_price").value = uP
    document.getElementById("set_qty").value = Qty

    document.getElementById("rUsage").style.display ="block"
    document.getElementById("u_item").disabled = "true"
})



}
function addToDelivered(id,date,nme,Tn,phone){

var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate

var database = firebase.database().ref("Title Deeds").child("Delivered").child(id);
var delDatabase = database.update({

Datee:dat,
id:id,
name:nme,
tNo:Tn,
phone:phone

})
removeDispatched(id);
}
function removeDispatched(id){

firebase.database().ref("Title Deeds").child("Dispatched").child(id).remove();

// firebase.database().ref("Title Deeds").child("Received").child(d).remove() u counter = 0


firebase.database().ref('DispTot').once("value",
function(childRecord){


  var toR = childRecord.val().totR;

  intCRV = parseInt(toR);
  var intToRec = intCRV -1;

  if(intToRec < 0){

    var newReceived = "0";
  
    var databaseE= firebase.database().ref('DispTot');
              var receivedDatabase = databaseE.update({

                  totR:newReceived

              });
              
          
              alert("Record updated successfully")
              
          window.location.href ="dashboard.html"  

  }
  else{
    var newReceived = intToRec.toString();
  
    var databaseE= firebase.database().ref('DispTot');
              var receivedDatabase = databaseE.update({

                  totR:newReceived

              });
              
          
              alert("Record updated successfully")
              
          window.location.href ="dashboard.html"  
  }

})  


}

function getEnquiries(parentDatabase,projectForDesktop){

// var category = document.getElementById("WorkersCategory");
var projectForDesktop = getInputValue("email")

firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(projectForDesktop).child("14-3-2022").orderByChild("name").once("value",
function(cTasks){
  cTasks.forEach(
      function(childRecord){

          var Date = childRecord.val().date;
          var desig = childRecord.val().designation;
          var Id = childRecord.val().id;
          var locations = childRecord.val().location;
          var Name = childRecord.val().name;
          var Phone = childRecord.val().phone;
          var Project = childRecord.val().project;
          var Site = childRecord.val().site;
          var Type = childRecord.val().type;
          var Wage = childRecord.val().wage;
          var WorkID = childRecord.val().workID;

          // if(typeArray.includes(desig)){

          // }else{
          //   typeArray.push(desig)
          // }
          // alert(typeArray)
          addEtoT(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID);
          addEtoT2(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID);
      })
  
});


firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(projectForDesktop).child("14-3-2022").orderByChild("name").once("value",
function(cTasks){
  cTasks.forEach(
      function(childRecord){

          var Date = childRecord.val().date;
          var desig = childRecord.val().designation;
          var Id = childRecord.val().id;
          var locations = childRecord.val().location;
          var Name = childRecord.val().name;
          var Phone = childRecord.val().phone;
          var Project = childRecord.val().project;
          var Site = childRecord.val().site;
          var Type = childRecord.val().type;
          var Wage = childRecord.val().wage;
          var WorkID = childRecord.val().workID;
          // if(typeArray.includes(desig)){

          // }else{
          //   typeArray.push(desig)
          // }
          // alert(typeArray)
          addPermanentToT(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID);
          addPermanentToT2(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID);
      })
  
});

firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(projectForDesktop).child("14-3-2022").orderByChild("name").once("value",
function(cTasks){
  cTasks.forEach(
      function(childRecord){

          var Date = childRecord.val().date;
          var desig = childRecord.val().designation;
          var Id = childRecord.val().id;
          var locations = childRecord.val().location;
          var Name = childRecord.val().name;
          var Phone = childRecord.val().phone;
          var Project = childRecord.val().project;
          var Site = childRecord.val().site;
          var Type = childRecord.val().type;
          var Wage = childRecord.val().wage;
          var WorkID = childRecord.val().workID;
          // if(typeArray.includes(desig)){

          // }else{
          //   typeArray.push(desig)
          // }
          // alert(typeArray)
          addContractToTable(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID);
      })
  
});


}
function addEtoT(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID){
var tbody = document.getElementById("tbodyE");
var trow = document.createElement("tr");
var td1c = document.createElement("td");
var td2c = document.createElement("td");
var td3c = document.createElement("td");
var td4c = document.createElement("td");
var td5c = document.createElement("td");
var td6c = document.createElement("td");
var td7c = document.createElement("td");
var td8c = document.createElement("td");
var btn = document.createElement("button");
var cloker = document.createElement("i")
var editor = document.createElement("i")
var deleter = document.createElement("i")

// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");
btn.innerHTML =`<i class="fa fa-pencil" aria-hidden="true"></i>`
// btn.style.width = "50px";
// btn.style.height = "16px";
// btn.style.marginTop = "10px";
// btn.innerText = "Clear";
// btn.style.fontSize = "9px";
// btn.style.background = "red";
// btn.style.color = "white";
// btn.style.padding = "2px";
deleter.innerHTML = `<i title ="Delete entry" style="float: right; margin-left:5px;cursor:pointer; color:red" class="fa fa-trash" aria-hidden="true"></i>`
cloker.innerHTML ="<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark presesnt'>  "
editor.innerHTML = `<i style="float:right; margin-right:10px;color:blue; cursor:pointer;" title="Edit details" class="fa fa-pencil" aria-hidden="true"></i>`
td1c.innerHTML = Name ;
td2c.innerHTML = Id;
td3c.innerHTML = locations;
td4c.innerHTML = Phone;
td5c.innerHTML = Site;
td6c.innerHTML = desig;
td7c.innerHTML = Wage;

td8c.appendChild(deleter);
td8c.appendChild(cloker);
td8c.appendChild(editor);


trow.appendChild(td1c); 
trow.appendChild(td2c);
trow.appendChild(td3c);
trow.appendChild(td4c);
trow.appendChild(td5c);
trow.appendChild(td6c);
trow.appendChild(td7c);
trow.appendChild(td8c);

// trow.appendChild(btn);
// trow.appendChild(btnCancel);
editor.addEventListener("click",()=>{
  document.getElementById("editName").value  =""
      document.getElementById("editSubL").value  =""
      document.getElementById("editPhone").value =""
      document.getElementById("editSite").value  =""
      document.getElementById("editDesig").value =""
      document.getElementById("editWage").value  =""
      document.getElementById("editID").value  =""
      document.getElementById("editTyp").value =""
      document.getElementById("editPro").value  =""
  document.getElementById("editName").value  = Name
  document.getElementById("editSubL").value  = locations
  document.getElementById("editPhone").value = Phone
  document.getElementById("editSite").value  = Site
  document.getElementById("editDesig").value = desig
  document.getElementById("editWage").value  = Wage
  document.getElementById("editID" ).value  = Id
  document.getElementById("editTyp").value  = Type
  document.getElementById("editPro").value  = Project
  document.getElementById("editDetais").style.display ="block"

  document.getElementById("editWorker").addEventListener("click",()=>{

  var editName  = getInputValue("editName")
  var editSubL  = getInputValue("editSubL")
  var editPhone = getInputValue("editPhone")
  var editSite  = getInputValue("editSite")
  var editDesig = getInputValue("editDesig") 
  var editWage  = getInputValue("editWage")
 
  td1c.innerHTML = editName ;
  td3c.innerHTML = editSubL;
  td4c.innerHTML = editPhone;
  td5c.innerHTML = editSite;
  td6c.innerHTML = editDesig;
  td7c.innerHTML = editWage;

 

})
})


tbody.appendChild(trow);
cloker.addEventListener("click",()=>{

  if (confirm("Mark "+Name+" present?")) {

   recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase,trow)


} 
else {
 

}
  // alert(Id)
  // recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase)
})
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
btn.addEventListener("click",()=>{
deleteEnquiry(date);
})

}


function addEtoT2(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID){
var tbody = document.getElementById("tbodyE2");
var trow = document.createElement("tr");
var td1c = document.createElement("td");
var td2c = document.createElement("td");
var td3c = document.createElement("td");
var td4c = document.createElement("td");
var td5c = document.createElement("td");
var td6c = document.createElement("td");
var td7c = document.createElement("td");
var td8c = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");
btn.innerHTML =`<i class="fa fa-pencil" aria-hidden="true"></i>`
// btn.style.width = "50px";
// btn.style.height = "16px";
// btn.style.marginTop = "10px";
// btn.innerText = "Clear";
// btn.style.fontSize = "9px";
// btn.style.background = "red";
// btn.style.color = "white";
// btn.style.padding = "2px";

td1c.innerHTML = Name;
td2c.innerHTML = Id;
td3c.innerHTML = locations;
td4c.innerHTML = Phone;
td5c.innerHTML = Site;
td6c.innerHTML = desig;
td7c.innerHTML = Wage;
var cloker = document.createElement("i")
var editor = document.createElement("i")
var deleter = document.createElement("i")
deleter.innerHTML = `<i title ="Delete entry" style="float: right; margin-left:5px;cursor:pointer; color:red" class="fa fa-trash" aria-hidden="true"></i>`
cloker.innerHTML ="<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark presesnt'>  "
editor.innerHTML = `<i style="float:right; margin-right:10px;color:blue; cursor:pointer;" title="Edit details" class="fa fa-pencil" aria-hidden="true"></i>`
td8c.appendChild(deleter);
td8c.appendChild(cloker);
td8c.appendChild(editor);

trow.appendChild(td1c); 
trow.appendChild(td2c);
trow.appendChild(td3c);
trow.appendChild(td4c);
trow.appendChild(td5c);
trow.appendChild(td6c);
trow.appendChild(td7c);
trow.appendChild(td8c);
tbody.appendChild(trow);
// trow.appendChild(btn);
// trow.appendChild(btnCancel);
editor.addEventListener("click",()=>{
  document.getElementById("editName").value  =""
      document.getElementById("editSubL").value  =""
      document.getElementById("editPhone").value =""
      document.getElementById("editSite").value  =""
      document.getElementById("editDesig").value =""
      document.getElementById("editWage").value  =""
      document.getElementById("editID").value  =""
      document.getElementById("editTyp").value =""
      document.getElementById("editPro").value  =""
  document.getElementById("editName").value  = Name
  document.getElementById("editSubL").value  = locations
  document.getElementById("editPhone").value = Phone
  document.getElementById("editSite").value  = Site
  document.getElementById("editDesig").value = desig
  document.getElementById("editWage").value  = Wage
  document.getElementById("editID" ).value  = Id
  document.getElementById("editTyp").value  = Type
  document.getElementById("editPro").value  = Project
  document.getElementById("editDetais").style.display ="block"

  document.getElementById("editWorker").addEventListener("click",()=>{

  var editName  = getInputValue("editName")
  var editSubL  = getInputValue("editSubL")
  var editPhone = getInputValue("editPhone")
  var editSite  = getInputValue("editSite")
  var editDesig = getInputValue("editDesig") 
  var editWage  = getInputValue("editWage")
 
  td1c.innerHTML = editName ;
  td3c.innerHTML = editSubL;
  td4c.innerHTML = editPhone;
  td5c.innerHTML = editSite;
  td6c.innerHTML = editDesig;
  td7c.innerHTML = editWage;

 

})
})



cloker.addEventListener("click",()=>{

  if (confirm("Mark "+Name+" present?")) {

   recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase,trow)


} 
else {
 

}
  // alert(Id)
  // recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase)
})
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
btn.addEventListener("click",()=>{
deleteEnquiry(date);
})

}

function addPermanentToT2(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID){
var tbody = document.getElementById("tbodyPermanent2");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8c = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button"); Site Attendance
// var btnEdit = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "9px";
btn.style.background = "red";
btn.style.color = "white";
btn.style.padding = "2px";
var cloker = document.createElement("i")
var editor = document.createElement("i")
var deleter = document.createElement("i")
deleter.innerHTML = `<i title ="Delete entry" style="float: right; margin-left:5px;cursor:pointer; color:red" class="fa fa-trash" aria-hidden="true"></i>`
cloker.innerHTML ="<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark presesnt'>  "
editor.innerHTML = `<i style="float:right; margin-right:10px;color:blue; cursor:pointer;" title="Edit details" class="fa fa-pencil" aria-hidden="true"></i>`
td8c.appendChild(deleter);
td8c.appendChild(cloker);
td8c.appendChild(editor);
td1.innerHTML = Name 
td2.innerHTML = Id;
td3.innerHTML = locations;
td4.innerHTML = Phone;
td5.innerHTML = Site;
td6.innerHTML = desig;
td7.innerHTML = Wage;


trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8c);

// trow.appendChild(btn);
// trow.appendChild(btnCancel);
editor.addEventListener("click",()=>{
  
  document.getElementById("editNameIn").value  =""
      document.getElementById("editSubLIn").value  =""
      document.getElementById("editPhoneIn").value =""
      document.getElementById("editSiteIn").value  =""
      document.getElementById("editDesigIn").value =""
      document.getElementById("editWageIn").value  =""
      document.getElementById("editIDIn").value  =""
      document.getElementById("editTypIn").value =""
      document.getElementById("editProIn").value  =""
  document.getElementById("editNameIn").value  = Name
  document.getElementById("editSubLIn").value  = locations
  document.getElementById("editPhoneIn").value = Phone
  document.getElementById("editSiteIn").value  = Site
  document.getElementById("editDesigIn").value = desig
  document.getElementById("editWageIn").value  = Wage
  document.getElementById("editIDIn").value  = Id
  document.getElementById("editTypIn").value  = Type
  document.getElementById("editProIn").value  = Project
  document.getElementById("editDetais2").style.display ="block"
  // alert(document.getElementById("editIDIn").value)
  document.getElementById("editWorker2").addEventListener("click",()=>{
  var editName  = getInputValue("editNameIn")
  var editSubL  = getInputValue("editSubLIn")
  var editPhone = getInputValue("editPhoneIn")
  var editSite  = getInputValue("editSiteIn")
  var editDesig = getInputValue("editDesigIn") 
  var editWage  = getInputValue("editWageIn")
 
  td1c.innerHTML = editName 
  td3c.innerHTML = editSubL;
  td4c.innerHTML = editPhone;
  td5c.innerHTML = editSite;
  td6c.innerHTML = editDesig;
  td7c.innerHTML = editWage;


})
})
tbody.appendChild(trow);

cloker.addEventListener("click",()=>{
  // alert(Id)
  if (confirm("Mark "+Name+" present?")) {

             recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase,trow)


            } 
            else {
              

            }
})
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
btn.addEventListener("click",()=>{
deleteEnquiry(date);
})
}



function addPermanentToT(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID){
var tbody = document.getElementById("tbodyPermanent");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8c = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button"); Site Attendance
// var btnEdit = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "9px";
btn.style.background = "red";
btn.style.color = "white";
btn.style.padding = "2px";
var cloker = document.createElement("i")
var editor = document.createElement("i")
var deleter = document.createElement("i")
deleter.innerHTML = `<i title ="Delete entry" style="float: right; margin-left:5px;cursor:pointer; color:red" class="fa fa-trash" aria-hidden="true"></i>`
cloker.innerHTML ="<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark presesnt'>  "
editor.innerHTML = `<i style="float:right; margin-right:10px;color:blue; cursor:pointer;" title="Edit details" class="fa fa-pencil" aria-hidden="true"></i>`
td8c.appendChild(deleter);
td8c.appendChild(cloker);
td8c.appendChild(editor);
td1.innerHTML = Name ;
td2.innerHTML = Id;
td3.innerHTML = locations;
td4.innerHTML = Phone;
td5.innerHTML = Site;
td6.innerHTML = desig;
td7.innerHTML = Wage;


trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8c);

// trow.appendChild(btn);
// trow.appendChild(btnCancel);
editor.addEventListener("click",()=>{
  document.getElementById("editNameIn").value  =""
      document.getElementById("editSubLIn").value  =""
      document.getElementById("editPhoneIn").value =""
      document.getElementById("editSiteIn").value  =""
      document.getElementById("editDesigIn").value =""
      document.getElementById("editWageIn").value  =""
      document.getElementById("editIDIn").value  =""
      document.getElementById("editTypIn").value =""
      document.getElementById("editProIn").value  =""
  document.getElementById("editNameIn").value  = Name
  document.getElementById("editSubLIn").value  = locations
  document.getElementById("editPhoneIn").value = Phone
  document.getElementById("editSiteIn").value  = Site
  document.getElementById("editDesigIn").value = desig
  document.getElementById("editWageIn").value  = Wage
  document.getElementById("editIDIn").value  = Id
  document.getElementById("editTypIn").value  = Type
  document.getElementById("editProIn").value  = Project
  document.getElementById("editDetais2").style.display ="block"
  // alert(document.getElementById("editIDIn").value)
  document.getElementById("editWorker2").addEventListener("click",()=>{
  var editName  = getInputValue("editNameIn")
  var editSubL  = getInputValue("editSubLIn")
  var editPhone = getInputValue("editPhoneIn")
  var editSite  = getInputValue("editSiteIn")
  var editDesig = getInputValue("editDesigIn") 
  var editWage  = getInputValue("editWageIn")
 
  td1c.innerHTML = editName ;
  td3c.innerHTML = editSubL;
  td4c.innerHTML = editPhone;
  td5c.innerHTML = editSite;
  td6c.innerHTML = editDesig;
  td7c.innerHTML = editWage;


 
})
})
tbody.appendChild(trow);

cloker.addEventListener("click",()=>{
  // alert(Id)
  if (confirm("Mark "+Name+" present?")) {

             recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase,trow)


            } 
            else {
              

            }
})
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
btn.addEventListener("click",()=>{
deleteEnquiry(date);
})
}


function addContractToTable(locations,Date,desig,Id,Name,Phone,Project,Site,Type,Wage,WorkID){
var tbody = document.getElementById("tbodyContract");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8c = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "9px";
btn.style.background = "red";
btn.style.color = "white";
btn.style.padding = "2px";

var cloker = document.createElement("i")
var editor = document.createElement("i")
var deleter = document.createElement("i")
deleter.innerHTML = `<i title ="Delete entry" style="float: right; margin-left:5px;cursor:pointer; color:red" class="fa fa-trash" aria-hidden="true"></i>`
// cloker.innerHTML ="<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark presesnt'>  "
editor.innerHTML = `<i style="float:right; margin-right:10px;color:blue; cursor:pointer;" title="Edit details" class="fa fa-pencil" aria-hidden="true"></i>`
td8c.appendChild(deleter);
// td8c.appendChild(cloker);
td8c.appendChild(editor);
td1.innerHTML = Name;
td2.innerHTML = Id;
td3.innerHTML = locations;
td4.innerHTML = Phone;
td5.innerHTML = Site;
td6.innerHTML = desig;
td7.innerHTML = Wage;
// td8c.innerHTML = "<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark presesnt'>  ";


trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8c);

// trow.appendChild(btn);
// trow.appendChild(btnCancel);

tbody.appendChild(trow);
// td8c.addEventListener("click",()=>{

// if (confirm("Mark "+Name+" present?")) {

// //  recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase,trow)


// } 
// else {


// }
// // alert(Id)
// // recordStaff2(Name,locations,Phone,Site,desig,Wage,Id,Type,Project,td8c,parentDatabase)
// })
document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
})
btn.addEventListener("click",()=>{
deleteEnquiry(date);
})
}

var projectForDesktop = getInputValue("email")
function getPendingS(){

  

// const day =getInputValue("weeksDateDate")
// const mon =getInputValue("weeksDateMonth")
// const yr =getInputValue("weeksDateYear")

// const wID = day+"-"+mon+"-"+yr
var projectForDesktop = getInputValue("email")
var rawwID =getInputValue("dateAtendance")
var revwID = rawwID.replaceAll("/","-")
var wID = revwID.split('-').reverse().join('-')

var fullDate = wID.split("-")
var day = fullDate[0]
var month = fullDate[1]
var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")
 
  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")
 
  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  var wID = day +"-"+month+"-"+year
  // alert(projectForDesktop)

firebase.database().ref(parentDatabase).child("Attendance").child(projectForDesktop).child("Dates").child(wID).orderByChild("name").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){
      if(childRecord.exists()){
          var id = childRecord.val().workID;
          var nme = childRecord.val(). name;
          var locations = childRecord.val().location;
          var mon = childRecord.val(). Monday;
          var tue = childRecord.val().Tuesday;
          var wed = childRecord.val().Wednesday;
          var thur = childRecord.val().Thursday;
          var fri = childRecord.val().Friday;
          var sat = childRecord.val().Saturday;
          var sun = childRecord.val().Sunday;
          
          // var desc = childRecord.val().Description;
          // var phone = childRecord.val().Phone;
        if(sun !="" || mon !=""|| tue !=""|| wed !=""|| thur !=""|| fri !=""|| sat !=""){
          addPSTT(locations,id,nme,mon,tue,wed,thur,fri,sat,sun,wID);
        }

          
      }
      else{
          window.alert("No record found for "+wID)
      }

      
  })

});
}

var stateOfView = ""
var countAttendance = 0
function addPSTT(locations,id,nme,mon,tue,wed,thur,fri,sat,sun,wID){
var tbody = document.getElementById("tbodyPS");
var trowAtt = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8 = document.createElement("td");
var td9 = document.createElement("td");
var td10 = document.createElement("td");
var iconSect = document.createElement("i");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button");btnView
// var btnEdit = document.createElement("button");
const btnReload = document.getElementById("btnViewAt");
iconSect.innerHTML = "<img src='clock.png' style='display: inline;'>"

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Done";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";



td1. innerHTML =   "<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark as presesnt'>  "+nme;
td2. innerHTML =   id;
td3. innerHTML =   locations;
if(sun ==="Present"){
  td4.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td4.innerHTML =   sun;
}
if(mon ==="Present"){
  td5.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td5.innerHTML =   mon;
}
if(tue ==="Present"){
  td6.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td6.innerHTML =   tue;
}
if(wed ==="Present"){
  td7.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td7.innerHTML =   wed;
}
if(thur ==="Present"){
  td8.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td8.innerHTML =   thur;
}
if(fri ==="Present"){
  td9.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td9.innerHTML =   fri;
}
if(sat ==="Present"){
  td10.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
}
else{
  td10.innerHTML =   sat;
}

// td10.innerHTML = "<img src='clock.png' style='display: inline; height: 15px; cursor:pointer'>";



trowAtt.appendChild(td1); 
trowAtt.appendChild(td2);
trowAtt.appendChild(td3);
trowAtt.appendChild(td4);
trowAtt.appendChild(td5);
trowAtt.appendChild(td6);
trowAtt.appendChild(td7);
trowAtt.appendChild(td8);
trowAtt.appendChild(td9);

trowAtt.appendChild(td10);
// trowAtt.appendChild(btnCancel);main

tbody.appendChild(trowAtt);
++countAttendance
document.getElementById("attenCounter").innerHTML = countAttendance


// document.getElementById("su").addEventListener("mouseover",()=>{
//   document.getElementById("sunAll").style.display = "block"
// })
// document.getElementById("su").addEventListener("mouseout",()=>{
//   document.getElementById("sunAll").style.display = "none"
// })

// document.getElementById("m1").addEventListener("mouseover",()=>{
//   document.getElementById("m1All").style.display = "block"
// })
// document.getElementById("m1").addEventListener("mouseout",()=>{
//   document.getElementById("m1All").style.display = "none"
// })
// document.getElementById("t1").addEventListener("mouseover",()=>{
//   document.getElementById("t1All").style.display = "block"
// })
// document.getElementById("t1").addEventListener("mouseout",()=>{
//   document.getElementById("t1All").style.display = "none"
// })
// document.getElementById("w1").addEventListener("mouseover",()=>{
//   document.getElementById("w1All").style.display = "block"
// })
// document.getElementById("w1").addEventListener("mouseout",()=>{
//   document.getElementById("w1All").style.display = "none"
// })
// document.getElementById("t2").addEventListener("mouseover",()=>{
//   document.getElementById("t2All").style.display = "block"
// })
// document.getElementById("t2").addEventListener("mouseout",()=>{
//   document.getElementById("t2All").style.display = "none"
// })
// document.getElementById("f1").addEventListener("mouseover",()=>{
//   document.getElementById("f1All").style.display = "block"
// })
// document.getElementById("f1").addEventListener("mouseout",()=>{
//   document.getElementById("f1All").style.display = "none"
// })
// document.getElementById("s1").addEventListener("mouseover",()=>{
//   document.getElementById("s1All").style.display = "block"
// })
// document.getElementById("s1").addEventListener("mouseout",()=>{
//   document.getElementById("s1All").style.display = "none"
// })

document.getElementById("f1All").addEventListener("click",()=>{
  var pickedDay = "Friday"
  document.getElementById("f1All").style.color ="green"
  startAtomic(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
})
  if(sun !==""){
    td4.title ="Revert to absent"
    td4.style.cursor ="pointer"
    td4. addEventListener("click",()=>{
  // trowAtt.remove()
  if(td4.title !== "Reload register first"){
    if (confirm(nme+" will be marked as absent on Sunday")) {
      var pickedDay = "Sunday"
      td1.innerHTML ="Loading..."
      td1.style.color ="red"
      td4.innerHTML =""
      var sun =""
    revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
    //  td4. addEventListener("click",()=>{})
        
    } else {

    }
  }
    
  })
  }
  else{
    document.getElementById("sunAll").style.color ="gray"
    document.getElementById("sunAll").title ="Mark all"
    td4.title ="Mark present for Sunday"
    td4.style.cursor ="copy"
    td4. addEventListener("click",()=>{
      if(td4.title !== "Reload register first"){

    var pickedDay = "Sunday"
    
    if( td4.innerHTML =="Loading..."){

    }
    else{
        if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
        
          td4.innerHTML ="Loading..."
          td4.style.color ="red"
          sun = "Present"
          startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
          
        } else {
          if(sun ==="Present"){
            td4.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
          }
          else{
            td4.innerHTML =   sun;
          }
          
          // td1.style.color ="black"
        }
    }
  }})

  }




if(mon !==""){
  td5.title ="Revert to absent"
  td5.style.cursor ="pointer"
  td5. addEventListener("click",()=>{
    if(td5.title !== "Reload register first"){

if (confirm(nme+" will be marked  as absent on Monday")) {
  td1.innerHTML="Loading..."
  var pickedDay = "Monday"
  td1.style.color ="red"
  td5.innerHTML=""
  var mon =""
    // trowAtt.remove()
 revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
//  td5. addEventListener("click",()=>{})
    
} else {

}
}})

}
else{
   document.getElementById("m1All").style.color ="gray"
    document.getElementById("m1All").title ="Mark all"
 td5.title ="Mark present for Monday"
 td5.style.cursor ="copy"
  td5. addEventListener("click",()=>{
    if(td5.title !== "Reload register first"){
        var pickedDay = "Monday"

        if( td5.innerHTML =="Loading..."){

        }
        else{
            if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
            
              td5.innerHTML ="Loading..."
              td5.style.color ="red"
              startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
              
            } else {
              if(mon ==="Present"){
                td5.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
              }
              else{
                td5.innerHTML =   mon;
              }
              
              // td1.style.color ="black"
            }
        }
}})

}
if(tue !==""){
  td6.title ="Revert to absent"
  td6.style.cursor ="pointer"
  td6. addEventListener("click",()=>{

    if(td6.title !== "Reload register first"){
 
      if (confirm(nme+" will be marked  as absent on Tuesday")) {
        var pickedDay = "Tuesday"
        td1.innerHTML="Loading..."
        td1.style.color ="red"
        td6.innerHTML=""
        var tue =""
          // trowAtt.remove()
        revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
        // td6. addEventListener("click",()=>{})
          
      } else {

      }
      }})
}
else{
   document.getElementById("t1All").style.color ="gray"
    document.getElementById("t1All").title ="Mark all"
td6.title ="Mark present for Tuesday"
td6.style.cursor ="copy"
td6. addEventListener("click",()=>{
  if(td6.title !== "Reload register first"){
      var pickedDay = "Tuesday"

      if( td6.innerHTML =="Loading..."){

      }
      else{
        if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
        
          td6.innerHTML ="Loading..."
          td6.style.color ="red"
          startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
          
        } else {
          if(tue ==="Present"){
              td6.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
            }
            else{
              td6.innerHTML =   tue;
            }
        
          // td1.style.color ="black"
        }
    }
}
})

}
if(wed !==""){  
  td7.title ="Revert to absent"
  td7.style.cursor ="pointer"
  td7. addEventListener("click",()=>{
    if(td7.title !== "Reload register first"){

  if (confirm(nme+" will be marked  as absent on Wednesday")) {
  
    var pickedDay = "Wednesday"
    td1.innerHTML="Loading..."
    td1.style.color ="red"
    td7.innerHTML=""
    var wed =""
    // trowAtt.remove()
   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10) 
  //  td7. addEventListener("click",()=>{})
} else {

}
}})
  
}
else{
   document.getElementById("w1All").style.color ="gray"
    document.getElementById("w1All").title ="Mark all"
td7.title ="Mark present for Wednesday"
td7.style.cursor ="copy"
td7. addEventListener("click",()=>{
  if(td7.title !== "Reload register first"){
var pickedDay = "Wednesday"

if( td7.innerHTML =="Loading..."){

}
else{
  if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
  
    td7.innerHTML ="Loading..."
    td7.style.color ="red"
    startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
    
  } else {
    if(wed ==="Present"){
      td7.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
    }
    else{
      td7.innerHTML =   wed;
    }
    
    // td1.style.color ="black"
  }
}
}})

}
if(thur !==""){
  td8.title ="Revert to absent"
  td8.style.cursor ="pointer"
  td8. addEventListener("click",()=>{
    if(td8.title !== "Reload register first"){

  if (confirm(nme+" will be marked  as absent on Thursday")) {
    var pickedDay = "Thursday"
    td1.innerHTML="Loading..."
    td1.style.color ="red"
    td8.innerHTML=""
    var thur =""
      // trowAtt.remove()
   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
  //  td8. addEventListener("click",()=>{})
      
  } else {

  }
}})
}
else{
   document.getElementById("t2All").style.color ="gray"
    document.getElementById("t2All").title ="Mark all"
td8.title ="Mark present for Thursday"
td8.style.cursor ="copy"
td8. addEventListener("click",()=>{
  if(td8.title !== "Reload register first"){
var pickedDay = "Thursday"

if( td8.innerHTML =="Loading..."){

}
else{
  if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
  
    td8.innerHTML ="Loading..."
    td8.style.color ="red"
    startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
    
  } else {
    if(thur ==="Present"){
        td8.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
      }
      else{
        td8.innerHTML =   thur;
      }
    
    // td1.style.color ="black"
  }
}
}})

}
if(fri !==""){
  td9.title ="Revert to absent"
  td9.style.cursor ="pointer"
  td9. addEventListener("click",()=>{
    if(td9.title !== "Reload register first"){
  
  if (confirm(nme+" will be marked  as absent on Friday")) {
    var pickedDay = "Friday"
    td1.innerHTML="Loading..."
    td1.style.color ="red"
    td9.innerHTML=""
    var fri =""
      // trowAtt.remove()
   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
  //  td9. addEventListener("click",()=>{})
      
  } else {

  }
}})
}
else{
   document.getElementById("f1All").style.color ="gray"
    document.getElementById("f1All").title ="Mark all"
td9.style.cursor ="copy"
td9.title ="Mark present for Friday"
td9. addEventListener("click",()=>{
  if(td9.title !== "Reload register first"){
    var pickedDay = "Friday"

    if( td9.innerHTML =="Loading..."){

    }
    else{
      if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
      
        td9.innerHTML ="Loading..."
        td9.style.color ="red"
        startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
        
      } else {
      
        if(fri ==="Present"){
          td9.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
        }
        else{
          td9.innerHTML =   fri;
        }

        // td1.style.color ="black"
      }
    }
}})

}
if(sat !==""){
  td10.title ="Revert to absent"
  td10.style.cursor ="pointer"
  td10.addEventListener("click",()=>{
    if(td10.title !== "Reload register first"){
  if (confirm(nme+" will be marked as absent on Saturday")) {
      var pickedDay = "Saturday"
      td1.innerHTML ="Loading..."
      td1.style.color ="red"
      var sat =""
      td10.innerHTML=""
      // trowAtt.remove()
      revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
      // td10. addEventListener("click",()=>{})
      
    } else {

    }
}})
}
else{ 
  document.getElementById("s1All").style.color ="gray"
    document.getElementById("s1All").title ="Mark all"
  td10.style.cursor ="copy"
  td10.title ="Mark present for Saturday"

  td10. addEventListener("click",()=>{
    if(td10.title !== "Reload register first"){
    var pickedDay = "Saturday"

    if( td10.innerHTML =="Loading..."){

    }
    else{
      if (confirm("Mark "+nme+" as present on " +pickedDay+"?")) {
      
        td10.innerHTML ="Loading..."
        td10.style.color ="red"
        startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)
        
      } else {
        if(sat ==="Present"){
          td10.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`;
        }
        else{
          td10.innerHTML =   sat;
        }
      
        // td1.style.color ="black"
      }
    }
    }})

}


document.getElementById("mainProjects").addEventListener("click",()=>{
  countAttendance = 0
  document.getElementById("attenCounter").innerHTML = 0
trowAtt.remove()
})

// btnReload.innerHTML = "RELOAD"

td1.addEventListener("click",()=>{
  // if( td1.innerHTML =="Loading..."){

  // }
  // else{
  //     if (confirm("Mark "+nme+" of ID: "+id+" as present?")) {
      
  //       td1.innerHTML ="Loading..."
  //       td1.style.color ="red"
  //       startRegisteringSingle(id,tbody,td1,nme)
        
  //     } else {
       
  //       td1.innerHTML =   "<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark as presesnt'>  "+nme;
  //       td1.style.color ="black"
  //     }
  // }
 
  

})
document.getElementById("btnViewAt").addEventListener('click',() => {
          
  countAttendance = 0
  document.getElementById("attenCounter").innerHTML = 0
          trowAtt.remove();
          })

btn.addEventListener("click",()=>{

var name = nme;
var contact = phone;

saveSent(doc,name,contact,d);
})
}

function startAtomic(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt){
  var pro = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Attendance").child(pro).child("Dates").child(wID).orderByChild("name").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){
      if(childRecord.exists()){
        startRegisteringSingle(id,tbody,td4,td5,td6,td7,td8,td9,td10,nme,pickedDay,wID,td1,trowAtt)

      }})})
}
function revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10){

  var pro = getInputValue("email")
  
  firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id).child(pickedDay).once("value",
  function(cTasks){
    var dayRate = cTasks.val()
    updateAtt2(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)

  })
 
}
function  updateAtt2(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10){

   var databaseR = firebase.database().ref(parentDatabase).child("Attendance").child(pro).child("Dates").child(wID).child(id);
            var receivedDatabase = databaseR.update({

            
            [pickedDay]:""
          

        }).then(
          updatePaymentReverted(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
        )
}
function  updatePaymentReverted(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10){
  var database = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id).once("value",
        function(Snapshot){

            var new_wage = (parseInt(Snapshot.val().wage)-parseInt(dayRate));

                var databaseR = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id);
                var receivedDatabase = databaseR.update({  


                [pickedDay]:"0",
                wage:new_wage
            

                }).then(

                  substructLabor(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
                   
                    
                    // getPendingS()
                );

        });
       
}
function substructLabor(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10){
  var userID = id
 
   var pro = getInputValue("email")


          var database = firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").child(userID).once("value",
          function(Snapshot){
          

          
                if(Snapshot.exists()){
                     
                      var site = Snapshot.val(). site;
                      substructLabor2(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10,site)             

                }
                else{

                  var database = firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").child(userID).once("value",
                  function(Snapshot){
                    

                    
                        if(Snapshot.exists()){
                          var site = Snapshot.val(). site;
                          substructLabor2(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10,site)             

                        }
                        else{
                          var database = firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").child(userID).once("value",
                          function(Snapshot){
                        

                          
                                if(Snapshot.exists()){
                                  var site = Snapshot.val(). site;                             
                                  substructLabor2(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10,site)  
                                }
                          
                          
          
                            })
                          

                        }
                        
                    
          
                  })
                  

                }
    
          
          })
      

   
}

function substructLabor2(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10,site){ 
    var database = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(site).child("Labor Cost").once("value",
        function(Snapshot){
            var newS = Snapshot.val().wage
            // alert(newS)
          
            var newCost = (parseInt(Snapshot.val().wage)-parseInt(dayRate)).toFixed(0).toString()

           
          
                    var databaseR = firebase.database().ref(parentDatabase).child("Constructions").child(pro).child(site).child("Labor Cost");
                    var receivedDatabase = databaseR.update({
                    

                    wage:newCost,
                    

                    }).then(
                      finishRevert(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10)
                     
                   
                    
                        
                     );

          
            
         
        });
   
    }
function finishRevert(pickedDay,id,wID,td1,pro,dayRate,nme,trowAtt,td4,td5,td6,td7,td8,td9,td10){
  var day = pickedDay
  td1.innerHTML =   "<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark as presesnt'>  "+nme,
  stateOfView = "Reload register first"

  if(day =="Sunday"){
      // td4.style.color ="black"
      // td4.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
      td4.title ="Reload register first"
      td4.style.cursor ="not-allowed"
      td4. addEventListener("click",()=>{
    // trowAtt.remove()
      // if (confirm(nme+" will be marked absent on this week's register")) {
      //   var pickedDay = "Sunday"
      //   td1.innerHTML ="Loading..."
      //   td1.style.color ="red"
      //   td4.innerHTML =""
      //   var sun =""
      //   var pickedDay = day
      //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
      // //  td4. addEventListener("click",()=>{})
          
      // } else {

      // }
    })
  }
  if(day =="Monday"){
    // td5.style.color ="black"
    // td5.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td5.title ="Reload register first"
    td5.style.cursor ="not-allowed"
    td5. addEventListener("click",()=>{


  //   if (confirm(nme+" will be marked as absent on Monday")) {
  //     td1.innerHTML="Loading..."
  //     var pickedDay = "Monday"
  //     td1.style.color ="red"
  //     td5.innerHTML=""
  //     var mon =""
  //       // trowAtt.remove()
  //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
  //   //  td5. addEventListener("click",()=>{})
        
  //   } else {

  // }
})
  }
  if(day =="Tuesday"){
    // td6.style.color ="black"
    // td6.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`

    td6.title ="Reload register first"
    td6.style.cursor ="not-allowed"
    td6. addEventListener("click",()=>{
    
    // if (confirm(nme+" will be marked as absent on Tuesday")) {
    //   var pickedDay = "Tuesday"
    //   td1.innerHTML="Loading..."
    //   td1.style.color ="red"
    //   td6.innerHTML=""
    //   var tue =""
    //     // trowAtt.remove()
    //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
    //   // td6. addEventListener("click",()=>{})
        
    // } else {

    // }
    })
  }
  if(day =="Wednesday"){
    // td7.style.color ="black"
    // td7.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td7.title ="Reload register first"
    td7.style.cursor ="not-allowed"
    td7. addEventListener("click",()=>{
    // var pickedDay = "Wednesday"
    // if (confirm(nme+" will be marked as absent on  Wednesday")) {
    
      
    //   td1.innerHTML="Loading..."
    //   td1.style.color ="red"
    //   td7.innerHTML=""
    //   var wed =""
    //   // trowAtt.remove()
    // revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt) 
    // //  td7. addEventListener("click",()=>{})
    // } else {

    // }
   })
  }
  if(day =="Thursday"){
    // td8.style.color ="black"
    // td8.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td8.title ="Reload register first"
    td8.style.cursor ="not-allowed"
    td8. addEventListener("click",()=>{
    

    // if (confirm(nme+" will be marked as absent on Thursaday")) {
    //   var pickedDay = "Thursday"
    //   td1.innerHTML="Loading..."
    //   td1.style.color ="red"
    //   td8.innerHTML=""
    //   var thur =""
    //     // trowAtt.remove()
    //   revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
    // //  td8. addEventListener("click",()=>{})
        
    //   } else {

    //   }
    })
  }
  if(day =="Friday"){
    // td9.style.color ="black"
    // td9.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`
    td9.title ="Reload register first"
    td9.style.cursor ="not-allowed"
    td9. addEventListener("click",()=>{
      
      // if (confirm(nme+" will be marked as absent on Friday")) {
      //   var pickedDay = "Friday"
      //   td1.innerHTML="Loading..."
      //   td1.style.color ="red"
      //   td9.innerHTML=""
      //   var fri =""
      //     // trowAtt.remove()
      // revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
      // //  td9. addEventListener("click",()=>{})
          
      // } else {

      // }
    })

  }
  if(day =="Saturday"){
    // td10.style.color ="black"
    // td10.innerHTML =   `<i style="color:green; font-size:14px; text-align:center;" class="fa fa-check" aria-hidden="true"></i>`

    td10.title ="Reload register first"
    td10.style.cursor ="not-allowed"
    td10.addEventListener("click",()=>{
    
    // if (confirm(nme+" will be marked as absent on Saturday")) {
    //     var pickedDay = "Saturday"
    //     td1.innerHTML ="Loading..."
    //     td1.style.color ="red"
    //     var sat =""
    //     td10.innerHTML=""
    //     // trowAtt.remove()
    //     revertToAbsent(pickedDay,id,wID,td1,nme,trowAtt)
    //     // td10. addEventListener("click",()=>{})
        
    //   } else {

    //   }
    })
  }

}
function up(){
  var database = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date).once("value",
        function(Snapshot){
                
            if(Snapshot.exists()){
                var newS = Snapshot.val().wage
               
                var wwage2 = (parseInt(newS)+parseInt(wage)).toFixed(0)
                // alert(parseInt(wwage2))start
            }
            else{
              var wwage2 = wage
            }
            
            
            //
                    var databaseR = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date);
                    var receivedDatabase = databaseR.update({
                    

                    wage:wwage2
                    

                    }).then(
                      td1.style.color ="black",
                      td1.innerHTML =   "<img src='clock.png' id='clocker' style='display: inline; height: 10px; cursor:pointer' title='Mark as presesnt'>  "+nme,
                      document.getElementById("loader").style.display = "none",
                      document.getElementById("okSpan").style.display = "block",
                      document.getElementById("btnClock").disabled = false,
                      document.getElementById("idNumber").value = "",
                       alert(nme +" successfully marked present for "+day)
                        
                     );

          // 179600
            
         
        });
   
}
function openDaySelector(){

  if (confirm("Do you want to mark register for a day different from today?")) {
     
     document.getElementById("daySelectorH").style.display ="block"
     document.getElementById("closeSel").style.display ="block"
     document.getElementById("openSel").style.display ="none"
     
    } else {
      
      
    }
 
//  var span = document.getElementsByClassName("close")[0];
//  span.onclick = function() {
//   modal.style.display = "none";
// }
//   modal.style.display = "block";
}

function closeDaySelector(){

  if (confirm("End marking register for a different day and set day to today?")) {
     
      document.getElementById("daySelectorH").style.display ="none"
      document.getElementById("closeSel").style.display ="none"
      document.getElementById("openSel").style.display ="block"
      document.getElementById("selectedDay").value =""
     
 } else {
   
   
 }

// alert(document.getElementById("selectedDay").value)

}

function getOU(parentDatabase,projectForDesktop){
firebase.database().ref("Office Updates").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){

      var descr = childRecord.val().Desc;
      var date = childRecord.val().date;
      // var nme = childRecord.val().name;
      // var doc = childRecord.val().Doc;
      // var media = childRecord.val().media;
      // var phone = childRecord.val().phone;
      // var desc = childRecord.val().Description;
      // var phone = childRecord.val().Phone;

      addOUTT(descr,date);
  })

});
}
var  UpdateNo = 0;
function addOUTT(descr,date){
var tbody = document.getElementById("tbodyOU");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
// var td3 = document.createElement("td");
// var td4 = document.createElement("td");
// var td5 = document.createElement("td");
// var td6 = document.createElement("td");
var btn = document.createElement("button");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Seen";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";



td1.innerHTML = ++UpdateNo +" "+descr;

// td3.innerHTML = nme;
// td4.innerHTML = phone;
// td5.innerHTML = media;
// td6.innerHTML = desc;


trow.appendChild(td1); 

// trow.appendChild(td3);
// trow.appendChild(td4);
// trow.appendChild(td5);
// trow.appendChild(td6);getWee

trow.appendChild(btn);
// trow.appendChild(btnCancel);

tbody.appendChild(trow);

btn.addEventListener('click',() => {
//   alert(admision +" "+classs);
deleteOU(date);
      // modal.style.display = "block";
})
}


function startSetting(date,datePayer){

 
// const day =getInputValue("weeksDateDateP")
// const mon =getInputValue("weeksDateMonthP")
// const yr =getInputValue("weeksDateYearP")

// const wID = day+"-"+mon+"-"+yr

// var rawwID =getInputValue("date")
// var revwID = rawwID.replaceAll("/","-")
// var wID = revwID.split('-').reverse().join('-')

// var fullDate = wID.split("-")
// var day = fullDate[0]
// var month = fullDate[1]
// var year = fullDate[2]

//   if(day.charAt(0) === "0"){
//   var day = day.replaceAll("0","")
 
//   }
//   if(month.charAt(0) === "0"){
//   var month = month.replaceAll("0","")
 
//   }
//   if(year.charAt(0) === "0"){
//   var year = year.replaceAll("0","")

//   }
  

  var wID = date
  // document.getElementById("date").value = ""
  var projectForDesktop = getInputValue("email")
  // alert(wID)
  
  retreiveBills(wID)
  // checkingForBalances(wID)
  // getBalancesCasual(wID,date)
  firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).orderByChild("name").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){

      if(childRecord.exists()){
              
          var id = childRecord.val().workID;
          var nme = childRecord.val().name;
          var mon = childRecord.val().Monday;
          var tue = childRecord.val().Tuesday;
          var wed = childRecord.val().Wednesday;
          var thur = childRecord.val().Thursday;
          var fri = childRecord.val().Friday;
          var sat = childRecord.val().Saturday;
          var sun = childRecord.val().Sunday;
          var all = childRecord.val().allowances;
          var total = childRecord.val(). wage;
          var paid = childRecord.val(). paid;
          var bal =childRecord.val(). balance
          var oldStatus = childRecord.val(). status;
          
          if(all ===undefined){
            var all = "0"
          }
          var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(wed)+parseInt(thur)+parseInt(fri)+parseInt(sat)+parseInt(all)
          if(paid ===undefined){
            var paid = "0"
          }
          if(bal ===undefined){
            var bal = parseInt(total)-parseInt(paid)
          }
             
          getWorkersDetails2(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,paid,date,datePayer,bal)
        
      }
      else{
         alert("No record found for "+wID+". Only pending balances will be loaded")
      }

  
  })

});
}
function checkArchive(){
    archive_checker = ""
    var project = getInputValue("email");
    var date = getInputValue("date");
   
   
    var revwID = date.replaceAll("/","-")
    var wID = revwID.split('-').reverse().join('-')
  
    var fullDate = wID.split("-")
    var day = fullDate[0]
    var month = fullDate[1]
    var year = fullDate[2]
  
    if(day.charAt(0) === "0"){
    var day = day.replaceAll("0","")
  
    }
    if(month.charAt(0) === "0"){
    var month = month.replaceAll("0","")
  
    }
    if(year.charAt(0) === "0"){
    var year = year.replaceAll("0","")
  
    }
    
    var wID = day +"-"+month+"-"+year
    // alert(amount) "Sunday"
    // achiver()
    var database = firebase.database().ref(parentDatabase).child("Weeks").child(project).child(wID).once("value",
    function(Snapshot){
      if(Snapshot.exists()){
       
        if(Snapshot.val().name !== undefined){
          loadHistory(project)   
          archive_checker ="done"
            
        }
        else{
              var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
                  function(Snapshot){
                  
  
                      var week = Snapshot.val().current_week
                    
                        if(wID == week){
                          
                          var weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  
                          var d = new Date();
                          var day = weekday[d.getDay()];
                          if(day ==="Saturday"){
                           
                            document.getElementById("alerter").style.display = "inline"
                            document.getElementById("clicker").addEventListener("click",()=>{
                              achiver()
                            })
                          }
                          else{  //alert(day)
                            document.getElementById("alerter").style.display = "none"
                          }
                            
                        }
                        else{
                          document.getElementById("alerter").style.display = "inline"
                          document.getElementById("clicker").addEventListener("click",()=>{
                            achiver()
                          })
                        }
                
                  });
                
        }
       
      }
      else{
        loadHistory(project)
      }
    });
  
  }
function archiveFromTable(){
  var pro  = getInputValue("email")
   
   var b_d_dater = getInputValue("date")
   var revwID = b_d_dater.replaceAll("/","-")
     var wID = revwID.split('-').reverse().join('-')
 
     var fullDate = wID.split("-")
     var day = fullDate[0]
     var month = fullDate[1]
     var year = fullDate[2]
 
       if(day.charAt(0) === "0"){
       var day = day.replaceAll("0","")
     
       }
       if(month.charAt(0) === "0"){
       var month = month.replaceAll("0","")
     
       }
       if(year.charAt(0) === "0"){
       var year = year.replaceAll("0","")
 
       }
       
    var date = day +"-"+month+"-"+year
    var database = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date).once("value",
    function(Snapshot){
      if(Snapshot.exists()){
       
        if(Snapshot.val().name === undefined){
          achiver()  
          archive_checker ="done"
            
        }
        else{
          archive_checker = "done"
        }
      }})
}
var archive_checker = ""
function showachive(){
  var project = getInputValue("email");
  loadHistory(project)
 document.getElementById("namesAchiver").style.display = "block"
}
var biilsCount = 0
function getDateFirst(){
  checkArchive()
  document.getElementById("projectingStatus").innerHTML = "FALSE"
  var datePayer =""
  var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
    function(Snapshot){
        var date = Snapshot.val().current_week
        
            getDFC(date,datePayer)
            var wID = date
            //  checkingForBalances(wID)
          });
          
}

function getDateFirstForBAlances(){
  // document.getElementById("projectingStatus").innerHTML = "FALSE"
  var datePayer =""
  var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
    function(Snapshot){
        var date = Snapshot.val().current_week
        
        document.getElementById("balLoader").style.display ="block"
        document.getElementById("pendingStatus2").style.display ="none"
   
          
          var wID = date
             getBalancesCasual(wID,date)   
          });
          
}
function getDFC(date,datePayer){

  valueIn = 0
  
// const day =getInputValue("weeksDateDateP")biilsCount = 0
// const mon =getInputValue("weeksDateMonthP")
// const yr =getInputValue("weeksDateYearP")

// const wID = day+"-"+mon+"-"+yr

var rawwID =getInputValue("date")
var revwID = rawwID.replaceAll("/","-")
var wID = revwID.split('-').reverse().join('-')

var fullDate = wID.split("-")
var day = fullDate[0]
var month = fullDate[1]
var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")
 
  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")
 
  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  
  var wID = day +"-"+month+"-"+year
  var projectForDesktop = getInputValue("email")
  // alert(wID)document.getElementById("prevBal").innerHTML

  if(wID==="7-7-2024" && projectForDesktop ==="BUSIA CAIP"){
    document.getElementById("prevBal").innerHTML =23700+12400
  }
  if(wID==="7-7-2024" && projectForDesktop ==="ELDORET RC CHURCH"){
    document.getElementById("prevBal").innerHTML =2000
  }
  if(wID==="9-6-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 10600
  }
  if(wID==="2-6-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 4800
  }
  if(wID==="26-5-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 14000
  }
  if(wID==="19-5-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 6100
  }
  if(wID==="12-5-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 19500
  }
  if(wID==="5-5-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 33000
  }
  if(wID==="28-4-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 31500
  }
  if(wID==="17-3-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 23600
  }
  if(wID==="10-3-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 3450
  }
  if(wID==="3-3-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 7450
  }
  if(wID==="25-2-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 10050
  }
  if(wID==="14-4-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 2000
  }
  if(wID==="16-6-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 10400
  }
  if(wID==="23-6-2024" && projectForDesktop ==="BUSIA CAIP"){
    valueIn = 12400
  }
  if(wID==="23-6-2024" && projectForDesktop ==="ELDORET RC CHURCH"){
    valueIn = 2000
  }
  if(date !==wID){
    document.getElementById("prevBalH" ).style.display = "none"
    document.getElementById("SumTotal" ).style.display = "none"
    document.getElementById("payHolder").style.display = "none"
  }
  else{
    document.getElementById("prevBalH" ).style.display = "block"
    document.getElementById("SumTotal" ).style.display = "block"
    document.getElementById("payHolder").style.display = "block"
  }

  retreiveBills(wID)
  
  firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).orderByChild("name").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){

      if(childRecord.exists()){
              
          var id = childRecord.val().workID;
          var nme = childRecord.val().name;
          var mon = childRecord.val().Monday;
          var tue = childRecord.val().Tuesday;
          var wed = childRecord.val().Wednesday;
          var thur = childRecord.val().Thursday;
          var fri = childRecord.val().Friday;
          var sat = childRecord.val().Saturday;
          var sun = childRecord.val().Sunday;
          var all = childRecord.val().allowances;
          var total = childRecord.val(). wage;
          var paid = childRecord.val(). paid;
          
          var oldStatus = childRecord.val(). status;
          var bal =childRecord.val(). balance
          // if(sun==800||mon==800||tue==800||wed==800||thur==800 ){
            
          //   var all = "400"
          // }
          // if(fri==1200 ||fri==1500||fri==1800){
            
          //   var all = "300"
          // }
          // if(fri==1000||fri ==1400||fri==1300){
            
          //   var all = "200"
          // }
          // if(fri==500  || fri ==700|| fri ==600){
          //   var fri ="800"
          //   var all = "200"balances
          // }
          if(all ===undefined){
            var all = "0"
          }
          var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(wed)+parseInt(thur)+parseInt(fri)+parseInt(sat)+parseInt(all)
          if(paid ===undefined){
            var paid = "0"
          }
           if(bal ===undefined){
            var bal = parseInt(total)-parseInt(paid)
           }
          // updateWager(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,paid,date,datePayer,bal,projectForDesktop)
          getWorkersDetails2(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,paid,date,datePayer,bal)
        
      }
      else{
          alert("No record found for "+wID+". Only pending balances will be loaded")
      }

  
  })

});

}

  function updateWager(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,paid,date,datePayer,bal,projectForDesktop){
    var billsDatabase = firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).child(id);
      var receivedDatabase = billsDatabase.update({  


        Friday:fri,
        allowances:all
       


        })
  }

function getBalancesCasual(wID,date){

  
  var pro = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").orderByChild("name").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){
    var nme = childRecord.val().name;
    var phone = childRecord.val(). phone;
    var job = childRecord.val(). designation;
    var id = childRecord.val().workID;
    var locations = childRecord.val().location;
    var balances = childRecord.val().balances;
    var type = childRecord.val().type;
    if(balances ===undefined){
      var balances ="0"

    }
    if(balances =="0"){
      document.getElementById("balLoader").style.display ="none"
    }
    else{
       document.getElementById("balLoader").style.display ="block"
      checkValidity(nme,id,phone,job,locations,balances,type,wID,date)
    }
    
  })})
  getBalancesInhouse(wID,date)
  getBalancesContract(wID,date)
}

function getBalancesInhouse(wID,date){
  var pro = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").orderByChild("name").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){
    var nme = childRecord.val().name;
    var phone = childRecord.val(). phone;
    var job = childRecord.val(). designation;
    var id = childRecord.val().workID;
    var locations = childRecord.val().location;
    var balances = childRecord.val().balances;
    var type = childRecord.val().type;
    if(balances ===undefined){
      var balances ="0"

    }
    if(balances =="0"){
      document.getElementById("balLoader").style.display ="none"
    }
    else{
       document.getElementById("balLoader").style.display ="block"
      checkValidity(nme,id,phone,job,locations,balances,type,wID,date)
    }
    
  })})

}
function getBalancesContract(wID,date){
  var pro = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").orderByChild("name").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){
    var nme = childRecord.val().name;
    var phone = childRecord.val(). phone;
    var job = childRecord.val(). designation;
    var id = childRecord.val().workID;
    var locations = childRecord.val().location;
    var balances = childRecord.val().balances;
    var type = childRecord.val().type;
    if(balances ===undefined){
      var balances ="0"

    }
    if(balances =="0"){
   document.getElementById("balLoader").style.display ="none"
    }
    else{
      // alert(balances)
       document.getElementById("balLoader").style.display ="block"
      checkValidity(nme,id,phone,job,locations,balances,type,wID,date)
    }
    
  })})
}

function checkingForBalances(wID){
  
  
  var pro = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){

      var id2 =childRecord.val(). workID;
             
      var balances = childRecord.val().balances;
        if(balances ===undefined){
          var balances ="0"

        } 
        if(balances > 0){
           showBalLoader(id2,wID)
        }   
      
  })})
  firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){

      var id2 =childRecord.val(). workID;
             
      var balances = childRecord.val().balances;
        if(balances ===undefined){
          var balances ="0"

        }   
        if(balances > 0){
           showBalLoader(id2,wID)
        }  
     
  })})
  firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){

      var id2 =childRecord.val(). workID;
              
      var balances = childRecord.val().balances;
        if(balances ===undefined){
          var balances ="0"

        }   
        if(balances > 0){
           showBalLoader(id2,wID)
        } 
  })})


  
}


function showBalLoader(id2,wID){
  var pro = getInputValue("email")
  
  firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id2).once("value",
  function(cTasks){
    if(cTasks.exists()){
      
    }
    else{
     
      document.getElementById("pendingStatus2").style.display ="block"

    }
  })
}
function checkValidity(nme,id,phone,job,locations,balances,type,wID,date){
  var pro = getInputValue("email")
  firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id).once("value",
  function(cTasks){
    if(cTasks.exists()){
      document.getElementById("balLoader").style.display ="none"
    }
    else{
      
      document.getElementById("balLoader").style.display ="none"
          var mon = "0"
          var tue = "0"
          var wed = "0"
          var thur= "0"
          var fri = "0"
          var sat = "0"
          var sun = "0"
          var all = "0"
         var total= "0"
          var paid ="0"
          var bal = "0"
          var wage = "0"
   var oldStatus = "B/F"
   var datePayer = ""
   
 if( document.getElementById("projectingStatus").innerHTML === "TRUE"){
  // document.getElementById("payHolder").style.display ="none"
  // document.getElementById("SumProjected").style.display ="none"
  addProjectedToTable(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,phone,job,locations,wage,paid,type,balances,bal)
 }
 else{
  // if(idHolder.includes(id)){ payHolder 

  // }
  // else{
  //   idHolder.push(id)
   
  // } 
  addPDFC(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,phone,job,locations,paid,balances,type,date,datePayer,bal)
 }
      
    }

  })
}
var idHolder = []
function getWorkersDetails2(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,paid,date,datePayer,bal){
  var userID = id
  
  document.getElementById("SumProjectedH").style.display ="none"
  document.getElementById("SumTotalAll").style.display ="none"
  var pro = getInputValue("email")
  // alert(pro)
    var database = firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").child(userID).once("value",
      function(Snapshot){
      

       
            if(Snapshot.exists()){
                  // alert(pro)
                  var phone = Snapshot.val(). phone;
                  var job = Snapshot.val(). designation;
                  var id2 =Snapshot.val(). workID;
                  var locations = Snapshot.val().location;
                  var balances = Snapshot.val().balances;
                  var type = Snapshot.val().type;
                  
                  if(balances ===undefined){
                    var balances ="0"

                  }
                
                  if(balances > 0){
                    if(date ==wID){
                       document.getElementById("pendingStatus2").style.display ="block"
                    }
                    else{
                        document.getElementById("pendingStatus2").style.display ="none"
                      }
                  
                   
                  }
                  var confTot = parseInt(bal)+parseInt(balances)
                  if(parseInt(total) <= 0 && parseInt(balances)<= 0){
                  }
                  else{
                    // if(idHolder.includes(id)){

                    // }
                    // else{
                    //   idHolder.push(id)
                       

                    // }
                    addPDFC(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,phone,job,locations,paid,balances,type,date,datePayer,bal)
                  }

                  
                 
            }
            else{

              var database = firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").child(userID).once("value",
              function(Snapshot){
                

                
                    if(Snapshot.exists()){

                      var phone = Snapshot.val(). phone;
                      var job = Snapshot.val(). designation;
                      
                      var locations = Snapshot.val().location;
                      var balances = Snapshot.val().balances;
                      var type = Snapshot.val().type;
                      if(balances ===undefined){
                        var balances ="0"

                      }
                    
                      if(balances > 0){
                        if(date ==wID){
                            document.getElementById("pendingStatus2").style.display ="block"
                          }
                          else{
                              document.getElementById("pendingStatus2").style.display ="none"
                            }
                        }
                        var confTot = parseInt(bal)+parseInt(balances)
                        if(parseInt(total) <= 0 && parseInt(balances)<= 0){
                          }
                          else{
                             addPDFC(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,phone,job,locations,paid,balances,type,date,datePayer,bal)
   
                          }

                     
                    }
                    else{
                      var database = firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").child(userID).once("value",
                      function(Snapshot){
                     

                       
                            if(Snapshot.exists()){
                                var phone = Snapshot.val(). phone;
                                var job = Snapshot.val(). designation;
                                
                                var locations = Snapshot.val().location;
                                var balances = Snapshot.val().balances;
                                var type = Snapshot.val().type;
                                if(balances ===undefined){
                                  var balances ="0"

                                }
                                if(balances > 0){
                                
                                  if(date ==wID){
                                      document.getElementById("pendingStatus2").style.display ="block"
                                    }
                                    else{
                                      document.getElementById("pendingStatus2").style.display ="none"
                                    }
                  
                                }
                                var confTot = parseInt(bal)+parseInt(balances)
                                if(parseInt(total) <= 0 && parseInt(balances)<= 0){
                                }
                                else{
                                   addPDFC(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,phone,job,locations,paid,balances,type,date,datePayer,bal)

                                }

                               
                                
                            }
                       
                      
      
                        })
                      

                    }
                    
                 
      
              })
              

            }
 
       
      })
  

}

function getWorkersDetails3(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,Status,wID,paid,bal){
  var userID = id
 
   var pro = getInputValue("email")


          var database = firebase.database().ref(parentDatabase).child("Staffs").child("Casual").child(pro).child("14-3-2022").child(userID).once("value",
          function(Snapshot){
          

          
                if(Snapshot.exists()){
                      // alert(pro)
                      var phone = Snapshot.val(). phone;
                      var job = Snapshot.val(). designation;
                      var balances = Snapshot.val().balances;
                      var locations = Snapshot.val().location;
                      var wage = Snapshot.val().wage;
                      var type = Snapshot.val().type;
                      if(balances ===undefined){
                        var balances ="0"

                      }
                      if(balances > 0){
                                //  alert(date+" here "+wID)
                                // if(date ==wID){
                                  
                                    document.getElementById("pendingStatus2").style.display ="block"
                                  // }
                                  
                
                              }else{
                                    document.getElementById("pendingStatus2").style.display ="block"
                                  }
                      var confTot = parseInt(bal)+parseInt(balances)
                      if(parseInt(total) <= 0 && parseInt(balances)<= 0){
                        }
                        else{
                        addProjectedToTable(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,Status,wID,phone,job,locations,wage,paid,type,balances,bal)

                        }                         

                }
                else{

                  var database = firebase.database().ref(parentDatabase).child("Staffs").child("in-house").child(pro).child("14-3-2022").child(userID).once("value",
                  function(Snapshot){
                    

                    
                        if(Snapshot.exists()){

                          var phone = Snapshot.val(). phone;
                          var job = Snapshot.val(). designation;
                          var wage = Snapshot.val().wage;
                          var balances = Snapshot.val().balances;
                          var locations = Snapshot.val().location;
                          var type = Snapshot.val().type;
                          if(balances ===undefined){
                            var balances ="0"

                          }
                          if(balances > 0){
                                
                                // if(date ==wID){
                                    document.getElementById("pendingStatus2").style.display ="block"
                                  // }
                                  
                
                              }else{
                                    document.getElementById("pendingStatus2").style.display ="block"
                                  }
                        var confTot = parseInt(bal)+parseInt(balances)
                        if(parseInt(total) <= 0 && parseInt(balances)<= 0){
                        }
                        else{
                           addProjectedToTable(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,Status,wID,phone,job,locations,wage,paid,type,balances,bal)

                        }                         

                        }
                        else{
                          var database = firebase.database().ref(parentDatabase).child("Staffs").child("Contract").child(pro).child("14-3-2022").child(userID).once("value",
                          function(Snapshot){
                        

                          
                                if(Snapshot.exists()){
                                    var phone = Snapshot.val(). phone;
                                    var job = Snapshot.val(). designation;
                                    var wage = Snapshot.val().wage;
                                    var locations = Snapshot.val().location;
                                    var balances = Snapshot.val().balances;
                                    var type = Snapshot.val().type;
                                    if(balances ===undefined){
                                      var balances ="0"

                                    }
                                    
                                    if(balances > 0){
                                      
                                      // if(date ==wID){
                                          document.getElementById("pendingStatus2").style.display ="block"
                                        // }
                                       
                      
                                    } else{
                                          document.getElementById("pendingStatus2").style.display ="block"
                                        }
                                    var confTot = parseInt(bal)+parseInt(balances)
                                    if(parseInt(total) <= 0 && parseInt(balances)<= 0){
                                    }
                                    else{
                                       addProjectedToTable(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,Status,wID,phone,job,locations,wage,paid,type,balances,bal)

                                    }                                   

                                }
                          
                          
          
                            })
                          

                        }
                        
                    
          
                  })
                  

                }
    
          
          })
      


      
     
 
  // alert(pro)
   
}

var  UpdateNo = 0;
function addPDFC(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,oldStatus,wID,phone,job,locations,paid,balances,type,date,datePayer,bal){
  var projectForDesktop = getInputValue("email")
  // alert(wID)
  // alert(date + "=" +wID)


  var pro = projectForDesktop
var balances = (Math.round(balances / 50) *50).toString()
var tbody = document.getElementById("tbodyPDFC");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8 = document.createElement("td");
var td9 = document.createElement("td");
var td10 = document.createElement("td");
var td11 = document.createElement("td");
var td12 = document.createElement("td");
var td13 = document.createElement("td");
var td14 = document.createElement("td");
var td15 = document.createElement("td");
var td16 = document.createElement("td");
var td17 = document.createElement("td");
var td18 = document.createElement("td");
var td19 = document.createElement("td");
var td20 = document.createElement("td");
var btn = document.createElement("button");

const btnReload = document.getElementById("btnViewPayments");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");
var bal = ((parseInt(total))-parseInt(paid)) 
var grand_total = (parseInt(bal)+parseInt(balances)).toString()
var mode = getInputValue("selectedMode")
if(all === undefined){
  var all = "0"
}
// if(Status ==="PAID"){setWeekDatePending
//   var paid = total
 
// }


var w_bal = ((parseInt(total))-parseInt(paid)).toString() 

if(oldStatus ==="partial"){
// alert(oldStatus)
var grand_total = (parseInt(grand_total)-parseInt(w_bal)).toString() 
balances = (parseInt(balances)-parseInt(w_bal))
}
else{

}
if(grand_total =="0"){
 oldStatus ="PAID"
}
document.getElementById("th16").innerHTML = "Balance"

td19.style.fontWeight ="bold"
td18.style.fontWeight ="bold"

td1.innerHTML = nme;
td2.innerHTML = id;
td3.innerHTML = phone;
td4.innerHTML = locations;
td5.innerHTML = job 
td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
td8.innerHTML =   Intl.NumberFormat('en-US').format(tue)
td9.innerHTML =   Intl.NumberFormat('en-US').format(wed)
td10.innerHTML =  Intl.NumberFormat('en-US').format(thur)
td11.innerHTML =   Intl.NumberFormat('en-US').format(fri)
td12.innerHTML =   Intl.NumberFormat('en-US').format(sat)


if(sun > 0){
  td6.style.cursor = "cell"  
  td6.title ="Update"
  td6.addEventListener("click",()=>{
    var siku = "Sunday"
    var amount2 = getInputValue("ovTime")
    var td7 
    var td8
    var td9
    var td10 
    var td11 
    var td12
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}
if(mon > 0){
  td7.style.cursor = "cell"
  td7.title ="Update"
  td7.addEventListener("click",()=>{
    var siku = "Monday"
    var amount2 = getInputValue("ovTime")
    var td6 
    var td8
    var td9
    var td10 
    var td11 
    var td12
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}
if(tue > 0){
  td8.style.cursor = "cell"
  td8.title ="Update"
  td8.addEventListener("click",()=>{
    var siku = "Tuesday"
    var amount2 = getInputValue("ovTime")
    var td6 
    var td7
    var td9
    var td10 
    var td11 
    var td12
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}
if(wed > 0){
  td9.style.cursor = "cell"
  td9.title ="Update"
  td9.addEventListener("click",()=>{
    var siku = "Wednesday"
    var amount2 = getInputValue("ovTime")
    var td6 
    var td8
    var td7
    var td10 
    var td11 
    var td12
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}
if(thur > 0){
  td10.style.cursor = "cell"
  td10.title ="Update"
  td10.addEventListener("click",()=>{
    var siku = "Thursday"
    var amount2 = getInputValue("ovTime")
    var td6 
    var td8
    var td9
    var td7 
    var td11 
    var td12
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}
if(fri > 0){
  td11.style.cursor = "cell"
  td11.title ="Update"
  td11.addEventListener("click",()=>{
    var siku = "Friday"
    var amount2 = getInputValue("ovTime")
    var td6 
    var td8
    var td9
    var td10 
    var td7 
    var td12
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}
if(sat > 0){
  td12.style.cursor = "cell"
  td12.title ="Update"
  td12.addEventListener("click",()=>{
    var siku = "Saturday"
    var amount2 = getInputValue("ovTime")
    var td6 
    var td8
    var td9
    var td10 
    var td11 
    var td7
    updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
  })
}

if(total != 0){
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)+`<i style="float:right; margin-right:1px;color="blue" class="fa fa-caret-up" aria-hidden="true"></i>`

}
else{
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)

}
td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
td15.innerHTML =  Intl.NumberFormat('en-US').format(paid)

td16.innerHTML =  Intl.NumberFormat('en-US').format(bal)

td17.innerHTML =  Intl.NumberFormat('en-US').format(balances)+`<i style="float:right; margin-right:1px;color="blue" class="fa fa-caret-up" aria-hidden="true"></i>`
td20.innerHTML = oldStatus.toUpperCase();
if(date === wID){

  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)

}
else{
 
  td18.innerHTML =  "-"
  td14.style.fontWeight ="bold"
  td16.style.fontWeight ="bold"
 
}




var payTitle = getInputValue("mode_value")
document.getElementById("modePresenter").title =payTitle+" plus site bills"
document.getElementById("modePresenter").style.cursor ="pointer"
var rate = parseFloat(parseInt(getInputValue('week_per_val'))/100).toFixed(2).toString()
var rate2 = parseFloat(parseInt(getInputValue('prev_per_val'))/100).toFixed(2).toString()
// alert(rate)valueIn

if(oldStatus ==="PAID"){
  var payable =  "0"
  td19.style.color = "green"
  td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
}
else{
    if(mode ===""){
      if(date === wID){
      var payable = "Not set"
        td19.style.color = "red"
        td19.innerHTML =  payable
        document.getElementById("modePresenter").title =payTitle+"Not Set"
      }
      else{
        td19.innerHTML = "-"
      }
    
    }
    if(mode ==="1"){
      if(date === wID){
        var payable =  Math.round((parseInt(balances)+parseInt(bal)) / 50)*50 
          td19.style.color = "green"
          td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
          var Status ="PAID"
          var paid = total
          var balance = "0" 
          var bal = "0"
          
          var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("totalPayable").style.display = "block" Not set
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="

      }
      else{
        td19.innerHTML = "-"
      }
    
      
    }
    if(mode ==="2"){

      if(date === wID){
          var payable = balances
          td19.style.color = "green"
          td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
          var Status ="pending*"
          var paid = "0"
          var balance = total 
          var bal = total
          var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }

      
    }
    if(mode ==="3"){

      if(date === wID){
        var payable = bal
        td19.style.color = "green"
        td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
        var Status ="PAID"
        var paid = payable // should change for partial payment 
        var balance = balances 
        var bal ="0"
        var paid = total
        var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }

      
    }
    if(mode ==="4"){

      if(date === wID){
        var payable =  ( Math.round((parseInt(bal)*parseFloat(rate)) / 50)*50 ).toString()
        td19.style.color = "green"
        td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
        var Status ="partial"
        var paid = payable // should change for partial payment 
        var balance = (parseInt(bal)-parseInt(paid)) +parseInt(balances)
        var bal = (parseInt(total))-parseInt(paid)
        var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }
    
      
    }
    if(mode ==="5"){
      if(date === wID){
        var payable =  (  Math.round((parseInt(balances)*parseFloat(rate2)) / 50)*50 ).toString()
        td19.style.color = "green"
        td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
        var Status ="pending*"
        var paid ="0"  // should change for partial payment 
        var balance = parseInt(bal)+(parseInt(balances)-parseInt(payable)) 
        var bal = total 
        var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }

    }
    if(mode ==="6"){
      if(date === wID){
        var payable = ( Math.round((parseInt(balances) +(parseInt(bal)*parseFloat(rate))) / 50)*50 ).toString()
        td19.style.color = "green"
        td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
        var Status ="partial"
        var paid =(parseInt(bal)*parseFloat(rate)).toString()  // should change for partial payment 
        var balance = (parseInt(bal)-parseInt(payable)) 
        var bal = (parseInt(bal))-parseInt(paid) 
        var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }

    }
    if(mode ==="7"){

      if(date === wID){
          var payable =  ( Math.round( (parseInt(bal) +(parseInt(balances)*parseFloat(rate2)))/ 50) * 50).toString()
          td19.style.color = "green"
          td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
          var Status ="PAID"
          var paid = total // should change for partial payment 
          var balance = (parseInt(balances)-parseInt(payable) )
          var bal = "0" 
          var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }

    }
    if(mode ==="8"){ 
      var avRate = ((parseFloat(rate)+parseFloat(rate2))/2)
      var original_paid = paid
      if(date === wID){
        var payable =  ( Math.round(((parseInt(bal)*parseFloat(rate)) + (parseInt(balances)*parseFloat(rate2))) / 50) * 50).toString()
        td19.style.color = "green"
        td19.innerHTML =  Intl.NumberFormat('en-US').format(Math.round(payable / 50) * 50)
        var Status ="PAID"
       
        if(avRate < 100){
           Status ="partial"
        }
        var total =parseInt(grand_total)-parseInt(balances) 
        var paid =(parseInt(total)*parseFloat(rate)).toString() // should change for partial payment 
        var balance = (parseInt(bal)-(parseInt(bal)*parseFloat(rate)))+(parseInt(balances)-(parseInt(balances)*parseFloat(rate2))) 
        var bal = (parseInt(bal))-parseInt(paid) 
        var paid =   (parseInt(original_paid))+ parseInt(paid) 
        var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(document.getElementById("totalPayable").innerHTML)+"/="
      }
      else{
        td19.innerHTML = "-"
      }

    }
    if(mode ==="9"){
      if(date === wID){
          var payable =  "0"
          td19.style.color = "green"
          td19.innerHTML =  Intl.NumberFormat('en-US').format(payable)
          var Status ="C/F"
          var balance = parseInt(bal)+parseInt(balances)
          var bal = total
          var paid ="0" 
          var newPayable = parseFloat(payable)+parseFloat(document.getElementById("totalPayable").innerHTML)
          document.getElementById("totalPayable").innerHTML = newPayable
          // document.getElementById("modePresenter").innerHTML ="Payable: NILL"
      }
      else{
        td19.innerHTML = "-"
      }

    }

}

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Received";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";

td13.style.cursor = "pointer"
td13.title ="Update overtime for "+nme

td17.style.cursor = "pointer"
td17.title ="Update balance for "+nme

trow.appendChild(td1); 
trow.appendChild(td2); 
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8);
trow.appendChild(td9);
trow.appendChild(td10);
trow.appendChild(td11);
trow.appendChild(td12);
trow.appendChild(td13);
trow.appendChild(td14);
trow.appendChild(td15);
var tick =  document.createElement("i");
if(date !==wID &&bal >0&&balances >=bal){
        //  alert("here")  
                  

tick.innerHTML= `<i title ="Clear balance" style="float: right; color:green; fontSize:16px;cursor:pointer;" class="fa fa-check" aria-hidden="true"></i>`
trow.appendChild(td16).appendChild(tick);                  
}
else{
  trow.appendChild(td16);
}

trow.appendChild(td17);
trow.appendChild(td18);
trow.appendChild(td19);
trow.appendChild(td20);


// trow.appendChild(btnCancel);val

tbody.appendChild(trow);
// alert(Status)
dateToUse = ""

tick.addEventListener("click",()=>{
  var bal = ((parseInt(total))-parseInt(paid)) 
//  alert(bal)
  if(balances >=bal ){
         var paying = prompt("Specify amount to clear:", bal);
          if (paying == null || paying == "") {
            
          } 
          else {
              if(paying > bal){
                alert("Amount to be cleared cannot be larger than available week balance!")
              }
              else{

              
                var bal = (parseInt(bal)-parseInt(paying))
                var new_balance =   (parseInt(balances)-parseInt(paying));
            
              
                  var siku = "paid"
                  var amount2 = paying
                  var td6 
                  var td8
                  var td9
                  var td10 
                  var td7 
                  var td12
                  var td11
                  var database = firebase.database().ref(parentDatabase).child("Staffs").child(type).child(pro).child("14-3-2022").child(id);
                  var receivedDatabase = database.update({  


                    balances:new_balance


                  }).then(
                      
                      // alert("Balance for "+nme+" updated successfully")doe,
                      td16.innerHTML = bal,
                      td15.innerHTML = amount2,
                      td17.innerHTML = new_balance,
                      tick.style.display = "none",
                      
                      
                      updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2)
                  
                )
              }
            }
        }
        else{
            alert("ERROR:")
          }
})
// btnReload.innerHTML = "RELOAD" lCounter MOLO 1
valueIn +=  parseInt(total)//document.getElementById("lCounter").innerHTML
// var laborValue = parseInt(total)+parseInt(valueIn)
document.getElementById("lCounter").innerHTML = valueIn


var initBal = parseInt(balances)
// if(date !== wID){
//     balances valueIn = 0
//   }
var newBalances = parseFloat(balances)+parseFloat(document.getElementById("prevBal").innerHTML)
document.getElementById("prevBal").innerHTML = newBalances
btnReload.addEventListener("click",()=>{

// window.location.href ="dashboard.html"
document.getElementById("downloadTop2").title ="Download wagebill"
})

document.getElementById("projector").addEventListener("click",()=>{
  document.getElementById("lCounter").innerHTML = "0"
  document.getElementById("balLoader").style.display ="none"
  document.getElementById("laborTotal").innerHTML ="Labor: Ksh 0"
document.getElementById("OtherTotal").innerHTML ="Bills:"
document.getElementById("SumTotal").innerHTML ="Total: Ksh 0"

  document.getElementById("prevBal").innerHTML ="0"
  document.getElementById("totalPayable").innerHTML ="0"
  document.getElementById("modePresenter").innerHTML =""
  trow.remove()
  document.getElementById("SumProjected").innerHTML = 0
  document.getElementById("SumTotalAllH").innerHTML = 0
  
})
// document.getElementById("projector").addEventListener("click",()=>{
//   projectWageBill(wID)
// })

document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
document.getElementById("modePresenter").innerHTML =""
document.getElementById("balLoader").style.display ="none"
document.getElementById("totalPayable").innerHTML ="0"
document.getElementById("prevBal").innerHTML ="0"
document.getElementById("SumProjected").innerHTML = 0
document.getElementById("SumTotalAllH").innerHTML = 0
document.getElementById("lCounter").innerHTML = "0"
document.getElementById("SumTotal").innerHTML ="Total: Ksh 0"
document.getElementById("laborTotal").innerHTML ="Labor: Ksh 0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh 0"
})
td13.addEventListener("click",()=>{

  if (confirm("Add overtime for "+nme+"?" )) {
    var rawwID =getInputValue("date")
    var revwID = rawwID.replaceAll("/","-")
    var wID = revwID.split('-').reverse().join('-')

    var fullDate = wID.split("-")
    var day = fullDate[0]
    var month = fullDate[1]
    var year = fullDate[2]

    if(day.charAt(0) === "0"){
    var day = day.replaceAll("0","")
  
    }
    if(month.charAt(0) === "0"){
    var month = month.replaceAll("0","")
  
    }
    if(year.charAt(0) === "0"){
    var year = year.replaceAll("0","")

    }
    
    var wID = day +"-"+month+"-"+year
    var pro = getInputValue("email")
    var overTime = getInputValue("ovTime")
    var sign =  getInputValue("sign")
    if(overTime !=""){
     
      all = td13.innerHTML.replaceAll(",","")
      total = td14.innerHTML.replaceAll(",","")
        if(sign == "+"){
          
          var new_wage = (parseInt(total)+parseInt(overTime));
            var new_all = (parseInt(all)+parseInt(overTime));
        }
        else if(sign =="-"){
          
          
          var new_wage = (parseInt(total)-parseInt(overTime));
            var new_all = (parseInt(all)-parseInt(overTime));
        }
        else{
          var new_wage = (parseInt(total)-parseInt(all)+parseInt(overTime));
            var new_all = (parseInt(overTime));
        }
         
        var total = (parseInt(document.getElementById("laborTotal").innerHTML.replaceAll(",","").replaceAll("Labor: Ksh",""))-parseInt(total)+parseInt(new_wage))
            // var new_wage = (parseInt(total)+parseInt(overTime));
            // var new_all = (parseInt(all)+parseInt(overTime));
         

          

                var databaseR = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id);
                var receivedDatabase = databaseR.update({  


                  allowances:new_all,
                  wage:new_wage
            

                }).then(
                  
                  updateWeeksLaborAllowances(pro,id,nme,locations,new_wage,wID,total,new_all,new_wage,td13,overTime,td15,td16,td17,td14)
                    
                    

                );

       
    }
    else{
      // alert(overTime)
      alert("Please enter amount on the overtime field")
      document.getElementById("overtimeWrapper").style.display = "block"
    }

    
  } 
  else {
    
    
  }

})

td17.addEventListener("click",()=>{

if (confirm("Add balance for "+nme+"?" )) {

  var rawwID =getInputValue("date")
  var revwID = rawwID.replaceAll("/","-")
  var wID = revwID.split('-').reverse().join('-')

  var fullDate = wID.split("-")
  var day = fullDate[0]
  var month = fullDate[1]
  var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")

  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")

  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  
  var wID = day +"-"+month+"-"+year
  var pro = getInputValue("email")
  var upBal =  getInputValue("ovTime")
  var sign =  getInputValue("sign")
 
  if(upBal !=""){
   
    balances = td17.innerHTML.replaceAll(",","")
        if(sign == "+"){
          
          var new_balance = (parseInt(balances)+parseInt(upBal) );
        }
        else if(sign =="-"){
          
          
          var new_balance = (parseInt(balances)-parseInt(upBal));
        }
        else{
          var new_balance = upBal
        }
        

          var database = firebase.database().ref(parentDatabase).child("Staffs").child(type).child(pro).child("14-3-2022").child(id);
          var receivedDatabase = database.update({  


            balances:new_balance


          }).then(
              
              // alert("Balance for "+nme+" updated successfully"),
              td17.innerHTML = new_balance,
              
          )

     
    }
    else{
      // alert(overTime)
      alert("Please enter amount on the overtime field")
      document.getElementById("overtimeWrapper").style.display = "block"
    }

    
  } 
  else {
    
    
  }

})


if(oldStatus ==="PAID"){
// //   td20.style.cursor = "pointer"
//   td20.addEventListener("click",()=>{
//   if(payable ==="Not set"||payable <= 0){
//     alert("Set payable amount first")
//   }
//   else{
//     var amount = payable
//     var phoneNumber = phone
    
//     const b2cTransaction = functions2.httpsCallable('b2cTransaction');
    
//       b2cTransaction({ amount: amount, phone: phone }).then(result => {
//       console.log(result.data);
//     }).catch(error => {
//       console.error('Error:', error);
//     });
//     // testDaraja(name,id,phoneNumber,amount)
//   }
// });
    
}
else{
  td20.title ="Update Status"
  td20.style.cursor = "pointer"
  td20.addEventListener("click",()=>{
  var currentlyPaid = (parseInt(total)+parseInt(balances)).toString()
  if(payable ==="Not set"|| payable == "0"){
    alert("Invalid amount")
  }
  else{
    if (confirm("Confirm payment of "+payable +" to "+nme+ "?")) {

        td20.innerHTML = "Loading.."
        td20.style.color ="red"
       
        updatePaymentStatus(id,td20,bal,paid,td15,td16,Status,type,balance,td17,td19,total,trow,18)
        if(archive_checker =="done"){

        }
        else{
          archiveFromTable()
        }
        
        
      } 
      else {
        // alert("Process Canceled.")
        td20.style.color ="black"
        td20.innerHTML = Status.toUpperCase();
        
      }
    
  }
  
  })
}

// if( oldStatus !=="B/F"){
 
// }
// else{
//   td20.title ="Update Status"
//   td20.style.cursor = "pointer"
//   td20.addEventListener("click",()=>{
//   var currentlyPaid = (parseInt(total)+parseInt(balances)).toString()
//   if(payable ==="Not set"){
//     alert("Set payable amount first")
//   }
//   else{
//     if (confirm("Confirm payment of "+payable +" to "+nme+ "?")) {

//         td20.innerHTML = "Loading.."
//         td20.style.color ="red"
       
//         updatePaymentStatus(id,td20,bal,paid,td15,td16,Status,type,balance,td17,td19,total)
        
//       } 
//       else {
//         // alert("Process Canceled.")
//         td20.style.color ="black"
//         td20.innerHTML = Status.toUpperCase();
        
//       }
    
//   }
  
//   })
// }


document.getElementById("btnViewPayments").addEventListener('click',() => {
    document.getElementById("prevBal").innerHTML ="0"
    document.getElementById("balLoader").style.display ="none"
    document.getElementById("totalPayable").innerHTML ="0"
    document.getElementById("modePresenter").innerHTML =""
    document.getElementById("laborTotal").innerHTML ="Labor: Ksh0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh0"
    document.getElementById("SumTotal").innerHTML ="Total: Ksh0"
    document.getElementById("lCounter").innerHTML = "0"
    trow.remove();
 })

document.getElementById("btnSet").addEventListener('click',() => {
  document.getElementById("balLoader").style.display ="none"
    document.getElementById("prevBal").innerHTML ="0"
    document.getElementById("totalPayable").innerHTML ="0"
    document.getElementById("laborTotal").innerHTML ="Labor: Ksh0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh0"
    document.getElementById("SumTotal").innerHTML ="Total: Ksh0"
    document.getElementById("lCounter").innerHTML = "0"
    trow.remove();
})

  
firebase.database().ref(parentDatabase).child("Weeks").child(projectForDesktop).child(wID).once("value",
function(cTasks){
  if(cTasks.exists()){
   
    var amountLabor = cTasks.val().wage;
    
  }
  else{
    var amountLabor = "0"

    
  }

  

  const otherExp = document.getElementById("laborTotal")
  var amountLabor = document.getElementById("lCounter").innerHTML
  otherExp.innerHTML = "Labor: Ksh"+ Intl.NumberFormat('en-US').format(amountLabor)

  

  // window.alert(toCost)

  firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(wID).once("value",
  function(cTasks){
   
      if(cTasks.exists()){
        var bals = document.getElementById("prevBal").innerHTML
          var amountOther = cTasks.val().gibs;
          const toCost = parseInt(amountLabor)+ parseInt(bals) + parseInt(amountOther)
          const total = document.getElementById("SumTotal")
          total.innerHTML = "Total: Ksh"+Intl.NumberFormat('en-US').format(toCost)

            

          const otherExp = document.getElementById("OtherTotal")
          otherExp.innerHTML = "Pending Bills: Ksh"+ Intl.NumberFormat('en-US').format(amountOther)


          document.getElementById("modePresenter").innerHTML ="Payable: "+Intl.NumberFormat('en-US').format(parseInt(document.getElementById("totalPayable").innerHTML)+ parseInt(billsTotal) )+"/="


      }
      else{
        var bals = document.getElementById("prevBal").innerHTML
          const toCost = parseInt(amountLabor) + parseInt("0")+ parseInt(bals)
          const total = document.getElementById("SumTotal")
          total.innerHTML = "Total: Ksh"+  Intl.NumberFormat('en-US').format(toCost)
          const otherExp = document.getElementById("OtherTotal")
          otherExp.innerHTML = "Pending Bills: Ksh"+"0"

          document.getElementById("modePresenter").innerHTML ="Total Payable: "+Intl.NumberFormat('en-US').format(parseInt(document.getElementById("totalPayable").innerHTML)+ parseInt("0") )+"/="

      }
    

  });

});



// <h4 id="laborTotal">Labor:</h4>
//                     <h4 id="OtherTotal">erOth Expenses:</h4>
//                     <h3 id="SumTotal">Total:</h3>

btn.addEventListener('click',() => {
//   alert(admision +" "+classs);

// deletePDFC(id);
var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate
var pSName = name;
var pSDoc = doc;
var pSPhone = contact;
var psDate = dat;

postP(psDate,pSName,pSDoc,pSPhone,d)
      // modal.style.display = "block";
})
// ==========================sorter=========================



// ==========================end sorter=====================

}
var valueIn = 0
function updatePaymentsFromWagebill(nme,type,pro,id,siku,td6,td7,td8,td9,td10,td11,td12,amount2){
  
  var rawwID =getInputValue("date")
  var revwID = rawwID.replaceAll("/","-")
  var wID = revwID.split('-').reverse().join('-')

  var fullDate = wID.split("-")
  var day = fullDate[0]
  var month = fullDate[1]
  var year = fullDate[2]

  if(day.charAt(0) === "0"){
  var day = day.replaceAll("0","")

  }
  if(month.charAt(0) === "0"){
  var month = month.replaceAll("0","")

  }
  if(year.charAt(0) === "0"){
  var year = year.replaceAll("0","")

  }
  
  var wID = day +"-"+month+"-"+year
  var pro = getInputValue("email")
  // alert(amount2)
  if(siku == "paid"){
    var database = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id);
            var receivedDatabase = database.update({  


              [siku]:amount2


            })
  }
  else{
    if (confirm("Update "+nme+"'s "+siku+" amount" )) {

      if(amount2 !=""){
    
      
          
            
            var new_balance = amount2
            // (parseInt(balances)+parseInt(amount2));
        

          // alert("here")

            var database = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id);
            var receivedDatabase = database.update({  


              [siku]:amount2


            }).then(
              
              finish(siku,td6,nme,amount2,td7,td8,td9,td10,td11,td12)
              
                
            )

      
    }
    else{
      // alert(overTime)
      alert("Please enter amount on the overtime field")
      document.getElementById("overtimeWrapper").style.display = "block"
    }

    } 
    else {
      
      
    }
  }
  

}
function finish(siku,td6,nme,amount2,td7,td8,td9,td10,td11,td12){
  var amount3 = Intl.NumberFormat('en-US').format(amount2)
  alert("Amount for "+nme+" updated successfully")
  if(siku == "Sunday"){
   td6.innerHTML = amount3
  }
  if(siku == "Monday"){
   td7.innerHTML = amount3
  }
  if(siku == "Tuesday"){
   td8.innerHTML = amount3
  }
  if(siku == "Wednesday"){
   td9.innerHTML = amount3
  }
  if(siku == "Thursday"){
   td10.innerHTML = amount3
  }
  if(siku == "Friday"){
   td11.innerHTML = amount3
  }
  if(siku == "Saturday"){
   td12.innerHTML = amount3
  }
  


}
var dayHolder = 0
function addProjectedToTable(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,Status,wID,phone,job,locations,wage,paid,type,balances,bal){
  var projectForDesktop = getInputValue("email")

  var weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

  var d = new Date();
  var day = weekday[d.getDay()];
  
var balances = (Math.round(balances / 50) *50).toString()
var tbody = document.getElementById("tbodyPDFC");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var td4 = document.createElement("td");
var td5 = document.createElement("td");
var td6 = document.createElement("td");
var td7 = document.createElement("td");
var td8 = document.createElement("td");
var td9 = document.createElement("td");
var td10 = document.createElement("td");
var td11= document.createElement("td");
var td12= document.createElement("td");
var td13 = document.createElement("td");
var td14 = document.createElement("td");
var td15 = document.createElement("td");
var td16 = document.createElement("td");
var td17 = document.createElement("td");
var td18 = document.createElement("td");
var td19 = document.createElement("td");
var td20 = document.createElement("td");
var td130 = document.createElement("td");
var btn = document.createElement("button");

const btnReload = document.getElementById("btnViewPayments");
// var btnCancel = document.createElement("button");
// var btnEdit = document.createElement("button");

// document.getElementById("th16").style.display ="none"
// document.getElementById("th15").style.display ="none"
btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Received";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";

// td13.style.cursor = "pointer" 
// td13.title ="Update overtime for "+nme

if(all ===undefined){
  var all = "0"
}
if(Status ==="PAID"){
  var paid = total
}
var bal = parseInt(total)-parseInt(paid) 



td14.style.fontWeight ="bold"
td18.style.fontWeight ="bold"
td1.innerHTML = nme;
td2.innerHTML = id;
td3.innerHTML = phone;
td4.innerHTML = locations;
td5.innerHTML = job 
td15.innerHTML = paid;
td16.innerHTML = bal 
td17.innerHTML =  Intl.NumberFormat('en-US').format(balances)

td19.innerHTML ="-"
td20.innerHTML = Status.toUpperCase();
document.getElementById("th16").innerHTML = "Actual"

// ==========================Generator==========================
if(day ==="Sunday"){
  var total = parseInt(total)+(parseInt(wage)*6)



  if(sat ==="0"){
    
    td12.style.color = "red"
    td12.title ="Projected"
  }
  if(fri ==="0"){
    
    td11.style.color = "red"
    td11.title ="Projected"
  }
  if(thur ==="0"){
    
    td10.style.color = "red"
    td10.title ="Projected"
  }
  if(wed ==="0"){
    
    td9.style.color = "red"
    td9.title ="Projected"
  }
  if(tue ==="0"){
    
    td8.style.color = "red"
    td8.title ="Projected"
  }
  if(mon ==="0"){

    td7.style.color = "red"
    td7.title ="Projected"

  }
  if(sun ==="0"){

    td6.style.color = "red"
    td6.title ="Projected"
    var sun = wage
    
  }

  var total = parseInt(sun)+parseInt(all)+(parseInt(wage)*6)
  
  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(wage)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)//+`<i style="float:right; margin-right:10px;color="blue" class="fa fa-caret-up" aria-hidden="true"></i>`
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)
}
if(day ==="Monday"){

 
  

  if(sat ==="0"){
    
    td12.style.color = "red"
    td12.title ="Projected"
  }
  if(fri ==="0"){
    
    td11.style.color = "red"
    td11.title ="Projected"
  }
  if(thur ==="0"){
    
    td10.style.color = "red"
    td10.title ="Projected"
  }
  if(wed ==="0"){
    
    td9.style.color = "red"
    td9.title ="Projected"
  }
  if(tue ==="0"){
    
    td8.style.color = "red"
    td8.title ="Projected"
  }
  if(mon ==="0"){

    td7.style.color = "red"
    td7.title ="Projected"
    var mon = wage
    
  }
 
  
  var total = parseInt(sun)+parseInt(mon)+parseInt(all)+(parseInt(wage)*5)
  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(wage)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)+`<i style="float:right; margin-right:10px;color="blue" class="fa fa-caret-up" aria-hidden="true"></i>`
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)
}
if(day ==="Tuesday"){


  if(sat ==="0"){
    
    td12.style.color = "red"
    td12.title ="Projected"
  }
  if(fri ==="0"){
    
    td11.style.color = "red"
    td11.title ="Projected"
  }
  if(thur ==="0"){
    
    td10.style.color = "red"
    td10.title ="Projected"
  }
  if(wed ==="0"){
    
    td9.style.color = "red"
    td9.title ="Projected"
  }

  if(tue ==="0"){

    td8.style.color = "red"
    td8.title ="Projected"
    var tue = wage
    
  }
  

  var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(all)+(parseInt(wage)*4)
  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(tue)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(wage)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)
}
if(day ==="Wednesday"){

 

  if(sat ==="0"){
    
    td12.style.color = "red"
    td12.title ="Projected"
  }
  if(fri ==="0"){
    
    td11.style.color = "red"
    td11.title ="Projected"
  }
  if(thur ==="0"){
    
    td10.style.color = "red"
    td10.title ="Projected"
  }
  if(wed ==="0"){

    td9.style.color = "red"
    td9.title ="Projected"
    var wed = wage

  }
 
  
  var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(wed)+parseInt(all)+(parseInt(wage)*3)

  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(tue)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wed)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(wage)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)

}
if(day ==="Thursday"){

  if(sat ==="0"){
    
    td12.style.color = "red"
    td12.title ="Projected"
  }
  if(fri ==="0"){
    
    td11.style.color = "red"
    td11.title ="Projected"
  }

 if(thur ==="0"){

    td10.style.color = "red"
    td10.title ="Projected"
    var thur = wage
    
  }
 
  
  var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(wed)+parseInt(thur)+parseInt(all)+(parseInt(wage)*2)
  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(tue)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wed)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(thur)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)
}
if(day ==="Friday"){
  if(sat ==="0"){
    
    td12.style.color = "red"
    td12.title ="Projected"
  }
  if(fri ==="0"){

    td11.style.color = "red"
    td11.title ="Projected"
    var fri = wage
    
  }
  

  var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(wed)+parseInt(thur)+parseInt(fri)+parseInt(all)+(parseInt(wage))
  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(tue)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wed)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(thur)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(fri)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(wage)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)
}
if(day ==="Saturday"){
  if(sat ==="0"){
    var sat = wage
    var total = parseInt(total)+parseInt(sat)
    td12.style.color = "red"
    td12.title ="Projected"
  }
  else{
    var total = parseInt(total)
  }
  
  
  td6.innerHTML =   Intl.NumberFormat('en-US').format(sun)
  td7.innerHTML =   Intl.NumberFormat('en-US').format(mon)
  td8.innerHTML =   Intl.NumberFormat('en-US').format(tue)
  td9.innerHTML =   Intl.NumberFormat('en-US').format(wed)
  td10.innerHTML =  Intl.NumberFormat('en-US').format(thur)
  td11.innerHTML =   Intl.NumberFormat('en-US').format(fri)
  td12.innerHTML =   Intl.NumberFormat('en-US').format(sat)
  td13.innerHTML =   Intl.NumberFormat('en-US').format(all)
  td14.innerHTML =  Intl.NumberFormat('en-US').format(total)
  var grand_total = (parseInt(total)+parseInt(balances))
  td18.innerHTML =  Intl.NumberFormat('en-US').format(grand_total)
}


// =============================================================




trow.appendChild(td1); 
trow.appendChild(td2); 
trow.appendChild(td3);
trow.appendChild(td4);
trow.appendChild(td5);
trow.appendChild(td6);
trow.appendChild(td7);
trow.appendChild(td8);
trow.appendChild(td9);
trow.appendChild(td10);
trow.appendChild(td11);
trow.appendChild(td12);
trow.appendChild(td13);
trow.appendChild(td14);
trow.appendChild(td15);
trow.appendChild(td16);
trow.appendChild(td17);
trow.appendChild(td18);
trow.appendChild(td19);
trow.appendChild(td20);
tbody.appendChild(trow);
actualForProjected +=bal
weektotaprojected +=total
document.getElementById("downloadTop2").title ="Download projected wagebill"
var projectedTot = document.getElementById("SumTotalAllH").innerHTML
var new_projectd = (parseInt(projectedTot)+parseInt(total))


var valueIn = document.getElementById("lCounter").innerHTML
var laborValue = parseInt(total)+parseInt(valueIn)
document.getElementById("lCounter").innerHTML = laborValue

var newBalances = parseFloat(balances)+parseFloat(document.getElementById("prevBal").innerHTML)
document.getElementById("prevBal").innerHTML = newBalances

btnReload.addEventListener("click",()=>{

// window.location.href ="dashboard.html"

})
// alert(new_projectd)

document.getElementById("SumTotalAllH").innerHTML =new_projectd 

document.getElementById("projector").addEventListener("click",()=>{
  // projectWageBill(wID)
  document.getElementById("lCounter").innerHTML = "0"
  document.getElementById("balLoader").style.display ="none"
  document.getElementById("totalPayable").innerHTML ="0"
  document.getElementById("modePresenter").innerHTML =""
  document.getElementById("prevBal").innerHTML ="0"
  trow.remove()
  document.getElementById("SumProjected").innerHTML = 0
  document.getElementById("SumTotalAllH").innerHTML = 0
  document.getElementById("SumTotal").innerHTML ="Total: Ksh 0"
  document.getElementById("laborTotal").innerHTML ="Labor: Ksh 0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh 0"
})

document.getElementById("mainProjects").addEventListener("click",()=>{
trow.remove()
document.getElementById("laborTotal").innerHTML ="Labor: Ksh 0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh 0"
document.getElementById("lCounter").innerHTML = "0"
document.getElementById("SumProjected").innerHTML = 0
document.getElementById("SumTotalAllH").innerHTML = 0
document.getElementById("prevBal").innerHTML ="0"
document.getElementById("SumTotal").innerHTML ="Total: Ksh 0"
document.getElementById("modePresenter").innerHTML =""
document.getElementById("balLoader").style.display ="none"
document.getElementById("totalPayable").innerHTML ="0"
document.getElementById("prevBal").innerHTML ="0"
})
document.getElementById("btnSet").addEventListener('click',() => {
  document.getElementById("SumTotal").innerHTML ="Total: Ksh 0"
  document.getElementById("lCounter").innerHTML = "0"
  document.getElementById("totalPayable").innerHTML ="0"
  document.getElementById("modePresenter").innerHTML =""  
  document.getElementById("prevBal").innerHTML ="0"
  document.getElementById("balLoader").style.display ="none"
  document.getElementById("laborTotal").innerHTML ="Labor: Ksh 0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh 0"
  trow.remove();
})
td130.addEventListener("click",()=>{

  if (confirm("Add overtime for "+nme+"?" )) {
    var rawwID =getInputValue("date")
    var revwID = rawwID.replaceAll("/","-")
    var wID = revwID.split('-').reverse().join('-')

    var fullDate = wID.split("-")
    var day = fullDate[0]
    var month = fullDate[1]
    var year = fullDate[2]

    if(day.charAt(0) === "0"){
    var day = day.replaceAll("0","")
  
    }
    if(month.charAt(0) === "0"){
    var month = month.replaceAll("0","")
  
    }
    if(year.charAt(0) === "0"){
    var year = year.replaceAll("0","")

    }
    
    var wID = day +"-"+month+"-"+year
    var pro = getInputValue("email")
    var overTime = getInputValue("ovTime")
    if(overTime !=""){
     

          
            var new_wage = (parseInt(total)+parseInt(overTime));
            var new_all = (parseInt(all)+parseInt(overTime));
         

          

                var databaseR = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(wID).child(id);
                var receivedDatabase = databaseR.update({  


                  allowances:new_all,
                  wage:new_wage
            

                }).then(
                  
                  updateWeeksLaborAllowances(pro,id,nme,locations,new_wage,wID,total,new_all,new_wage,td13,overTime,td15,td16,td17,td14),
                    
                    

                );

       
    }
    else{
      // alert(overTime)
      alert("Please enter amount on the overtime field")
      document.getElementById("overtimeWrapper").style.display = "block"
    }

    
  } 
  else {
    alert("Process Canceled.")
    
  }

})

if(Status ==="pending"){
  td17.title ="Update to PAID"
  td17.style.cursor = "pointer"
  td17.addEventListener("click",()=>{

    // if (confirm("Confirm payment of "+total+" to "+nme+ "?")) {

    //   updatePaymentStatus(id,td17)
      
    // } 
    // else {
     
      
    // }
   alert("Action not allowed for projected wagebill")
  })
}


document.getElementById("btnViewPayments").addEventListener('click',() => {
  document.getElementById("totalPayable").innerHTML ="0"
  document.getElementById("modePresenter").innerHTML =""
  document.getElementById("prevBal").innerHTML ="0"
  document.getElementById("balLoader").style.display ="none"
  document.getElementById("lCounter").innerHTML = "0"
  document.getElementById("laborTotal").innerHTML ="Labor: Ksh 0"
    document.getElementById("OtherTotal").innerHTML ="Bills: Ksh 0"
    
  trow.remove();
  })



  
firebase.database().ref(parentDatabase).child("Weeks").child(projectForDesktop).child(wID).once("value",
function(cTasks){

  if(cTasks.exists()){
   
    var amountLabor = cTasks.val().wage;
      
    }
    else{
      var amountLabor = "0"

      
    }



  const otherExp = document.getElementById("laborTotal")
  var amountLabor = document.getElementById("lCounter").innerHTML
  otherExp.innerHTML = "Labor: Ksh "+ Intl.NumberFormat('en-US').format(amountLabor)

  // window.alert(toCost)

  firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(projectForDesktop).child(wID).once("value",
  function(cTasks){

      if(cTasks.exists()){
        var bals = document.getElementById("prevBal").innerHTML
          var amountOther = cTasks.val().gibs;
          var toCost = parseInt(actualForProjected) + parseInt(amountOther) + parseInt(bals)
          var total = document.getElementById("SumTotal")
          total.innerHTML = "Actual: Ksh "+ Intl.NumberFormat('en-US').format(toCost)
          var y =parseInt(weektotaprojected)+ parseInt(amountOther)+ parseInt(bals)
          document.getElementById("SumTotalAllH").innerHTML = y
          var x = y - toCost 
          var z = x + parseInt(amountLabor)

          var  laborRer = document.getElementById("laborTotal")
          // laborRer.innerHTML = "Labor: Ksh "+ Intl.NumberFormat('en-US').format(z)
          var otherExp = document.getElementById("OtherTotal")
          otherExp.innerHTML = "Pending Bills: Ksh "+ Intl.NumberFormat('en-US').format(amountOther)
          document.getElementById("SumProjected").innerHTML = Intl.NumberFormat('en-US').format(x)
      }
      else{
        var bals = document.getElementById("prevBal").innerHTML
          var toCost = parseInt(actualForProjected) + parseInt("0") + parseInt(bals)
          var total = document.getElementById("SumTotal")
          total.innerHTML = "Actual: Ksh "+  Intl.NumberFormat('en-US').format(toCost)
          var otherExp = document.getElementById("OtherTotal")
          otherExp.innerHTML = "Pending Bills: Ksh "+"0"
          var y =  parseInt(weektotaprojected)+ parseInt("0")+ parseInt(bals)
          var x = y - toCost
          var z = x + parseInt(amountLabor)

          var  laborRer = document.getElementById("laborTotal")
          // laborRer.innerHTML = "Labor: Ksh "+ Intl.NumberFormat('en-US').format(z)
          document.getElementById("SumTotalAllH").innerHTML =y 
          document.getElementById("SumProjected").innerHTML =  Intl.NumberFormat('en-US').format(x)
      }
    

  });

});



// <h4 id="laborTotal">Labor:</h4>
//                     <h4 id="OtherTotal">erOth Expenses:</h4>
//                     <h3 id="SumTotal">Total:</h3>

btn.addEventListener('click',() => {
//   alert(admision +" "+classs);

// deletePDFC(id);
var currentDate = new Date();
var day = currentDate.getDate();
var month = currentDate.getMonth()+1;
var year = currentDate.getFullYear()
var hour = currentDate.getHours();
var munit = currentDate.getMinutes();
var seconds = currentDate.getSeconds()

var dat = day+"-"+month+"-"+year
var fullDate = hour+":"+munit+":"+seconds
var recDate = dat+" "+fullDate
var pSName = name;
var pSDoc = doc;
var pSPhone = contact;
var psDate = dat;

postP(psDate,pSName,pSDoc,pSPhone,d)
      // modal.style.display = "block";
})
}

function reloadWeeTotals(pro,wID,total){
 

    

    const otherExp = document.getElementById("laborTotal")
    otherExp.innerHTML = "Labor: Ksh"+ Intl.NumberFormat('en-US').format(total)

    

    // window.alert(toCost)

    firebase.database().ref(parentDatabase).child("Bills").child("Totals").child(pro).child(wID).once("value",
    function(cTasks){

      if(cTasks.exists()){
         
          var amountOther = cTasks.val().gibs;
          const toCost = parseInt(total) + parseInt(amountOther)
          const totalv = document.getElementById("SumTotal")
          totalv.innerHTML = "Total: Ksh "+toCost

            

          const otherExp = document.getElementById("OtherTotal")
          otherExp.innerHTML = "Pending Bills: Ksh "+amountOther

      }
      else{
          const toCost = parseInt(total) + parseInt("0")
          const totalv = document.getElementById("SumTotal")
          totalv.innerHTML = "Total: Ksh "+toCost  
          const otherExp = document.getElementById("OtherTotal")
          otherExp.innerHTML = "Pending Bills: Ksh "+"0"
      }
    

  });


}

function confirmDay(){
  document.getElementById("projectingStatus").innerHTML = "TRUE"
  const weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

      const d = new Date();
      let day = weekday[d.getDay()];

      var database = firebase.database().ref(parentDatabase).child("Weeks").once("value",
        function(Snapshot){
            var date = Snapshot.val().current_week
            
          projectWageBillx(date)
        });

    
}
function projectWageBillx(date){
  weektotaprojected = 0
  actualForProjected = 0
  var countBills = 0
  
var wID = date
var rawwID =getInputValue("date")
var projectForDesktop = getInputValue("email")

  if(wID==="7-7-2024" && projectForDesktop ==="BUSIA CAIP"){
    document.getElementById("prevBal").innerHTML =23700+12400
  }
  if(wID==="7-7-2024" && projectForDesktop ==="ELDORET RC CHURCH"){
    document.getElementById("prevBal").innerHTML =2000
  }

retreiveBills(wID)
// checkingForBalances(wID)
// getBalancesCasual(wID,date)
  


  firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).orderByChild("name").once("value",
  function(cTasks){
  cTasks.forEach(
  function(childRecord){

      if(childRecord.exists()){
              
          var id = childRecord.val().workID;
          var nme = childRecord.val().name;
          var mon = childRecord.val().Monday;
          var tue = childRecord.val().Tuesday;
          var wed = childRecord.val().Wednesday;
          var thur = childRecord.val().Thursday;
          var fri = childRecord.val().Friday;
          var sat = childRecord.val().Saturday;
          var sun = childRecord.val().Sunday;
          var all = childRecord.val().allowances;
          var total = childRecord.val(). wage;
          var paid = childRecord.val(). paid;
          var Status = childRecord.val(). status;
          var bal =childRecord.val(). balance

          if(all ===undefined){
            var all = "0"
          }
          var total = parseInt(sun)+parseInt(mon)+parseInt(tue)+parseInt(wed)+parseInt(thur)+parseInt(fri)+parseInt(sat)+parseInt(all)
          if(paid ===undefined){
            var paid = "0"
          }
          
          if(bal ===undefined){
            var bal = parseInt(total)-parseInt(paid)
          }
          getWorkersDetails3(all,id,nme,mon,tue,wed,thur,fri,sat,sun,total,Status,wID,paid,bal)
          document.getElementById("SumProjectedH").style.display ="block"
          document.getElementById("SumTotalAll").style.display ="block"
      }
      else{
          window.alert("No record found for "+wID+". Only pending balances will be loaded")
      }


  })

  });


// }
// else{
//   alert("Fill in date field")
// }

}
var actualForProjected = 0
var weektotaprojected = 0
function updateWeeksLaborAllowances(pro,id,nme,locations,new_wage,wID,total,new_all,new_wage,td13,overTime,td15,td16,td17,td14) {

       var date = wID;
        const weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

        const d = new Date();
        let day = weekday[d.getDay()];
       var database = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date).once("value",
        function(Snapshot){
                
            if(Snapshot.exists()){
                var newS = Snapshot.val().wage
               
                var wwage2 = (parseInt(newS)+parseInt(overTime)).toFixed(0)
                // alert(parseInt(wwage2))
            }
            else{
              var wwage2 = overTime
            }
            
            
            //
                    var databaseR = firebase.database().ref(parentDatabase).child("Weeks").child(pro).child(date);
                    var receivedDatabase = databaseR.update({
                    

                    wage:wwage2
                    

                    }).then(
                      alert("Overtime updated successfully"),
                      reloadWeeTotals(pro,wID,total),
                      td13.innerHTML = new_all,
                      td14.innerHTML = new_wage
                        
                     );

          // 179600
            
         
        });
   
   }  

function deletePDFC(id){
firebase.database().ref("pending Documents").child(id).remove()


firebase.database().ref('pendingDocNo').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('pendingDocNo');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  // alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('pendingDocNo');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  // alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}
function updateAllowance(id,wID,projectForDesktop,overTime){

  var database = firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).child(id).once("value",
        function(Snapshot){

          
            var new_wage = (parseInt(Snapshot.val().wage)+parseInt(overTime));
            var new_all = (parseInt(Snapshot.val())+parseInt(overTime));
         

            var new_all = (parseInt(Snapshot.val())+parseInt("0"));

                var databaseR = firebase.database().ref(parentDatabase).child("Site Payments").child(projectForDesktop).child(wID).child(id);
                var receivedDatabase = databaseR.update({  


                  allowances:new_all
            

                }).then(
                    
                    alert("Overtime updated successfully"),
                    document.getElementById("btnViewPayments").click()

                );

        }
        );

  
}
function updatePaymentStatus(id,td20,bal,paid,td15,td16,Status,type,balance,td17,td19,total,trow,td18){
  var pro  = getInputValue("email")
   
  var b_d_dater = getInputValue("date")
  var revwID = b_d_dater.replaceAll("/","-")
    var wID = revwID.split('-').reverse().join('-')

    var fullDate = wID.split("-")
    var day = fullDate[0]
    var month = fullDate[1]
    var year = fullDate[2]

      if(day.charAt(0) === "0"){
      var day = day.replaceAll("0","")
    
      }
      if(month.charAt(0) === "0"){
      var month = month.replaceAll("0","")
    
      }
      if(year.charAt(0) === "0"){
      var year = year.replaceAll("0","")

      }
      
      var date = day +"-"+month+"-"+year
// 3528448
      if(total != 0){
          var databaseR = firebase.database().ref(parentDatabase).child("Site Payments").child(pro).child(date).child(id);
                var receivedDatabase = databaseR.update({  


                status:Status,
                paid:paid,
                balance:bal
            

                }).then(

                    updateBalanceForWorker(pro,id,td20,bal,paid,td15,td16,Status,type,balance,td17,td19,trow,td18)
                   
                    

              );
      }
      else{
        updateBalanceForWorker(pro,id,td20,bal,paid,td15,td16,Status,type,balance,td17,td19,trow,td18)
      }

}
function updateBalanceForWorker(pro,id,td20,bal,paid,td15,td16,Status,type,balance,td17,td19,trow,td18){
  var database = firebase.database().ref(parentDatabase).child("Staffs").child(type).child(pro).child("14-3-2022").child(id);
  var receivedDatabase = database.update({  


    balances:balance


   }).then(
      td20.style.color ="black",
      // trow.style.color ="green",
      trow.style.fontWeight ="bold",
      // alert("Payment status updated successfully"),
      td20.innerHTML = "DONE!",
      // td18.innerHTML = "-",
      td15.innerHTML = paid,
      td16.innerHTML = bal,
      td17.innerHTML = balance,
      td19.innerHTML = "0"
   )
}
function deleteOU(date){
firebase.database().ref("Office Updates").child(date).remove()


firebase.database().ref('OfficeUTot').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('OfficeUTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('OfficeUTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}


function deleteReady(d){
firebase.database().ref("Title Deeds").child("Received").child(d).remove()


firebase.database().ref('rTot').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('rTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('rTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}

function deleteSVB(d){
firebase.database().ref("Site Visits pending").child(d).remove()


firebase.database().ref('SVRtot').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('SVRtot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Site visit request removed from pending")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('SVRtot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Site visit request removed from pending")
                  
              window.location.href ="dashboard.html"  
      }

})  




}

function deleteSV(d){
firebase.database().ref("Site Visits").child(d).remove()


firebase.database().ref('SiteVNo').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('SiteVNo');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('SiteVNo');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}

function  deleteEnquiry(date){
firebase.database().ref("Enquiry").child(date).remove()


firebase.database().ref('enquiryTot').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('enquiryTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('enquiryTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}

function deletePT(d){
firebase.database().ref("Title Deeds").child("pending").child(d).remove()


firebase.database().ref('SentTot').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('SentTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('SentTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}

function deletePS(d){
firebase.database().ref("pending Signatures").child(d).remove()


firebase.database().ref('pendingSTot').once("value",
   function(childRecord){


      var toR = childRecord.val().totR;

      intCRV = parseInt(toR);
      var intToRec = intCRV -1;

      if(intToRec < 0){

        var newReceived = "0";
      
        var databaseE= firebase.database().ref('pendingSTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  // alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
    
      }
      else{
        var newReceived = intToRec.toString();
      
        var databaseE= firebase.database().ref('pendingSTot');
                  var receivedDatabase = databaseE.update({

                      totR:newReceived

                  });
                  
              
                  // alert("Operation Successfull")
                  
              window.location.href ="dashboard.html"  
      }

})  




}


function getENo(){
firebase.database().ref("enquiryTot").once("value",
function(childRecord){


      var enqno = childRecord.val().totR;
    

      getPSNo(enqno);
  

});
}

function getPSNo(enqno){
firebase.database().ref("pendingSTot").once("value",
function(childRecord){


      var pendno = childRecord.val().totR;
    

      getOUNo(enqno,pendno);
  

});
}

function getOUNo(enqno,pendno){
firebase.database().ref("OfficeUTot").once("value",
function(childRecord){


      var officeno = childRecord.val().totR;
    

      getRTNo(enqno,pendno,officeno);
  

});
}

function getRTNo(enqno,pendno,officeno){
firebase.database().ref("rTot").once("value",
function(childRecord){


      var rtNo = childRecord.val().totR;
    

      getSVNo(enqno,pendno,officeno,rtNo);
  

});
}

function getSVNo(enqno,pendno,officeno,rtNo){
firebase.database().ref("SiteVNo").once("value",
function(childRecord){


      var svNo = childRecord.val().totR;
    

      getPT(enqno,pendno,officeno,rtNo,svNo);
  

});
}

function getPT(enqno,pendno,officeno,rtNo,svNo){
firebase.database().ref("SentTot").once("value",
function(childRecord){


      var ptNo = childRecord.val().totR;
    

      getDT(enqno,pendno,officeno,rtNo,svNo,ptNo);
  

});
}

function getDT(enqno,pendno,officeno,rtNo,svNo,ptNo){
firebase.database().ref("DispTot").once("value",
function(childRecord){


      var dtNo = childRecord.val().totR;
    

      getPDFC(enqno,pendno,officeno,rtNo,svNo,ptNo,dtNo);
  

});
}

function getPDFC(enqno,pendno,officeno,rtNo,svNo,ptNo,dtNo){
firebase.database().ref("pendingDocNo").once("value",
function(childRecord){


      var pdNo = childRecord.val().totR;
    

      addAllToDashboard(enqno,pendno,officeno,rtNo,svNo,ptNo,dtNo,pdNo);
  

});
}

function addAllToDashboard(enqno,pendno,officeno,rtNo,svNo,ptNo,dtNo,pdNo){
var enqField = document.getElementById("enq")
var pendField = document.getElementById("pend")
var oUField = document.getElementById("oU")
var rtField = document.getElementById("rtNumber")
var dField = document.getElementById("dTDNumber")
var svField = document.getElementById("svNumber")
var pTNoField = document.getElementById("pTDNumber")
var pDocNoField = document.getElementById("pendDocs")


enqField.innerHTML = "Enquiries: "+enqno
pendField.innerHTML = "pending Signatures: "+pendno
oUField.innerHTML = "Office Updates: "+officeno
rtField.innerHTML = "Total: "+rtNo
dField.innerHTML = "Total: "+dtNo
svField.innerHTML = "Total: "+svNo
pTNoField.innerHTML = "Total: "+ptNo
pDocNoField.innerHTML = "pending Docs: "+pdNo


}
var database = firebase.database().ref('Events');
//-------------------------------------------------------------------------------------------------------------//
function addToDashboard(client){
var clientsN = document.getElementById("clientsNumber");


var fetched = document.createElement("h2");


fetched.innerHTML = client;


clientsN.appendChild(fetched);

getCompleteTasks();


}
function addToDashboardE(emps){

var employees = document.getElementById("employeesNumber");


var fetchedE = document.createElement("h2");



fetchedE.innerHTML = emps;



employees.appendChild(fetchedE);

//  getCompleteTasks();


}
function addToDashboardP(pro){

var poj = document.getElementById("projectsNumber");



var fetchedP = document.createElement("h3");



fetchedP.innerHTML =  pro;


poj.appendChild(fetchedP);

// getCompleteTasks();


}
function addToDashboardPe(pe){

var tasks = document.getElementById("pendingTasks");


var fetchedPe = document.createElement("h2");


fetchedPe.innerHTML = pe;


tasks.appendChild(fetchedPe);
// getCompleteTasks();


}
// ----------------------------------------------------------------------------------------------------------//
function getDetails(emps){

firebase.database().ref('companyInfo').once("value",
function(Data){

      var client = Data.val().clients;
      

       addToDashboard(client);
       getEvents();
      
       getEmployessStat();
       getProjectStat();
       getTaskStat();

     // window.alert(client + emps + pro + pe);


})

//  addToDashboardE(emps);
//  addToDashboardP(pro);
// addToDashboardPe(pe);

}
function getEmployessStat(){
firebase.database().ref('employeesStat').once("value",
function(Data){

      
      var emps = Data.val().employees;
     

        addToDashboardE(emps);
      //  getEvents();

     // window.alert(client + emps + pro + pe);


})

}
function getProjectStat(){
firebase.database().ref('assetStat').once("value",
function(Data){

     
      var pro = Data.val().assVal;
   
      addToDashboardP(pro);
      //  getEvents();

     // window.alert(client + emps + pro + pe);


})

}

function getTaskStat(){

firebase.database().ref('taskStat').once("value",
function(Data){

      
      var pe = Data.val().pendingTask;

      
      //  getEvents();

     // window.alert(client + emps + pro + pe);
addToDashboardPe(pe);

})}
function getEvents(){
firebase.database().ref('Events').once("value",
function(Snapshot){
Snapshot.forEach(
  function(Events){
      var tit = Events.val().title;
      var dat = Events.val().date;
      var cood = Events.val().Coordinator;

      addEventsToTable(tit,dat,cood);
      
    
      


      //window.alert(cood);
  }
)
})
}

function addEventsToTable(tit,dat,cood){
var tbody = document.getElementById("tbody2");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var td2 = document.createElement("td");
var td3 = document.createElement("td");
var btn = document.createElement("button");

btn.style.width = "50px";
btn.style.height = "16px";
btn.style.marginTop = "10px";
btn.innerText = "Update";
btn.style.fontSize = "9px";
btn.style.background = "green";
btn.style.color = "white";
btn.style.padding = "2px";

td1.innerHTML = tit;
td2.innerHTML = dat;
td3.innerHTML = cood;

trow.appendChild(td1); 
trow.appendChild(td2);
trow.appendChild(td3);
trow.appendChild(btn);

tbody.appendChild(trow);



}

function getCompleteTasks(){
firebase.database().ref("Competed Tasks").once("value",
function(cTasks){
cTasks.forEach(
  function(childRecord){
      var tasks = childRecord.val().name;
      addCompleteToDash(tasks);
      
  }
)

});
}

function addCompleteToDash(tasks){
var comp = document.getElementById("Test");
var content = document.createElement("h4");
var trow = document.createElement("tr");
var td1 = document.createElement("td");
var btn = document.createElement("button");

content.style.marginTop = "20px";

btn.style.width = "30px";
btn.style.height = "11px";
btn.style.marginTop = "10px";
btn.innerText = "Clear";
btn.style.fontSize = "8px";
btn.style.background = "red";
btn.style.color = "white";
btn.style.padding = "2px";
btn.style.marginLeft= "5px";
td1.style.fontWeight = "bold";

td1.innerHTML = tasks;

trow.appendChild(td1);
trow.appendChild(btn);

comp.appendChild(trow);



}
function addEvent(){
var modal = document.getElementById("eventsModal");
modal.style.display = "block";

}
var span = document.getElementsByClassName("close")[0];

span.onclick = function(){
var modal = document.getElementById("eventsModal1");
modal.style.display = "none";
}

var span2 = document.getElementsByClassName("close")[1];

span2.onclick = function(){
var modal = document.getElementById("eventsModal2");
modal.style.display = "none";
}

var span3 = document.getElementsByClassName("close")[2];

span3.onclick = function(){
var modal = document.getElementById("eventsModal3");
modal.style.display = "none";
}

var span4 = document.getElementsByClassName("close")[3];

span4.onclick = function(){
var modal = document.getElementById("eventsModal4");
modal.style.display = "none";
}

var span5 = document.getElementsByClassName("close")[4];

span5.onclick = function(){
var modal = document.getElementById("eventsModal5");
modal.style.display = "none";
}

var span6 = document.getElementsByClassName("close")[5];

span6.onclick = function(){
var modal = document.getElementById("eventsModal6");
modal.style.display = "none";
}

var span7 = document.getElementsByClassName("close")[6];

span7.onclick = function(){
var modal = document.getElementById("eventsModal7");
modal.style.display = "none";
}
var span8 = document.getElementsByClassName("close")[7];

span8.onclick = function(){
var modal = document.getElementById("eventsModal8");
modal.style.display = "none";
}
      document.getElementById('eventDetails').addEventListener('postEvent',postEvent);
function postEvent() {
// e.preventDefault();start()
var modal = document.getElementById("eventsModal");
modal.style.display = "none";
var title = getInputValue('eventTit');
var date = getInputValue('eventDat');
var coord = getInputValue('EventCod');
var venue = getInputValue('eventVen');
var desc = getInputValue('eventDesc');

saveEvent(title,date,coord,venue,desc);
}
function getInputValue(id)
{
return document.getElementById(id).value;

}
function saveEvent(title,date,coord,venue,desc){
var newEvent = database.push();
var eventKey = newEvent.key;

newEvent.set(
{
  Coordinator: coord,
  title:title,
  venue:venue,
  date: date,
  description:desc,
  eventID:eventKey
}
);
window.alert("Event added successfully...")
document.getElementById('eventTit').reset();

}


// window.onload = getEvents;
// window.onload = getReadyT();
</script>




</body>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36251023-1']);
  _gaq.push(['_setDomainName', 'jqueryscript.net']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</html>
